{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-04-29T18:18:01.915484Z", "invocation_id": "12940e71-51a8-4d6e-bb5e-cf973957836e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:17:57.160147Z", "completed_at": "2025-04-29T18:17:57.178152Z"}, {"name": "execute", "started_at": "2025-04-29T18:17:57.178689Z", "completed_at": "2025-04-29T18:18:00.493797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.3349826335906982, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_date", "compiled": true, "compiled_code": "SELECT *\nFROM s3(\n  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',\n  'YA9JokyWUb2hFUbKYEEN',\n  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',\n  'CSVWithNames'\n)", "relation_name": "`adw02_star`.`dim_date`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.500071Z", "completed_at": "2025-04-29T18:18:00.504094Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.504786Z", "completed_at": "2025-04-29T18:18:00.560338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06157660484313965, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_address", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`address`\n)\nSELECT\n    address_id,\n    address,\n    district,\n    city_id,\n    postal_code,\n    phone,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_address`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.565173Z", "completed_at": "2025-04-29T18:18:00.569581Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.570132Z", "completed_at": "2025-04-29T18:18:00.621267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.057407379150390625, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_category", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`category`\n)\nSELECT\n    category_id,\n    name\nFROM source", "relation_name": "`adw02_stag`.`stg_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.626119Z", "completed_at": "2025-04-29T18:18:00.629804Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.630323Z", "completed_at": "2025-04-29T18:18:00.720184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09531927108764648, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_city", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`city`\n)\nSELECT\n    city_id,\n    city,\n    country_id\nFROM source", "relation_name": "`adw02_stag`.`stg_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.727922Z", "completed_at": "2025-04-29T18:18:00.734785Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.735418Z", "completed_at": "2025-04-29T18:18:00.787278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.061487674713134766, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_country", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`country`\n)\nSELECT\n    country_id,\n    country\nFROM source", "relation_name": "`adw02_stag`.`stg_country`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.792059Z", "completed_at": "2025-04-29T18:18:00.795872Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.796434Z", "completed_at": "2025-04-29T18:18:00.854678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06376075744628906, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_customer", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`customer`\n)\nSELECT\n    customer_id,\n    store_id,\n    first_name,\n    last_name,\n    email,\n    address_id,\n    active,\n    create_date,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.860293Z", "completed_at": "2025-04-29T18:18:00.869621Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.870135Z", "completed_at": "2025-04-29T18:18:00.928637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06992268562316895, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_film", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`film`\n)\nSELECT\n    film_id,\n    title,\n    description,\n    release_year,\n    language_id,\n    original_language_id,\n    rental_duration,\n    rental_rate,\n    length,\n    replacement_cost,\n    rating,\n    special_features,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.933252Z", "completed_at": "2025-04-29T18:18:00.936902Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.937497Z", "completed_at": "2025-04-29T18:18:00.988612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056479454040527344, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_film_category", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`film_category`\n)\nSELECT\n    film_id,\n    category_id\nFROM source", "relation_name": "`adw02_stag`.`stg_film_category`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:00.993159Z", "completed_at": "2025-04-29T18:18:00.997339Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:00.997865Z", "completed_at": "2025-04-29T18:18:01.067186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0753483772277832, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_inventory", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`inventory`\n)\nSELECT\n    inventory_id,\n    film_id,\n    store_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_inventory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.072174Z", "completed_at": "2025-04-29T18:18:01.076159Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.076712Z", "completed_at": "2025-04-29T18:18:01.129245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05850958824157715, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_language", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`language`\n)\nSELECT\n    language_id,\n    name\nFROM source", "relation_name": "`adw02_stag`.`stg_language`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.134036Z", "completed_at": "2025-04-29T18:18:01.138507Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.139029Z", "completed_at": "2025-04-29T18:18:01.220278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08740925788879395, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_rental", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`rental`\n)\nSELECT\n    rental_id,\n    rental_date,\n    inventory_id,\n    customer_id,\n    return_date,\n    staff_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_rental`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.225187Z", "completed_at": "2025-04-29T18:18:01.229185Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.229713Z", "completed_at": "2025-04-29T18:18:01.347995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12424182891845703, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_staff", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`staff`\n)\nSELECT\n    staff_id,\n    first_name,\n    last_name,\n    address_id,\n    email,\n    store_id,\n    active,\n    username,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.358593Z", "completed_at": "2025-04-29T18:18:01.365529Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.366415Z", "completed_at": "2025-04-29T18:18:01.420767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06526970863342285, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_store", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`store`\n)\nSELECT\n    store_id,\n    manager_staff_id,\n    address_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_store`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.426082Z", "completed_at": "2025-04-29T18:18:01.433709Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.434304Z", "completed_at": "2025-04-29T18:18:01.507551Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08293795585632324, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_customer", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT * FROM `adw02_stag`.`stg_customer`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,\n        c.customer_id AS customer_id,\n        c.first_name AS customer_first_name,\n        c.last_name AS customer_last_name,\n        c.email AS customer_email,\n        c.active AS customer_active,\n        c.create_date AS customer_created,\n        a.address AS customer_address,\n        a.district AS customer_district,\n        a.postal_code AS customer_postal_code,\n        a.phone AS customer_phone_number,\n        ci.city AS customer_city,\n        co.country AS customer_country,\n        c.last_update AS customer_last_update\n    FROM customers c\n    LEFT JOIN addresses a ON c.address_id = a.address_id\n    LEFT JOIN cities ci ON a.city_id = ci.city_id\n    LEFT JOIN countries co ON ci.country_id = co.country_id\n)\nSELECT * FROM final\nORDER BY customer_id", "relation_name": "`adw02_star`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.512632Z", "completed_at": "2025-04-29T18:18:01.525205Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.525840Z", "completed_at": "2025-04-29T18:18:01.610329Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09917020797729492, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_film", "compiled": true, "compiled_code": "WITH films AS (\n    SELECT * FROM `adw02_stag`.`stg_film`\n),\nlanguages AS (\n    SELECT * FROM `adw02_stag`.`stg_language`\n),\noriginal_languages AS (\n    SELECT * FROM `adw02_stag`.`stg_language`\n),\n\nfilm_categories AS (\n    SELECT * FROM `adw02_stag`.`stg_film_category`\n),\ncategories AS (\n    SELECT * FROM `adw02_stag`.`stg_category`\n),\n\nfilms_with_categories AS (\n    SELECT\n        f.*,\n        c.name AS category_name\n    FROM films f\n    LEFT JOIN film_categories fc ON f.film_id = fc.film_id\n    LEFT JOIN categories c ON fc.category_id = c.category_id\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(f.film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,\n        f.film_id AS film_id,\n        f.title AS film_title,\n        f.description AS film_description,\n        f.release_year AS film_release_year,\n        f.category_name AS film_category_name,\n        l.name AS film_language,\n        ol.name AS film_original_language,\n        f.rental_duration AS film_rental_duration,\n        f.rental_rate AS film_rental_rate,\n        f.length AS film_duration,\n        f.replacement_cost AS film_replacement_cost,\n        f.rating AS film_rating,\n        f.special_features AS film_special_features,\n        f.last_update AS film_last_update\n    FROM films_with_categories f\n    LEFT JOIN languages l ON f.language_id = l.language_id\n    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.615147Z", "completed_at": "2025-04-29T18:18:01.622272Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.622923Z", "completed_at": "2025-04-29T18:18:01.668629Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05465388298034668, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_staff", "compiled": true, "compiled_code": "WITH staff AS (\n    SELECT * FROM `adw02_stag`.`stg_staff`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,\n        s.staff_id AS staff_id,\n        s.first_name AS staff_first_name,\n        s.last_name AS staff_last_name,\n        s.email AS staff_email,\n        s.active AS staff_active,\n        s.store_id AS staff_store_id,\n        s.last_update AS staff_last_update\n    FROM staff s\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.673829Z", "completed_at": "2025-04-29T18:18:01.680152Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.680782Z", "completed_at": "2025-04-29T18:18:01.763372Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0907294750213623, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_store", "compiled": true, "compiled_code": "WITH stores AS (\n    SELECT * FROM `adw02_stag`.`stg_store`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nstaff AS (\n    SELECT * FROM `adw02_stag`.`stg_staff`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,\n        s.store_id AS store_id,\n        a.address AS store_address,\n        a.district AS store_district,\n        a.postal_code AS store_postal_code,\n        a.phone AS store_phone_number,\n        ci.city AS store_city,\n        co.country AS store_country,\n        s.manager_staff_id AS store_manager_staff_id,\n        stf.first_name AS store_manager_first_name,\n        stf.last_name AS store_manager_last_name,\n        s.last_update AS store_last_update\n    FROM stores s\n    LEFT JOIN addresses a ON s.address_id = a.address_id\n    LEFT JOIN cities ci ON a.city_id = ci.city_id\n    LEFT JOIN countries co ON ci.country_id = co.country_id\n    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_store`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-29T18:18:01.768871Z", "completed_at": "2025-04-29T18:18:01.775927Z"}, {"name": "execute", "started_at": "2025-04-29T18:18:01.776453Z", "completed_at": "2025-04-29T18:18:01.909609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1419076919555664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.fct_rentals", "compiled": true, "compiled_code": "WITH rental_data AS (\n    SELECT\n        r.rental_id,\n        r.rental_date,\n        r.return_date,\n        r.customer_id,\n        r.staff_id,\n        i.film_id,\n        i.store_id,\n        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration\n    FROM `adw02_stag`.`stg_rental` r\n    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id\n),\n\ndate_lookup AS (\n    SELECT\n        date_key,\n        date_actual\n    FROM `adw02_star`.`dim_date`\n)\n\nSELECT\n    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,\n    dc.customer_skey,\n    df.film_skey,\n    ds.staff_skey,\n    dst.store_skey,\n    d.date_key,\n    r.rental_id,\n    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,\n    r.rental_duration\nFROM rental_data r\nJOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id\nJOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id\nJOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id\nJOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id\nJOIN date_lookup d ON toDate(r.rental_date) = d.date_actual", "relation_name": "`adw02_star`.`fct_rentals`"}], "elapsed_time": 5.181061029434204, "args": {"print": true, "use_colors_file": true, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "static_parser": true, "macro_debugging": false, "log_path": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs", "require_resource_names_without_spaces": false, "log_level": "info", "partial_parse": true, "log_format": "default", "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "empty": false, "select": [], "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "invocation_command": "dbt run", "which": "run", "defer": false, "vars": {}, "introspect": true, "profiles_dir": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar", "cache_selected_only": false, "quiet": false, "show_resource_report": false, "strict_mode": false, "log_level_file": "debug", "populate_cache": true, "exclude": [], "use_colors": true, "version_check": true, "project_dir": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar", "partial_parse_file_diff": true, "printer_width": 80, "log_format_file": "debug", "favor_state": false}}