{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-04-26T16:04:19.088361Z", "invocation_id": "634df76d-60d7-44d3-a7eb-452490a194ed", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:16.515612Z", "completed_at": "2025-04-26T16:04:16.522103Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:16.522600Z", "completed_at": "2025-04-26T16:04:18.158606Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6438548564910889, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_date", "compiled": true, "compiled_code": "SELECT *\nFROM s3(\n  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',\n  'YA9JokyWUb2hFUbKYEEN',\n  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',\n  'CSVWithNames'\n)", "relation_name": "`adw02_star`.`dim_date`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.162797Z", "completed_at": "2025-04-26T16:04:18.165452Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.165788Z", "completed_at": "2025-04-26T16:04:18.205193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04317283630371094, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_address", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`address`\n)\nSELECT\n    address_id,\n    address,\n    district,\n    city_id,\n    postal_code,\n    phone,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_address`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.208252Z", "completed_at": "2025-04-26T16:04:18.211236Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.211683Z", "completed_at": "2025-04-26T16:04:18.249502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0420989990234375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_city", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`city`\n)\nSELECT\n    city_id,\n    city,\n    country_id\nFROM source", "relation_name": "`adw02_stag`.`stg_city`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.252882Z", "completed_at": "2025-04-26T16:04:18.255729Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.256211Z", "completed_at": "2025-04-26T16:04:18.292617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040737152099609375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_country", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`country`\n)\nSELECT\n    country_id,\n    country\nFROM source", "relation_name": "`adw02_stag`.`stg_country`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.295757Z", "completed_at": "2025-04-26T16:04:18.298831Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.299429Z", "completed_at": "2025-04-26T16:04:18.382639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08776712417602539, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_customer", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`customer`\n)\nSELECT\n    customer_id,\n    store_id,\n    first_name,\n    last_name,\n    email,\n    address_id,\n    active,\n    create_date,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.387486Z", "completed_at": "2025-04-26T16:04:18.391059Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.391639Z", "completed_at": "2025-04-26T16:04:18.436710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.050455570220947266, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_film", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`film`\n)\nSELECT\n    film_id,\n    title,\n    description,\n    release_year,\n    language_id,\n    original_language_id,\n    rental_duration,\n    rental_rate,\n    length,\n    replacement_cost,\n    rating,\n    special_features,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.439807Z", "completed_at": "2025-04-26T16:04:18.443662Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.444117Z", "completed_at": "2025-04-26T16:04:18.512911Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0739138126373291, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_inventory", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`inventory`\n)\nSELECT\n    inventory_id,\n    film_id,\n    store_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_inventory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.516341Z", "completed_at": "2025-04-26T16:04:18.519690Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.520192Z", "completed_at": "2025-04-26T16:04:18.559392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0439300537109375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_language", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`language`\n)\nSELECT\n    language_id,\n    name\nFROM source", "relation_name": "`adw02_stag`.`stg_language`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.562490Z", "completed_at": "2025-04-26T16:04:18.565688Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.566047Z", "completed_at": "2025-04-26T16:04:18.613465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051744937896728516, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_rental", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`rental`\n)\nSELECT\n    rental_id,\n    rental_date,\n    inventory_id,\n    customer_id,\n    return_date,\n    staff_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_rental`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.616399Z", "completed_at": "2025-04-26T16:04:18.619405Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.619808Z", "completed_at": "2025-04-26T16:04:18.660528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04488348960876465, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_staff", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`staff`\n)\nSELECT\n    staff_id,\n    first_name,\n    last_name,\n    address_id,\n    email,\n    store_id,\n    active,\n    username,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.663925Z", "completed_at": "2025-04-26T16:04:18.667388Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.667991Z", "completed_at": "2025-04-26T16:04:18.764596Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10183262825012207, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.stg_store", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM `sakila_proxy`.`store`\n)\nSELECT\n    store_id,\n    manager_staff_id,\n    address_id,\n    last_update\nFROM source", "relation_name": "`adw02_stag`.`stg_store`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.770819Z", "completed_at": "2025-04-26T16:04:18.776018Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.776482Z", "completed_at": "2025-04-26T16:04:18.821443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05250811576843262, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_customer", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT * FROM `adw02_stag`.`stg_customer`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,\n        c.customer_id AS customer_id,\n        c.first_name AS customer_first_name,\n        c.last_name AS customer_last_name,\n        c.email AS customer_email,\n        c.active AS customer_active,\n        c.create_date AS customer_created,\n        a.address AS customer_address,\n        a.district AS customer_district,\n        a.postal_code AS customer_postal_code,\n        a.phone AS customer_phone_number,\n        ci.city AS customer_city,\n        co.country AS customer_country,\n        c.last_update AS customer_last_update\n    FROM customers c\n    LEFT JOIN addresses a ON c.address_id = a.address_id\n    LEFT JOIN cities ci ON a.city_id = ci.city_id\n    LEFT JOIN countries co ON ci.country_id = co.country_id\n)\nSELECT * FROM final\nORDER BY customer_id", "relation_name": "`adw02_star`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.824939Z", "completed_at": "2025-04-26T16:04:18.829412Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.829947Z", "completed_at": "2025-04-26T16:04:18.875088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05112504959106445, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_film", "compiled": true, "compiled_code": "WITH films AS (\n    SELECT * FROM `adw02_stag`.`stg_film`\n),\nlanguages AS (\n    SELECT * FROM `adw02_stag`.`stg_language`\n),\noriginal_languages AS (\n    SELECT * FROM `adw02_stag`.`stg_language`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,\n        f.film_id AS film_id,\n        f.title AS film_title,\n        f.description AS film_description,\n        f.release_year AS film_release_year,\n        l.name AS film_language,\n        ol.name AS film_original_language,\n        f.original_language_id IS NOT NULL AS film_has_original_language,\n        f.rental_duration AS film_rental_duration,\n        f.rental_rate AS film_rental_rate,\n        f.length AS film_duration,\n        f.replacement_cost AS film_replacement_cost,\n        f.rating AS film_rating,\n        f.special_features AS film_special_features,\n        f.last_update AS film_last_update\n    FROM films f\n    LEFT JOIN languages l ON f.language_id = l.language_id\n    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_film`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.878273Z", "completed_at": "2025-04-26T16:04:18.882820Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.883243Z", "completed_at": "2025-04-26T16:04:18.929901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05260348320007324, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_staff", "compiled": true, "compiled_code": "WITH staff AS (\n    SELECT * FROM `adw02_stag`.`stg_staff`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,\n        s.staff_id AS staff_id,\n        s.first_name AS staff_first_name,\n        s.last_name AS staff_last_name,\n        s.email AS staff_email,\n        s.active AS staff_active,\n        s.username AS staff_username,\n        a.address AS staff_address,\n        a.district AS staff_district,\n        a.postal_code AS staff_postal_code,\n        a.phone AS staff_phone_number,\n        ci.city AS staff_city,\n        co.country AS staff_country,\n        s.store_id AS store_id,\n        s.last_update AS staff_last_update\n    FROM staff s\n    LEFT JOIN addresses a ON s.address_id = a.address_id\n    LEFT JOIN cities ci ON a.city_id = ci.city_id\n    LEFT JOIN countries co ON ci.country_id = co.country_id\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_staff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.933708Z", "completed_at": "2025-04-26T16:04:18.938768Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.939236Z", "completed_at": "2025-04-26T16:04:18.984079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05148911476135254, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.dim_store", "compiled": true, "compiled_code": "WITH stores AS (\n    SELECT * FROM `adw02_stag`.`stg_store`\n),\naddresses AS (\n    SELECT * FROM `adw02_stag`.`stg_address`\n),\ncities AS (\n    SELECT * FROM `adw02_stag`.`stg_city`\n),\ncountries AS (\n    SELECT * FROM `adw02_stag`.`stg_country`\n),\nstaff AS (\n    SELECT * FROM `adw02_stag`.`stg_staff`\n),\nfinal AS (\n    SELECT\n        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,\n        s.store_id AS store_id,\n        a.address AS store_address,\n        a.district AS store_district,\n        a.postal_code AS store_postal_code,\n        a.phone AS store_phone_number,\n        ci.city AS store_city,\n        co.country AS store_country,\n        s.manager_staff_id AS store_manager_staff_id,\n        stf.first_name AS store_manager_first_name,\n        stf.last_name AS store_manager_last_name,\n        s.last_update AS store_last_update\n    FROM stores s\n    LEFT JOIN addresses a ON s.address_id = a.address_id\n    LEFT JOIN cities ci ON a.city_id = ci.city_id\n    LEFT JOIN countries co ON ci.country_id = co.country_id\n    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id\n)\nSELECT * FROM final", "relation_name": "`adw02_star`.`dim_store`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-26T16:04:18.987627Z", "completed_at": "2025-04-26T16:04:18.992544Z"}, {"name": "execute", "started_at": "2025-04-26T16:04:18.992885Z", "completed_at": "2025-04-26T16:04:19.083903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09723949432373047, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.sakstar.fct_rentals", "compiled": true, "compiled_code": "WITH rental_data AS (\n    SELECT\n        r.rental_id,\n        r.rental_date,\n        r.return_date,\n        r.customer_id,\n        r.staff_id,\n        i.film_id,\n        i.store_id,\n        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration\n    FROM `adw02_stag`.`stg_rental` r\n    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id\n),\n\ndate_lookup AS (\n    SELECT\n        date_key,\n        date_actual\n    FROM `adw02_star`.`dim_date`\n)\n\nSELECT\n    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,\n    dc.customer_skey,\n    df.film_skey,\n    ds.staff_skey,\n    dst.store_skey,\n    d.date_key,\n    r.rental_id,\n    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,\n    r.rental_duration\nFROM rental_data r\nJOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id\nJOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id\nJOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id\nJOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id\nJOIN date_lookup d ON toDate(r.rental_date) = d.date_actual", "relation_name": "`adw02_star`.`fct_rentals`"}], "elapsed_time": 2.904453992843628, "args": {"exclude": [], "log_format_file": "debug", "which": "run", "macro_debugging": false, "vars": {}, "use_colors_file": true, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "enable_legacy_logger": false, "project_dir": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar", "version_check": true, "log_level_file": "debug", "invocation_command": "dbt run", "show_resource_report": false, "static_parser": true, "partial_parse": true, "require_resource_names_without_spaces": false, "empty": false, "log_format": "default", "quiet": false, "defer": false, "partial_parse_file_diff": true, "cache_selected_only": false, "log_level": "info", "send_anonymous_usage_stats": true, "indirect_selection": "eager", "print": true, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "log_file_max_bytes": 10485760, "profiles_dir": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar", "strict_mode": false, "log_path": "/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs", "write_json": true, "source_freshness_run_project_hooks": false, "favor_state": false, "use_colors": true}}