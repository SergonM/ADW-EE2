[0m11:19:53.723466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682e59a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682c4bd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682c4bd450>]}


============================== 11:19:53.727577 | 49b655a4-7c58-433c-a57f-bb82a6295dc4 ==============================
[0m11:19:53.727577 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:19:53.728271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:19:53.738881 [info ] [MainThread]: dbt version: 1.8.9
[0m11:19:53.739413 [info ] [MainThread]: python version: 3.13.2
[0m11:19:53.739836 [info ] [MainThread]: python path: /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/env/bin/python
[0m11:19:53.740250 [info ] [MainThread]: os info: Linux-6.14.2-arch1-1-x86_64-with-glibc2.41
[0m11:19:53.827542 [info ] [MainThread]: Using profiles dir at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar
[0m11:19:53.828064 [info ] [MainThread]: Using profiles.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/profiles.yml
[0m11:19:53.828498 [info ] [MainThread]: Using dbt_project.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/dbt_project.yml
[0m11:19:53.829113 [info ] [MainThread]: adapter type: clickhouse
[0m11:19:53.829544 [info ] [MainThread]: adapter version: 1.8.9
[0m11:19:53.955486 [info ] [MainThread]: Configuration:
[0m11:19:53.956031 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:19:53.956485 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:19:53.956919 [info ] [MainThread]: Required dependencies:
[0m11:19:53.957490 [debug] [MainThread]: Executing "git --help"
[0m11:19:53.965451 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:19:53.966096 [debug] [MainThread]: STDERR: "b''"
[0m11:19:53.966513 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:19:53.966958 [info ] [MainThread]: Connection:
[0m11:19:53.967438 [info ] [MainThread]:   driver: None
[0m11:19:53.967957 [info ] [MainThread]:   host: localhost
[0m11:19:53.968487 [info ] [MainThread]:   port: 9000
[0m11:19:53.968907 [info ] [MainThread]:   user: user
[0m11:19:53.969321 [info ] [MainThread]:   schema: adw02_stag
[0m11:19:53.969756 [info ] [MainThread]:   retries: 1
[0m11:19:53.970181 [info ] [MainThread]:   database_engine: None
[0m11:19:53.970624 [info ] [MainThread]:   cluster_mode: False
[0m11:19:53.971050 [info ] [MainThread]:   secure: False
[0m11:19:53.971496 [info ] [MainThread]:   verify: True
[0m11:19:53.971908 [info ] [MainThread]:   client_cert: None
[0m11:19:53.972323 [info ] [MainThread]:   client_cert_key: None
[0m11:19:53.972803 [info ] [MainThread]:   connect_timeout: 10
[0m11:19:53.973227 [info ] [MainThread]:   send_receive_timeout: 300
[0m11:19:53.973688 [info ] [MainThread]:   sync_request_timeout: 5
[0m11:19:53.974263 [info ] [MainThread]:   compress_block_size: 1048576
[0m11:19:53.974882 [info ] [MainThread]:   compression: 
[0m11:19:53.975629 [info ] [MainThread]:   check_exchange: True
[0m11:19:53.976413 [info ] [MainThread]:   custom_settings: None
[0m11:19:53.977201 [info ] [MainThread]:   use_lw_deletes: False
[0m11:19:53.977912 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m11:19:53.978630 [info ] [MainThread]:   tcp_keepalive: False
[0m11:19:53.979227 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:19:54.078155 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m11:19:54.078676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:54.368156 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m11:19:54.371465 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:19:54.402388 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:19:54.402900 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:19:54.404387 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7492501, "process_in_blocks": "3472", "process_kernel_time": 0.197622, "process_mem_max_rss": "132624", "process_out_blocks": "24", "process_user_time": 2.230371}
[0m11:19:54.404994 [debug] [MainThread]: Command `dbt debug` succeeded at 11:19:54.404837 after 0.75 seconds
[0m11:19:54.405465 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:19:54.406003 [debug] [MainThread]: On debug: Close
[0m11:19:54.406622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682c246780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682a949010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e682c1ef570>]}
[0m11:19:54.407367 [debug] [MainThread]: Flushing usage events
[0m11:27:10.145327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d15428a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d152199590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d152199450>]}


============================== 11:27:10.149314 | 1edcedd1-faee-4714-b394-7496813c691a ==============================
[0m11:27:10.149314 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:27:10.150022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:10.161357 [info ] [MainThread]: dbt version: 1.8.9
[0m11:27:10.161885 [info ] [MainThread]: python version: 3.13.2
[0m11:27:10.162316 [info ] [MainThread]: python path: /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/env/bin/python
[0m11:27:10.162749 [info ] [MainThread]: os info: Linux-6.14.2-arch1-1-x86_64-with-glibc2.41
[0m11:27:10.251743 [info ] [MainThread]: Using profiles dir at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar
[0m11:27:10.252267 [info ] [MainThread]: Using profiles.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/profiles.yml
[0m11:27:10.252702 [info ] [MainThread]: Using dbt_project.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/dbt_project.yml
[0m11:27:10.253315 [info ] [MainThread]: adapter type: clickhouse
[0m11:27:10.253746 [info ] [MainThread]: adapter version: 1.8.9
[0m11:27:10.384465 [info ] [MainThread]: Configuration:
[0m11:27:10.384990 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:27:10.385423 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:27:10.385835 [info ] [MainThread]: Required dependencies:
[0m11:27:10.386268 [debug] [MainThread]: Executing "git --help"
[0m11:27:10.388622 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:10.389280 [debug] [MainThread]: STDERR: "b''"
[0m11:27:10.389736 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:27:10.390175 [info ] [MainThread]: Connection:
[0m11:27:10.390623 [info ] [MainThread]:   driver: None
[0m11:27:10.391028 [info ] [MainThread]:   host: localhost
[0m11:27:10.391494 [info ] [MainThread]:   port: 9000
[0m11:27:10.391891 [info ] [MainThread]:   user: user
[0m11:27:10.392286 [info ] [MainThread]:   schema: adw02_stag
[0m11:27:10.392701 [info ] [MainThread]:   retries: 1
[0m11:27:10.393096 [info ] [MainThread]:   database_engine: None
[0m11:27:10.393505 [info ] [MainThread]:   cluster_mode: False
[0m11:27:10.393900 [info ] [MainThread]:   secure: False
[0m11:27:10.394290 [info ] [MainThread]:   verify: True
[0m11:27:10.394710 [info ] [MainThread]:   client_cert: None
[0m11:27:10.395181 [info ] [MainThread]:   client_cert_key: None
[0m11:27:10.395656 [info ] [MainThread]:   connect_timeout: 10
[0m11:27:10.396054 [info ] [MainThread]:   send_receive_timeout: 300
[0m11:27:10.396489 [info ] [MainThread]:   sync_request_timeout: 5
[0m11:27:10.396901 [info ] [MainThread]:   compress_block_size: 1048576
[0m11:27:10.397414 [info ] [MainThread]:   compression: 
[0m11:27:10.397821 [info ] [MainThread]:   check_exchange: True
[0m11:27:10.398211 [info ] [MainThread]:   custom_settings: None
[0m11:27:10.398619 [info ] [MainThread]:   use_lw_deletes: False
[0m11:27:10.399012 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m11:27:10.399485 [info ] [MainThread]:   tcp_keepalive: False
[0m11:27:10.400047 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:27:10.493603 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m11:27:10.494105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:10.773611 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m11:27:10.776928 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:27:10.808631 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:27:10.809152 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:27:10.810173 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.72756296, "process_in_blocks": "0", "process_kernel_time": 0.163228, "process_mem_max_rss": "132588", "process_out_blocks": "16", "process_user_time": 2.225012}
[0m11:27:10.810770 [debug] [MainThread]: Command `dbt debug` succeeded at 11:27:10.810622 after 0.73 seconds
[0m11:27:10.811201 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:27:10.811654 [debug] [MainThread]: On debug: Close
[0m11:27:10.812223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d151f22780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d150625010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d151ecb790>]}
[0m11:27:10.812876 [debug] [MainThread]: Flushing usage events
[0m11:27:26.436076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b9692120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b75b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b75b1450>]}


============================== 11:27:26.440117 | 5ad42029-398b-430b-a743-6e39e5a162f9 ==============================
[0m11:27:26.440117 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:27:26.440980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:27:26.451869 [info ] [MainThread]: dbt version: 1.8.9
[0m11:27:26.452464 [info ] [MainThread]: python version: 3.13.2
[0m11:27:26.453085 [info ] [MainThread]: python path: /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/env/bin/python
[0m11:27:26.453687 [info ] [MainThread]: os info: Linux-6.14.2-arch1-1-x86_64-with-glibc2.41
[0m11:27:26.540572 [info ] [MainThread]: Using profiles dir at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar
[0m11:27:26.541133 [info ] [MainThread]: Using profiles.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/profiles.yml
[0m11:27:26.541765 [info ] [MainThread]: Using dbt_project.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/dbt_project.yml
[0m11:27:26.542546 [info ] [MainThread]: adapter type: clickhouse
[0m11:27:26.542985 [info ] [MainThread]: adapter version: 1.8.9
[0m11:27:26.670004 [info ] [MainThread]: Configuration:
[0m11:27:26.670611 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:27:26.671248 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:27:26.671823 [info ] [MainThread]: Required dependencies:
[0m11:27:26.672414 [debug] [MainThread]: Executing "git --help"
[0m11:27:26.674838 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:26.675462 [debug] [MainThread]: STDERR: "b''"
[0m11:27:26.675866 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:27:26.676309 [info ] [MainThread]: Connection:
[0m11:27:26.676771 [info ] [MainThread]:   driver: None
[0m11:27:26.677184 [info ] [MainThread]:   host: localhost
[0m11:27:26.677602 [info ] [MainThread]:   port: 9000
[0m11:27:26.678024 [info ] [MainThread]:   user: user
[0m11:27:26.678579 [info ] [MainThread]:   schema: adw02_stag
[0m11:27:26.678997 [info ] [MainThread]:   retries: 1
[0m11:27:26.679426 [info ] [MainThread]:   database_engine: None
[0m11:27:26.679850 [info ] [MainThread]:   cluster_mode: False
[0m11:27:26.680496 [info ] [MainThread]:   secure: False
[0m11:27:26.680906 [info ] [MainThread]:   verify: True
[0m11:27:26.681301 [info ] [MainThread]:   client_cert: None
[0m11:27:26.681721 [info ] [MainThread]:   client_cert_key: None
[0m11:27:26.682114 [info ] [MainThread]:   connect_timeout: 10
[0m11:27:26.682538 [info ] [MainThread]:   send_receive_timeout: 300
[0m11:27:26.682931 [info ] [MainThread]:   sync_request_timeout: 5
[0m11:27:26.683324 [info ] [MainThread]:   compress_block_size: 1048576
[0m11:27:26.683737 [info ] [MainThread]:   compression: 
[0m11:27:26.684131 [info ] [MainThread]:   check_exchange: True
[0m11:27:26.684561 [info ] [MainThread]:   custom_settings: None
[0m11:27:26.684980 [info ] [MainThread]:   use_lw_deletes: False
[0m11:27:26.685435 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m11:27:26.685857 [info ] [MainThread]:   tcp_keepalive: False
[0m11:27:26.686575 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:27:26.782539 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m11:27:26.783047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:27.089411 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m11:27:27.092807 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:27:27.126840 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:27:27.127523 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:27:27.128788 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.75395703, "process_in_blocks": "0", "process_kernel_time": 0.177794, "process_mem_max_rss": "132580", "process_out_blocks": "8", "process_user_time": 2.228099}
[0m11:27:27.129735 [debug] [MainThread]: Command `dbt debug` succeeded at 11:27:27.129523 after 0.76 seconds
[0m11:27:27.130380 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:27:27.130864 [debug] [MainThread]: On debug: Close
[0m11:27:27.131619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b733a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b5a41010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7986b72e3790>]}
[0m11:27:27.132549 [debug] [MainThread]: Flushing usage events
[0m11:34:24.996640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e986e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e7781590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e7781450>]}


============================== 11:34:25.000596 | 391f221c-d0b8-488b-aeac-b9da81f75a30 ==============================
[0m11:34:25.000596 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:34:25.001311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:34:25.012019 [info ] [MainThread]: dbt version: 1.8.9
[0m11:34:25.012557 [info ] [MainThread]: python version: 3.13.2
[0m11:34:25.012977 [info ] [MainThread]: python path: /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/env/bin/python
[0m11:34:25.013399 [info ] [MainThread]: os info: Linux-6.14.2-arch1-1-x86_64-with-glibc2.41
[0m11:34:25.102153 [info ] [MainThread]: Using profiles dir at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar
[0m11:34:25.102690 [info ] [MainThread]: Using profiles.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/profiles.yml
[0m11:34:25.103111 [info ] [MainThread]: Using dbt_project.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/dbt_project.yml
[0m11:34:25.103721 [info ] [MainThread]: adapter type: clickhouse
[0m11:34:25.104196 [info ] [MainThread]: adapter version: 1.8.9
[0m11:34:25.231015 [info ] [MainThread]: Configuration:
[0m11:34:25.231573 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:34:25.232011 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:34:25.232451 [info ] [MainThread]: Required dependencies:
[0m11:34:25.232899 [debug] [MainThread]: Executing "git --help"
[0m11:34:25.235312 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:34:25.235936 [debug] [MainThread]: STDERR: "b''"
[0m11:34:25.236550 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:34:25.237005 [info ] [MainThread]: Connection:
[0m11:34:25.237481 [info ] [MainThread]:   driver: None
[0m11:34:25.237914 [info ] [MainThread]:   host: localhost
[0m11:34:25.238329 [info ] [MainThread]:   port: 9000
[0m11:34:25.238757 [info ] [MainThread]:   user: user
[0m11:34:25.239165 [info ] [MainThread]:   schema: adw02_stag
[0m11:34:25.239622 [info ] [MainThread]:   retries: 1
[0m11:34:25.240036 [info ] [MainThread]:   database_engine: None
[0m11:34:25.240459 [info ] [MainThread]:   cluster_mode: False
[0m11:34:25.240985 [info ] [MainThread]:   secure: False
[0m11:34:25.241403 [info ] [MainThread]:   verify: True
[0m11:34:25.241813 [info ] [MainThread]:   client_cert: None
[0m11:34:25.242228 [info ] [MainThread]:   client_cert_key: None
[0m11:34:25.242655 [info ] [MainThread]:   connect_timeout: 10
[0m11:34:25.243062 [info ] [MainThread]:   send_receive_timeout: 300
[0m11:34:25.243584 [info ] [MainThread]:   sync_request_timeout: 5
[0m11:34:25.244001 [info ] [MainThread]:   compress_block_size: 1048576
[0m11:34:25.244424 [info ] [MainThread]:   compression: 
[0m11:34:25.245022 [info ] [MainThread]:   check_exchange: True
[0m11:34:25.245455 [info ] [MainThread]:   custom_settings: None
[0m11:34:25.245870 [info ] [MainThread]:   use_lw_deletes: False
[0m11:34:25.246281 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m11:34:25.246724 [info ] [MainThread]:   tcp_keepalive: False
[0m11:34:25.247370 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:34:25.345166 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m11:34:25.345684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:25.627615 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m11:34:25.630850 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:34:25.660755 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:34:25.661279 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:34:25.662256 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7305293, "process_in_blocks": "0", "process_kernel_time": 0.176712, "process_mem_max_rss": "132864", "process_out_blocks": "16", "process_user_time": 2.196322}
[0m11:34:25.662854 [debug] [MainThread]: Command `dbt debug` succeeded at 11:34:25.662697 after 0.73 seconds
[0m11:34:25.663287 [debug] [MainThread]: Connection 'debug' was left open.
[0m11:34:25.663758 [debug] [MainThread]: On debug: Close
[0m11:34:25.664370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e7516780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e5c29010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7268e74bf790>]}
[0m11:34:25.665111 [debug] [MainThread]: Flushing usage events
[0m11:34:31.077293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a74aa8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7489ad590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7489ad450>]}


============================== 11:34:31.081338 | 3080f226-08e0-40d6-b6c3-393d9f8392e4 ==============================
[0m11:34:31.081338 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:34:31.082028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:31.300238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7499e1cd0>]}
[0m11:34:31.375504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a74881f790>]}
[0m11:34:31.376371 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:34:31.499851 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:34:31.500795 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:34:31.501269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7487f4850>]}
[0m11:34:33.492725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:34:33.493375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a748800320>]}
[0m11:34:33.772338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:34:33.786410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a748337af0>]}
[0m11:34:33.921542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a748517860>]}
[0m11:34:33.922200 [info ] [MainThread]: Found 1 model, 2 data tests, 10 sources, 608 macros
[0m11:34:33.922725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a746a98590>]}
[0m11:34:33.925385 [info ] [MainThread]: 
[0m11:34:33.926241 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:34:33.927689 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:34:33.941085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:34.230330 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:34:34.233828 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:34:34.266171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:34:34.274130 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:34:34.291469 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:34:34.293528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a744d2aba0>]}
[0m11:34:34.294246 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:34:34.294788 [info ] [MainThread]: 
[0m11:34:34.303735 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:34:34.304518 [info ] [Thread-1 (]: 1 of 1 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:34:34.305133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:34:34.305639 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:34:34.314999 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:34:34.315986 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:34:34.349789 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:34:34.396406 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:34:34.422513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:34:34.446728 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:34:34.451640 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:34:34.457985 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:34:34.459031 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:34:34.540198 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m11:34:34.569483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080f226-08e0-40d6-b6c3-393d9f8392e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7492fcf50>]}
[0m11:34:34.570364 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.26s]
[0m11:34:34.571206 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:34:34.572864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:34.573296 [debug] [MainThread]: Connection 'model.sakstar.stg_customer' was left open.
[0m11:34:34.573962 [debug] [MainThread]: On model.sakstar.stg_customer: Close
[0m11:34:34.574605 [info ] [MainThread]: 
[0m11:34:34.575188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m11:34:34.576125 [debug] [MainThread]: Command end result
[0m11:34:34.624335 [info ] [MainThread]: 
[0m11:34:34.624950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:34.625419 [info ] [MainThread]: 
[0m11:34:34.625896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:34:34.626947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6104908, "process_in_blocks": "736", "process_kernel_time": 0.23123, "process_mem_max_rss": "143852", "process_out_blocks": "4088", "process_user_time": 4.823789}
[0m11:34:34.627558 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:34.627400 after 3.61 seconds
[0m11:34:34.628051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a746ac6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a746c454d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a74886edd0>]}
[0m11:34:34.628620 [debug] [MainThread]: Flushing usage events
[0m11:35:57.758269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceef0e92120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeeed9d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeeed9d450>]}


============================== 11:35:57.760965 | 8d04fb53-1610-40b3-856c-aac75fb6c23f ==============================
[0m11:35:57.760965 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:35:57.761464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:35:57.905515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeefdd1cd0>]}
[0m11:35:57.954776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeeec0f790>]}
[0m11:35:57.955449 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:35:58.034205 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:35:58.133414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:58.133730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:58.138727 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:35:58.172757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeeebe7e50>]}
[0m11:35:58.259794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeeebf1f40>]}
[0m11:35:58.260186 [info ] [MainThread]: Found 1 model, 2 data tests, 10 sources, 608 macros
[0m11:35:58.260525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeee772b30>]}
[0m11:35:58.261950 [info ] [MainThread]: 
[0m11:35:58.262471 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:35:58.263237 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:35:58.275552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:58.476926 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:35:58.479099 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:35:58.499596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:35:58.504426 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:35:58.518303 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:35:58.519767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeec8dd710>]}
[0m11:35:58.520201 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:35:58.520498 [info ] [MainThread]: 
[0m11:35:58.522527 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:35:58.523015 [info ] [Thread-1 (]: 1 of 1 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:35:58.523497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:35:58.523845 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:35:58.530567 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:35:58.531125 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:35:58.553762 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:35:58.583098 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:35:58.604483 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:35:58.619460 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:35:58.622939 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:35:58.627066 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:35:58.627700 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:35:58.679693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:35:58.697762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d04fb53-1610-40b3-856c-aac75fb6c23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeec8ce690>]}
[0m11:35:58.698321 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m11:35:58.698857 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:35:58.699918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:58.700209 [debug] [MainThread]: Connection 'model.sakstar.stg_customer' was left open.
[0m11:35:58.700531 [debug] [MainThread]: On model.sakstar.stg_customer: Close
[0m11:35:58.700873 [info ] [MainThread]: 
[0m11:35:58.701259 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m11:35:58.702045 [debug] [MainThread]: Command end result
[0m11:35:58.729758 [info ] [MainThread]: 
[0m11:35:58.730202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:58.730542 [info ] [MainThread]: 
[0m11:35:58.730903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:35:58.731660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.01356, "process_in_blocks": "0", "process_kernel_time": 0.136611, "process_mem_max_rss": "138912", "process_out_blocks": "2752", "process_user_time": 1.880829}
[0m11:35:58.732031 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:58.731940 after 1.01 seconds
[0m11:35:58.732373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeec8f22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeec4c22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceeec4c2210>]}
[0m11:35:58.732690 [debug] [MainThread]: Flushing usage events
[0m11:42:08.707205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74004a39e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400482c1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400482c1450>]}


============================== 11:42:08.709952 | a0c8f693-cb89-44fe-a4cf-b3e82bfc879f ==============================
[0m11:42:08.709952 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:42:08.710425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:42:08.861436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400492f5cd0>]}
[0m11:42:08.911538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740048133790>]}
[0m11:42:08.912090 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:42:08.989954 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:42:09.095178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 2 files changed.
[0m11:42:09.095664 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/staff/stg_staff.sql
[0m11:42:09.095972 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/store/stg_store.sql
[0m11:42:09.096432 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/store/stg_store.yml
[0m11:42:09.096768 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/staff/stg_staff.yml
[0m11:42:09.097154 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/staging_sources.yml
[0m11:42:09.097645 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/customer/stg_customer.sql
[0m11:42:09.303656 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:42:09.304057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74004810ae50>]}
[0m11:42:09.546941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:42:09.557894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740047dbe300>]}
[0m11:42:09.693811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740047c335b0>]}
[0m11:42:09.694229 [info ] [MainThread]: Found 3 models, 6 data tests, 10 sources, 608 macros
[0m11:42:09.694629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740047b635f0>]}
[0m11:42:09.696635 [info ] [MainThread]: 
[0m11:42:09.697113 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:42:09.703103 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:42:09.712519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:09.902741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:42:09.905496 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:42:09.926724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:42:09.931507 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:42:09.943183 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:42:09.944664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400464b2450>]}
[0m11:42:09.945115 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:42:09.945427 [info ] [MainThread]: 
[0m11:42:09.947459 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:42:09.948103 [info ] [Thread-1 (]: 1 of 3 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:42:09.948794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:42:09.949144 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:42:09.955401 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:42:09.955944 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:42:09.973455 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:42:10.005095 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila.address a ON c.address_id = a.address_id
    JOIN sakila.city ci ON a.city_id = ci.city_id
    JOIN sakila.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:42:10.013882 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila.address a ON c.address_id = a.address_id
    JOIN sakila.city ci ON a.city_id = ci.city_id
    JOIN sakila.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        
[0m11:42:10.023103 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/customer/stg_customer.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.024478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740044190050>]}
[0m11:42:10.025020 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model `adw02_stag`.`stg_customer` .............. [[31mERROR[0m in 0.07s]
[0m11:42:10.025837 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:42:10.026263 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:42:10.026715 [info ] [Thread-1 (]: 2 of 3 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m11:42:10.027128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_staff)
[0m11:42:10.027458 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:42:10.029106 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:42:10.030333 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:42:10.032779 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:42:10.033821 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m11:42:10.038317 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        
[0m11:42:10.046357 [debug] [Thread-1 (]: Database Error in model stg_staff (models/staging/staff/stg_staff.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.046935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400443379d0>]}
[0m11:42:10.047576 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model `adw02_stag`.`stg_staff` ................. [[31mERROR[0m in 0.02s]
[0m11:42:10.048205 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:42:10.048596 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:42:10.049000 [info ] [Thread-1 (]: 3 of 3 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m11:42:10.049705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:42:10.050189 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:42:10.051965 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:42:10.052590 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:42:10.054768 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:42:10.055679 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila.address a ON s.address_id = a.address_id
    JOIN sakila.city ci ON a.city_id = ci.city_id
    JOIN sakila.country co ON ci.country_id = co.country_id
    JOIN sakila.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:42:10.060534 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila.address a ON s.address_id = a.address_id
    JOIN sakila.city ci ON a.city_id = ci.city_id
    JOIN sakila.country co ON ci.country_id = co.country_id
    JOIN sakila.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        
[0m11:42:10.068160 [debug] [Thread-1 (]: Database Error in model stg_store (models/staging/store/stg_store.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.068716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c8f693-cb89-44fe-a4cf-b3e82bfc879f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400441906d0>]}
[0m11:42:10.069226 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model `adw02_stag`.`stg_store` ................. [[31mERROR[0m in 0.02s]
[0m11:42:10.069914 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:42:10.071261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:10.071675 [debug] [MainThread]: Connection 'model.sakstar.stg_store' was left open.
[0m11:42:10.072006 [debug] [MainThread]: On model.sakstar.stg_store: Close
[0m11:42:10.072376 [info ] [MainThread]: 
[0m11:42:10.072714 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:42:10.074110 [debug] [MainThread]: Command end result
[0m11:42:10.106624 [info ] [MainThread]: 
[0m11:42:10.107003 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:42:10.107284 [info ] [MainThread]: 
[0m11:42:10.107823 [error] [MainThread]:   Database Error in model stg_customer (models/staging/customer/stg_customer.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.108255 [info ] [MainThread]: 
[0m11:42:10.108800 [error] [MainThread]:   Database Error in model stg_staff (models/staging/staff/stg_staff.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.109376 [info ] [MainThread]: 
[0m11:42:10.109896 [error] [MainThread]:   Database Error in model stg_store (models/staging/store/stg_store.sql)
  Code: 81.
  DB::Exception: Database sakila does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x0000000009c7390b
  3. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000130c872a
  4. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000012ffb35e
  5. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000012b27058
  6. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x00000000128ed633
  7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d0ebf
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  9. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  11. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  12. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  13. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  14. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  15. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  16. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  17. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  18. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  19. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  20. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  21. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  22. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  23. DB::TCPHandler::run() @ 0x00000000149089f9
  24. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  25. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  26. Poco::PooledThread::run() @ 0x0000000017fda0db
  27. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  28. ? @ 0x00007fb490894ac3
  29. ? @ 0x00007fb490926850
[0m11:42:10.110332 [info ] [MainThread]: 
[0m11:42:10.110723 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m11:42:10.111539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4441557, "process_in_blocks": "0", "process_kernel_time": 0.137155, "process_mem_max_rss": "143576", "process_out_blocks": "4288", "process_user_time": 2.376092}
[0m11:42:10.111942 [debug] [MainThread]: Command `dbt run` failed at 11:42:10.111850 after 1.44 seconds
[0m11:42:10.112272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740048182dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74004c2788a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74004a0df710>]}
[0m11:42:10.112633 [debug] [MainThread]: Flushing usage events
[0m11:43:09.002791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c559a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c34a5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c34a5450>]}


============================== 11:43:09.005477 | 40700d89-6305-489e-be3c-3f35d857d38c ==============================
[0m11:43:09.005477 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:43:09.005941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:09.155459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c44d9cd0>]}
[0m11:43:09.206458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c3317790>]}
[0m11:43:09.207212 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:43:09.290255 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:09.395141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:43:09.395687 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/staging_sources.yml
[0m11:43:09.396083 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/staff/stg_staff.sql
[0m11:43:09.396570 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/customer/stg_customer.sql
[0m11:43:09.396932 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/store/stg_store.sql
[0m11:43:09.656143 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:43:09.656553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c2f24250>]}
[0m11:43:09.829392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:43:09.839057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c1483b60>]}
[0m11:43:09.970550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c152e5f0>]}
[0m11:43:09.970992 [info ] [MainThread]: Found 3 models, 6 data tests, 10 sources, 608 macros
[0m11:43:09.971316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c2f5b5f0>]}
[0m11:43:09.973002 [info ] [MainThread]: 
[0m11:43:09.973506 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:43:09.979038 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:43:09.988811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:10.200596 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:43:10.208826 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:43:10.254479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:43:10.259605 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:43:10.273465 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:43:10.275008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c14965d0>]}
[0m11:43:10.275661 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:43:10.276172 [info ] [MainThread]: 
[0m11:43:10.278439 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:43:10.278964 [info ] [Thread-1 (]: 1 of 3 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:43:10.279467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:43:10.279887 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:43:10.286526 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:43:10.287199 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:43:10.305669 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:43:10.336924 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:43:10.352588 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:43:10.368283 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:43:10.372183 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:43:10.376629 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:43:10.377244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:43:10.429743 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:43:10.449758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235b32cc310>]}
[0m11:43:10.450443 [info ] [Thread-1 (]: 1 of 3 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m11:43:10.451155 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:43:10.451782 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:43:10.452332 [info ] [Thread-1 (]: 2 of 3 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m11:43:10.452801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_staff)
[0m11:43:10.453200 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:43:10.455015 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:43:10.455848 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:43:10.458206 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:43:10.459671 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m11:43:10.471589 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:43:10.474536 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:43:10.477822 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:43:10.480010 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:43:10.480681 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m11:43:10.495602 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:43:10.497553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235b327f7f0>]}
[0m11:43:10.498062 [info ] [Thread-1 (]: 2 of 3 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m11:43:10.498649 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:43:10.499010 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:43:10.499560 [info ] [Thread-1 (]: 3 of 3 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m11:43:10.500148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:43:10.500562 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:43:10.506677 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:43:10.507204 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:43:10.508965 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:43:10.509988 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:43:10.527704 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:43:10.530300 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:43:10.533517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:43:10.535664 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:43:10.536214 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m11:43:10.596417 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:43:10.597973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40700d89-6305-489e-be3c-3f35d857d38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c2df9350>]}
[0m11:43:10.598480 [info ] [Thread-1 (]: 3 of 3 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.10s]
[0m11:43:10.598992 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:43:10.600193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:10.600483 [debug] [MainThread]: Connection 'model.sakstar.stg_store' was left open.
[0m11:43:10.600759 [debug] [MainThread]: On model.sakstar.stg_store: Close
[0m11:43:10.601143 [info ] [MainThread]: 
[0m11:43:10.601603 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m11:43:10.602648 [debug] [MainThread]: Command end result
[0m11:43:10.631449 [info ] [MainThread]: 
[0m11:43:10.631833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:10.632119 [info ] [MainThread]: 
[0m11:43:10.632421 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:43:10.633087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6717633, "process_in_blocks": "0", "process_kernel_time": 0.162057, "process_mem_max_rss": "143156", "process_out_blocks": "4264", "process_user_time": 2.340379}
[0m11:43:10.633462 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:10.633369 after 1.67 seconds
[0m11:43:10.633781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c3366dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c75388a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7235c48abb90>]}
[0m11:43:10.634101 [debug] [MainThread]: Flushing usage events
[0m11:46:06.683579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b348e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b13ad590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b13ad450>]}


============================== 11:46:06.686360 | 6b6f7a99-c9e8-4e92-99bf-b2c46333044f ==============================
[0m11:46:06.686360 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:46:06.686898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:46:06.832898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b23e1cd0>]}
[0m11:46:06.884443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b121f790>]}
[0m11:46:06.885108 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:46:06.968518 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:46:07.072738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m11:46:07.073365 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/rental/stg_rental.yml
[0m11:46:07.073719 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/rental/stg_rental.sql
[0m11:46:07.074010 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/film/stg_film.sql
[0m11:46:07.074447 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/film/stg_film.yml
[0m11:46:07.276216 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:46:07.276662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b0e31550>]}
[0m11:46:07.427693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:46:07.439891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b0f48e60>]}
[0m11:46:07.539401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b00cc9f0>]}
[0m11:46:07.539804 [info ] [MainThread]: Found 5 models, 10 data tests, 10 sources, 608 macros
[0m11:46:07.540186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b00ffa00>]}
[0m11:46:07.542617 [info ] [MainThread]: 
[0m11:46:07.543134 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:46:07.549624 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:46:07.561086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:07.824186 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:46:07.833300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:46:07.882016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:46:07.887255 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:46:07.899318 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:46:07.901247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ab112150>]}
[0m11:46:07.901821 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:46:07.902142 [info ] [MainThread]: 
[0m11:46:07.904565 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:46:07.905070 [info ] [Thread-1 (]: 1 of 5 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:46:07.905586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:46:07.905902 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:46:07.912247 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:46:07.912859 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:46:07.930569 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:46:07.960736 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:46:07.976459 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:46:07.991132 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:46:07.994842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:46:07.999168 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:46:07.999784 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:46:08.052409 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:46:08.070499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a943fb70>]}
[0m11:46:08.071031 [info ] [Thread-1 (]: 1 of 5 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.16s]
[0m11:46:08.071703 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:46:08.072080 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m11:46:08.072658 [info ] [Thread-1 (]: 2 of 5 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m11:46:08.073178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m11:46:08.073651 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m11:46:08.075304 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m11:46:08.075909 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m11:46:08.078267 [debug] [Thread-1 (]: Creating new relation stg_film
[0m11:46:08.079563 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m11:46:08.102016 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:46:08.112609 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:46:08.125950 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:46:08.135200 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m11:46:08.137031 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m11:46:08.191881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:46:08.194835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a91bba70>]}
[0m11:46:08.195850 [info ] [Thread-1 (]: 2 of 5 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.12s]
[0m11:46:08.196984 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m11:46:08.197891 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m11:46:08.198799 [info ] [Thread-1 (]: 3 of 5 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m11:46:08.199779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m11:46:08.200672 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m11:46:08.204396 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m11:46:08.205472 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m11:46:08.208949 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m11:46:08.210931 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF(r.return_date, r.rental_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m11:46:08.231564 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF(r.return_date, r.rental_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        
[0m11:46:08.248920 [debug] [Thread-1 (]: Database Error in model stg_rental (models/staging/rental/stg_rental.sql)
  Code: 42.
  DB::Exception: An incorrect number of arguments was specified for function 'dateDiff'. Expected 3 mandatory arguments and 1 optional argument, got 2 arguments: In scope WITH source AS (SELECT * FROM sakila_proxy.rental), inventory AS (SELECT * FROM sakila_proxy.inventory) SELECT r.rental_id AS rental_key, r.customer_id AS customer_key, i.film_id AS film_key, r.staff_id AS staff_key, i.store_id AS store_key, r.rental_date, r.return_date, i.inventory_id, dateDiff(r.return_date, r.rental_date) AS rental_duration, r.last_update FROM source AS r INNER JOIN inventory AS i ON r.inventory_id = i.inventory_id. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String, String&, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String&>::type, std::type_identity<String>::type>, String&&, String&, String&&) @ 0x0000000011997beb
  3. DB::validateFunctionArguments(DB::IFunction const&, std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&) @ 0x0000000011997abf
  4. DB::(anonymous namespace)::FunctionDateDiff<true>::getReturnTypeImpl(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x000000000ad638b3
  5. DB::IFunctionOverloadResolver::getReturnTypeWithoutLowCardinality(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987310
  6. DB::IFunctionOverloadResolver::build(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987daa
  7. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f773e
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  9. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  10. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  12. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  13. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  14. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  15. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  16. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  17. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  18. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  19. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  20. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  21. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  22. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  23. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  24. DB::TCPHandler::run() @ 0x00000000149089f9
  25. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  26. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  27. Poco::PooledThread::run() @ 0x0000000017fda0db
  28. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  29. ? @ 0x00007fb490894ac3
  30. ? @ 0x00007fb490926850
[0m11:46:08.249985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a92b8dd0>]}
[0m11:46:08.251026 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model `adw02_stag`.`stg_rental` ................ [[31mERROR[0m in 0.05s]
[0m11:46:08.252671 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m11:46:08.253318 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:46:08.254106 [info ] [Thread-1 (]: 4 of 5 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m11:46:08.254896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m11:46:08.255736 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:46:08.258636 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:46:08.260103 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:46:08.262497 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:46:08.263748 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m11:46:08.277483 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:46:08.282601 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:46:08.286071 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:46:08.288024 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:46:08.288815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m11:46:08.304563 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:46:08.306149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a8078440>]}
[0m11:46:08.306692 [info ] [Thread-1 (]: 4 of 5 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.05s]
[0m11:46:08.307209 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:46:08.307634 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:46:08.308029 [info ] [Thread-1 (]: 5 of 5 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m11:46:08.308512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:46:08.308824 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:46:08.310394 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:46:08.310962 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:46:08.313206 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:46:08.314266 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:46:08.332154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:46:08.334503 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:46:08.337660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:46:08.339723 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:46:08.340260 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m11:46:08.396872 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:46:08.398514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b6f7a99-c9e8-4e92-99bf-b2c46333044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b0d4ad50>]}
[0m11:46:08.399203 [info ] [Thread-1 (]: 5 of 5 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.09s]
[0m11:46:08.399825 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:46:08.401015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:08.401425 [debug] [MainThread]: Connection 'model.sakstar.stg_store' was left open.
[0m11:46:08.401701 [debug] [MainThread]: On model.sakstar.stg_store: Close
[0m11:46:08.402086 [info ] [MainThread]: 
[0m11:46:08.402619 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m11:46:08.404791 [debug] [MainThread]: Command end result
[0m11:46:08.434568 [info ] [MainThread]: 
[0m11:46:08.434966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:46:08.435372 [info ] [MainThread]: 
[0m11:46:08.436045 [error] [MainThread]:   Database Error in model stg_rental (models/staging/rental/stg_rental.sql)
  Code: 42.
  DB::Exception: An incorrect number of arguments was specified for function 'dateDiff'. Expected 3 mandatory arguments and 1 optional argument, got 2 arguments: In scope WITH source AS (SELECT * FROM sakila_proxy.rental), inventory AS (SELECT * FROM sakila_proxy.inventory) SELECT r.rental_id AS rental_key, r.customer_id AS customer_key, i.film_id AS film_key, r.staff_id AS staff_key, i.store_id AS store_key, r.rental_date, r.return_date, i.inventory_id, dateDiff(r.return_date, r.rental_date) AS rental_duration, r.last_update FROM source AS r INNER JOIN inventory AS i ON r.inventory_id = i.inventory_id. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String, String&, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String&>::type, std::type_identity<String>::type>, String&&, String&, String&&) @ 0x0000000011997beb
  3. DB::validateFunctionArguments(DB::IFunction const&, std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&) @ 0x0000000011997abf
  4. DB::(anonymous namespace)::FunctionDateDiff<true>::getReturnTypeImpl(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x000000000ad638b3
  5. DB::IFunctionOverloadResolver::getReturnTypeWithoutLowCardinality(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987310
  6. DB::IFunctionOverloadResolver::build(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987daa
  7. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f773e
  8. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  9. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  10. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  12. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  13. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  14. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  15. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  16. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  17. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  18. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  19. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
  20. DB::InterpreterCreateQuery::execute() @ 0x00000000131b6678
  21. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x00000000135904e8
  22. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  23. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  24. DB::TCPHandler::run() @ 0x00000000149089f9
  25. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  26. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  27. Poco::PooledThread::run() @ 0x0000000017fda0db
  28. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  29. ? @ 0x00007fb490894ac3
  30. ? @ 0x00007fb490926850
[0m11:46:08.436542 [info ] [MainThread]: 
[0m11:46:08.436871 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:46:08.437577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7964711, "process_in_blocks": "0", "process_kernel_time": 0.154938, "process_mem_max_rss": "143456", "process_out_blocks": "4432", "process_user_time": 2.422927}
[0m11:46:08.437936 [debug] [MainThread]: Command `dbt run` failed at 11:46:08.437848 after 1.80 seconds
[0m11:46:08.438253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78b2410d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a80596d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78a8059670>]}
[0m11:46:08.438563 [debug] [MainThread]: Flushing usage events
[0m11:49:57.458485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741741d92120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173fcb5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173fcb5450>]}


============================== 11:49:57.461201 | 12c436de-33a3-4fdf-a8a4-a9ff97cc2257 ==============================
[0m11:49:57.461201 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:49:57.461682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:49:57.601773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741740ce9cd0>]}
[0m11:49:57.650581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173fb3f570>]}
[0m11:49:57.651162 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:49:57.729663 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:49:57.831859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:57.832408 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/rental/stg_rental.sql
[0m11:49:58.021040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:49:58.021485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173faff750>]}
[0m11:49:58.158436 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:49:58.169519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173f616990>]}
[0m11:49:58.254585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173dce8750>]}
[0m11:49:58.254979 [info ] [MainThread]: Found 5 models, 10 data tests, 10 sources, 608 macros
[0m11:49:58.255390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173f7757e0>]}
[0m11:49:58.257190 [info ] [MainThread]: 
[0m11:49:58.257855 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:49:58.263319 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:49:58.272249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:58.513952 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:49:58.516427 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.537540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:49:58.542387 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:49:58.554831 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:49:58.556276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173de26690>]}
[0m11:49:58.556740 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:49:58.557052 [info ] [MainThread]: 
[0m11:49:58.559197 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:49:58.559737 [info ] [Thread-1 (]: 1 of 5 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:49:58.560224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:49:58.560629 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:49:58.566640 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:49:58.567204 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:49:58.583977 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:49:58.613376 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:49:58.632445 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:49:58.648514 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:49:58.652691 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.657523 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:49:58.658129 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:49:58.708967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:49:58.727150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173f4b7ee0>]}
[0m11:49:58.727806 [info ] [Thread-1 (]: 1 of 5 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m11:49:58.728479 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:49:58.728885 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m11:49:58.729399 [info ] [Thread-1 (]: 2 of 5 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m11:49:58.729816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m11:49:58.730176 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m11:49:58.731845 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m11:49:58.732420 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m11:49:58.734521 [debug] [Thread-1 (]: Creating new relation stg_film
[0m11:49:58.735743 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m11:49:58.749514 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:49:58.751854 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:49:58.755185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.757414 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m11:49:58.757968 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m11:49:58.786333 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:49:58.787978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741737aa0410>]}
[0m11:49:58.788528 [info ] [Thread-1 (]: 2 of 5 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.06s]
[0m11:49:58.789067 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m11:49:58.789460 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m11:49:58.789900 [info ] [Thread-1 (]: 3 of 5 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m11:49:58.790376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m11:49:58.790730 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m11:49:58.792683 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m11:49:58.793278 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m11:49:58.795039 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m11:49:58.795976 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.return_date, r.rental_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m11:49:58.809898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:49:58.813147 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:49:58.816777 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.818940 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m11:49:58.819515 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.return_date, r.rental_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m11:49:58.860478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:49:58.862188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741737baaf50>]}
[0m11:49:58.862691 [info ] [Thread-1 (]: 3 of 5 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.07s]
[0m11:49:58.863185 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m11:49:58.863554 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:49:58.864002 [info ] [Thread-1 (]: 4 of 5 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m11:49:58.864383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m11:49:58.864699 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:49:58.866258 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:49:58.866833 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:49:58.869279 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:49:58.870441 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m11:49:58.881942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:49:58.884485 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:49:58.887967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.890071 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:49:58.890786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m11:49:58.904686 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:49:58.906245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173f4b1d30>]}
[0m11:49:58.906916 [info ] [Thread-1 (]: 4 of 5 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m11:49:58.907425 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:49:58.907799 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:49:58.908256 [info ] [Thread-1 (]: 5 of 5 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m11:49:58.908814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:49:58.909196 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:49:58.911178 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:49:58.911737 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:49:58.913527 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:49:58.914765 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:49:58.932016 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:49:58.937221 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:49:58.940693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:49:58.942635 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:49:58.943161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m11:49:59.000197 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:49:59.001972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c436de-33a3-4fdf-a8a4-a9ff97cc2257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741737bee870>]}
[0m11:49:59.002530 [info ] [Thread-1 (]: 5 of 5 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.09s]
[0m11:49:59.003064 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:49:59.004210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:59.004543 [debug] [MainThread]: Connection 'model.sakstar.stg_store' was left open.
[0m11:49:59.004862 [debug] [MainThread]: On model.sakstar.stg_store: Close
[0m11:49:59.005460 [info ] [MainThread]: 
[0m11:49:59.005927 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:49:59.007267 [debug] [MainThread]: Command end result
[0m11:49:59.042810 [info ] [MainThread]: 
[0m11:49:59.043189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:59.043542 [info ] [MainThread]: 
[0m11:49:59.043857 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:49:59.044569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6270511, "process_in_blocks": "0", "process_kernel_time": 0.13996, "process_mem_max_rss": "143084", "process_out_blocks": "4424", "process_user_time": 2.270858}
[0m11:49:59.044963 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:59.044870 after 1.63 seconds
[0m11:49:59.045333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173f60f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74173fb34770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741736123b30>]}
[0m11:49:59.045882 [debug] [MainThread]: Flushing usage events
[0m11:51:27.261486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a438877e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a438668d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a438668d450>]}


============================== 11:51:27.264117 | d5356824-9196-421b-b08d-a78a51f56674 ==============================
[0m11:51:27.264117 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:51:27.264608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:27.408653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a43875f1cd0>]}
[0m11:51:27.457020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4386507790>]}
[0m11:51:27.457624 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:51:27.537124 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:51:27.640442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:27.641028 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/rental/stg_rental.sql
[0m11:51:27.835245 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:51:27.835668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a43864dfb50>]}
[0m11:51:27.977478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakstar.marts
[0m11:51:27.989264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4385e66c60>]}
[0m11:51:28.080068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a43846e4750>]}
[0m11:51:28.080827 [info ] [MainThread]: Found 5 models, 10 data tests, 10 sources, 608 macros
[0m11:51:28.081381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a438466fad0>]}
[0m11:51:28.084354 [info ] [MainThread]: 
[0m11:51:28.085084 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:51:28.092572 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:51:28.101508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:28.343643 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:51:28.346099 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.367242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:51:28.372166 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:51:28.385049 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:51:28.386596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4386052690>]}
[0m11:51:28.387051 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:51:28.387360 [info ] [MainThread]: 
[0m11:51:28.389492 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:51:28.389962 [info ] [Thread-1 (]: 1 of 5 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m11:51:28.390372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m11:51:28.390693 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:51:28.397365 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:51:28.397948 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:51:28.415251 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:51:28.446052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:51:28.466550 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:51:28.481708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:51:28.485572 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.489688 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:51:28.490257 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m11:51:28.540418 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:51:28.557695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4385e7fe30>]}
[0m11:51:28.558268 [info ] [Thread-1 (]: 1 of 5 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m11:51:28.558831 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:51:28.559232 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m11:51:28.559695 [info ] [Thread-1 (]: 2 of 5 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m11:51:28.560123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m11:51:28.560483 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m11:51:28.562012 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m11:51:28.562710 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m11:51:28.564959 [debug] [Thread-1 (]: Creating new relation stg_film
[0m11:51:28.566053 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m11:51:28.580662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:51:28.583063 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:51:28.586401 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.588611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m11:51:28.589190 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m11:51:28.616813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:51:28.618567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a437e44c370>]}
[0m11:51:28.619111 [info ] [Thread-1 (]: 2 of 5 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.06s]
[0m11:51:28.619666 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m11:51:28.620055 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m11:51:28.620506 [info ] [Thread-1 (]: 3 of 5 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m11:51:28.620912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m11:51:28.621368 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m11:51:28.623431 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m11:51:28.624013 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m11:51:28.625925 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m11:51:28.626957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m11:51:28.639979 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:51:28.642584 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:51:28.645735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.647735 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m11:51:28.648263 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m11:51:28.688661 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:51:28.690298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a437e55afd0>]}
[0m11:51:28.690820 [info ] [Thread-1 (]: 3 of 5 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.07s]
[0m11:51:28.691333 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m11:51:28.691703 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:51:28.692111 [info ] [Thread-1 (]: 4 of 5 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m11:51:28.692542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m11:51:28.692863 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:51:28.694465 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:51:28.695013 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:51:28.697266 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:51:28.698292 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m11:51:28.710952 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:51:28.713492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:51:28.716795 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.718868 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:51:28.719607 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m11:51:28.733493 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:51:28.735294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4385ea9da0>]}
[0m11:51:28.735845 [info ] [Thread-1 (]: 4 of 5 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m11:51:28.736477 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:51:28.736863 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:51:28.737388 [info ] [Thread-1 (]: 5 of 5 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m11:51:28.737820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:51:28.738177 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:51:28.740188 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:51:28.740767 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:51:28.742651 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:51:28.743705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m11:51:28.761897 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:51:28.767514 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:51:28.771309 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:51:28.773335 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:51:28.773915 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m11:51:28.832724 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:51:28.834339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5356824-9196-421b-b08d-a78a51f56674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a437e5136b0>]}
[0m11:51:28.834880 [info ] [Thread-1 (]: 5 of 5 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.10s]
[0m11:51:28.835492 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:51:28.836554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:28.836835 [debug] [MainThread]: Connection 'model.sakstar.stg_store' was left open.
[0m11:51:28.837334 [debug] [MainThread]: On model.sakstar.stg_store: Close
[0m11:51:28.837750 [info ] [MainThread]: 
[0m11:51:28.838162 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:51:28.839452 [debug] [MainThread]: Command end result
[0m11:51:28.875542 [info ] [MainThread]: 
[0m11:51:28.875936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:28.876231 [info ] [MainThread]: 
[0m11:51:28.876645 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:51:28.877670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6564304, "process_in_blocks": "0", "process_kernel_time": 0.158676, "process_mem_max_rss": "143032", "process_out_blocks": "4424", "process_user_time": 2.297694}
[0m11:51:28.878201 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:28.878082 after 1.66 seconds
[0m11:51:28.878653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a43875daf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a437caeba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a437caeb9b0>]}
[0m11:51:28.879045 [debug] [MainThread]: Flushing usage events
[0m12:02:03.930208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8d192120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8b0b5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8b0b5450>]}


============================== 12:02:03.934508 | 9d896956-3a5c-4d1e-aed1-4df5cf8109bb ==============================
[0m12:02:03.934508 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:02:03.935444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:02:04.170191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8c0e9cd0>]}
[0m12:02:04.250250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8af27790>]}
[0m12:02:04.251205 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:02:04.392497 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:02:04.561670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:02:04.562404 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_customer/dim_customer.yml
[0m12:02:04.562902 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m12:02:04.852908 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:02:04.853566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8ab4a050>]}
[0m12:02:05.084814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8a876c60>]}
[0m12:02:05.219467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d890fcbb0>]}
[0m12:02:05.220068 [info ] [MainThread]: Found 6 models, 12 data tests, 10 sources, 608 macros
[0m12:02:05.220590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d89203ba0>]}
[0m12:02:05.223518 [info ] [MainThread]: 
[0m12:02:05.224412 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:02:05.233233 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:02:05.246990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:05.589849 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:02:05.593144 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:05.628480 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:02:05.632411 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:05.634747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__adw02_star)
[0m12:02:05.635453 [debug] [ThreadPool]: Creating schema "schema: "adw02_star"
"
[0m12:02:05.644660 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "create__adw02_star"} */
create database if not exists `adw02_star`
        
  
        
  ...
[0m12:02:05.651591 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:02:05.654262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__adw02_star, now list__adw02_star)
[0m12:02:05.661816 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:02:05.677987 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:05.679987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:02:05.682257 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:02:05.696667 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:02:05.698875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d89116810>]}
[0m12:02:05.699594 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:02:05.700050 [info ] [MainThread]: 
[0m12:02:05.703645 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:02:05.704489 [info ] [Thread-1 (]: 1 of 6 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:02:05.705168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m12:02:05.705773 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:02:05.714906 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:02:05.715805 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:02:05.744203 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:02:05.788241 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:02:05.813474 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:05.836963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:02:05.841575 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:05.847673 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:02:05.848550 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
  ...
[0m12:02:05.926649 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m12:02:05.954199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8a88f070>]}
[0m12:02:05.955054 [info ] [Thread-1 (]: 1 of 6 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.25s]
[0m12:02:05.955879 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:02:05.956470 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:02:05.957115 [info ] [Thread-1 (]: 2 of 6 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m12:02:05.957783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:02:05.958392 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:02:05.960831 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:02:05.961911 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:02:05.965924 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:02:05.967849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m12:02:05.989234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:05.992949 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:02:05.997894 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:06.001383 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:02:06.002200 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m12:02:06.043516 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m12:02:06.045883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d82ea6710>]}
[0m12:02:06.046657 [info ] [Thread-1 (]: 2 of 6 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.09s]
[0m12:02:06.047440 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:02:06.047989 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:02:06.048731 [info ] [Thread-1 (]: 3 of 6 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m12:02:06.049464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m12:02:06.049965 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:02:06.052934 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:02:06.053846 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:02:06.056777 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:02:06.058322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m12:02:06.077686 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:06.081506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:02:06.085958 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:06.089168 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:02:06.090104 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m12:02:06.154996 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:02:06.157447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d82f700d0>]}
[0m12:02:06.158457 [info ] [Thread-1 (]: 3 of 6 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.11s]
[0m12:02:06.159531 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:02:06.160380 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:02:06.161407 [info ] [Thread-1 (]: 4 of 6 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m12:02:06.162061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:02:06.162703 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:02:06.164997 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:02:06.165950 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:02:06.169299 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:02:06.170793 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m12:02:06.187548 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:06.191144 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:02:06.195674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:06.202123 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:02:06.202957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m12:02:06.223755 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:06.226133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8c48d9b0>]}
[0m12:02:06.226993 [info ] [Thread-1 (]: 4 of 6 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.06s]
[0m12:02:06.227782 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:02:06.228319 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:02:06.228938 [info ] [Thread-1 (]: 5 of 6 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m12:02:06.229614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:02:06.230109 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:02:06.232565 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:02:06.233504 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:02:06.236299 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:02:06.238366 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:02:06.263838 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:02:06.267627 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:02:06.272475 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:06.277471 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:02:06.278609 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m12:02:06.365769 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m12:02:06.368142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8aa06390>]}
[0m12:02:06.368982 [info ] [Thread-1 (]: 5 of 6 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.14s]
[0m12:02:06.369958 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:02:06.370642 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:02:06.371320 [info ] [Thread-1 (]: 6 of 6 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:02:06.371928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:02:06.372534 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:02:06.376018 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:02:06.376959 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:02:06.380552 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:02:06.382016 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    customer_key,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:02:06.394773 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:02:06.398389 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:02:06.402839 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:02:06.406438 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:02:06.407486 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")SELECT
    customer_key,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
  ...
[0m12:02:06.415223 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:02:06.417751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d896956-3a5c-4d1e-aed1-4df5cf8109bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d82febb30>]}
[0m12:02:06.418514 [info ] [Thread-1 (]: 6 of 6 OK created sql table model `adw02_star`.`dim_customer` .................. [[32mOK[0m in 0.05s]
[0m12:02:06.419270 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:02:06.421314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:06.421879 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:02:06.422324 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:02:06.422979 [info ] [MainThread]: 
[0m12:02:06.423582 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m12:02:06.425582 [debug] [MainThread]: Command end result
[0m12:02:06.484605 [info ] [MainThread]: 
[0m12:02:06.485171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:06.485659 [info ] [MainThread]: 
[0m12:02:06.486124 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:02:06.487146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6208909, "process_in_blocks": "0", "process_kernel_time": 0.213125, "process_mem_max_rss": "143348", "process_out_blocks": "4504", "process_user_time": 3.582846}
[0m12:02:06.487755 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:06.487607 after 2.62 seconds
[0m12:02:06.488394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d8c3d97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d81503a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d815039b0>]}
[0m12:02:06.488916 [debug] [MainThread]: Flushing usage events
[0m12:08:59.472529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772902186120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772900095590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772900095450>]}


============================== 12:08:59.476736 | e66d105a-db77-48ab-b1bc-871e357c1151 ==============================
[0m12:08:59.476736 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:08:59.477587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:59.717714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772900ff9cd0>]}
[0m12:08:59.795265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728fff0f790>]}
[0m12:08:59.796135 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:08:59.920091 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:09:00.086077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:00.086984 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/customer/stg_customer.sql
[0m12:09:00.387406 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:09:00.388023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ffee7050>]}
[0m12:09:00.622833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ffa56210>]}
[0m12:09:00.756455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728fdeed010>]}
[0m12:09:00.757038 [info ] [MainThread]: Found 6 models, 12 data tests, 10 sources, 608 macros
[0m12:09:00.757515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ffb6fa00>]}
[0m12:09:00.760279 [info ] [MainThread]: 
[0m12:09:00.761118 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:09:00.769680 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:09:00.785911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:01.138431 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:09:01.141808 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.174909 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:09:01.178502 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.181697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:09:01.190110 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:09:01.206505 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.208422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:09:01.210633 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:09:01.226512 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.228456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728fde26510>]}
[0m12:09:01.229160 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:09:01.229698 [info ] [MainThread]: 
[0m12:09:01.233069 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:09:01.233895 [info ] [Thread-1 (]: 1 of 6 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:09:01.234603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m12:09:01.235100 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:09:01.244225 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:09:01.245052 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:09:01.274062 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:09:01.321126 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_key
          )
        
        ...
[0m12:09:01.347319 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m12:09:01.370149 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:09:01.374647 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.380775 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:09:01.381630 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_key,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_key
  ...
[0m12:09:01.457583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m12:09:01.484863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728fc1aeaf0>]}
[0m12:09:01.485717 [info ] [Thread-1 (]: 1 of 6 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.25s]
[0m12:09:01.486557 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:09:01.487173 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:09:01.487830 [info ] [Thread-1 (]: 2 of 6 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m12:09:01.488490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:09:01.489013 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:09:01.491366 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:09:01.492436 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:09:01.495322 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:09:01.497407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m12:09:01.515039 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.518645 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:09:01.523086 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.527561 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:09:01.528763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m12:09:01.593946 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:09:01.596429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728efee9630>]}
[0m12:09:01.597244 [info ] [Thread-1 (]: 2 of 6 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.11s]
[0m12:09:01.598229 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:09:01.599027 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:09:01.599712 [info ] [Thread-1 (]: 3 of 6 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m12:09:01.600506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m12:09:01.601737 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:09:01.607572 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:09:01.609092 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:09:01.614779 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:09:01.616245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m12:09:01.632524 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.639660 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:09:01.644466 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.647451 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:09:01.648247 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m12:09:01.709087 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:09:01.711435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728effcd650>]}
[0m12:09:01.712190 [info ] [Thread-1 (]: 3 of 6 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.11s]
[0m12:09:01.713026 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:09:01.713594 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:09:01.714211 [info ] [Thread-1 (]: 4 of 6 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m12:09:01.714806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:09:01.715442 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:09:01.717899 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:09:01.718729 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:09:01.721515 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:09:01.723535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m12:09:01.737967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:09:01.741545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:09:01.745988 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.748829 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:09:01.749619 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m12:09:01.770600 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.773374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728efeccc20>]}
[0m12:09:01.774197 [info ] [Thread-1 (]: 4 of 6 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.06s]
[0m12:09:01.775134 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:09:01.775915 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:09:01.777003 [info ] [Thread-1 (]: 5 of 6 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m12:09:01.777908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:09:01.778590 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:09:01.781299 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:09:01.782136 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:09:01.785586 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:09:01.787388 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:09:01.810149 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:09:01.813746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:09:01.818154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.821815 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:09:01.822771 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m12:09:01.920888 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.10 seconds
[0m12:09:01.923367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728effec410>]}
[0m12:09:01.927255 [info ] [Thread-1 (]: 5 of 6 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.15s]
[0m12:09:01.928296 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:09:01.928953 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:09:01.929668 [info ] [Thread-1 (]: 6 of 6 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:09:01.930470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:09:01.931517 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:09:01.935535 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:09:01.936435 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:09:01.939551 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:09:01.942019 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    customer_key,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:09:01.954087 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:09:01.957638 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:09:01.963202 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:09:01.967080 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:09:01.968013 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_key", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")SELECT
    customer_key,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
  ...
[0m12:09:01.975765 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:09:01.978179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e66d105a-db77-48ab-b1bc-871e357c1151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ee52cd10>]}
[0m12:09:01.978997 [info ] [Thread-1 (]: 6 of 6 OK created sql table model `adw02_star`.`dim_customer` .................. [[32mOK[0m in 0.05s]
[0m12:09:01.979855 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:09:01.981565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:01.982063 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:09:01.982640 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:09:01.983332 [info ] [MainThread]: 
[0m12:09:01.984007 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m12:09:01.986019 [debug] [MainThread]: Command end result
[0m12:09:02.036982 [info ] [MainThread]: 
[0m12:09:02.037713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:02.038170 [info ] [MainThread]: 
[0m12:09:02.038740 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:09:02.039896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6346862, "process_in_blocks": "0", "process_kernel_time": 0.225826, "process_mem_max_rss": "143012", "process_out_blocks": "4504", "process_user_time": 3.655923}
[0m12:09:02.040521 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:02.040373 after 2.64 seconds
[0m12:09:02.041000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772901d179b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ee5678f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7728ee567890>]}
[0m12:09:02.041609 [debug] [MainThread]: Flushing usage events
[0m12:26:16.194830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b26488a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2627a9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2627a9450>]}


============================== 12:26:16.197535 | a0acd021-e88c-40de-881c-98f6a0c1d0c5 ==============================
[0m12:26:16.197535 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:26:16.198133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:26:16.345775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2637ddcd0>]}
[0m12:26:16.394585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b26261b790>]}
[0m12:26:16.395228 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:26:16.476134 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:26:16.586876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:26:16.587509 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m12:26:16.587989 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/customer/stg_customer.sql
[0m12:26:16.786001 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:26:16.786456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2625f3750>]}
[0m12:26:16.945267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2623536b0>]}
[0m12:26:17.037639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b2605dd0f0>]}
[0m12:26:17.038049 [info ] [MainThread]: Found 6 models, 12 data tests, 10 sources, 608 macros
[0m12:26:17.038411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b26056e270>]}
[0m12:26:17.040401 [info ] [MainThread]: 
[0m12:26:17.040933 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:26:17.046815 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:26:17.058195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:17.299169 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:26:17.301753 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.323375 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:26:17.326441 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.329163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:26:17.334432 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:26:17.345743 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.347303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:26:17.349005 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:26:17.360055 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.361421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b260562390>]}
[0m12:26:17.361913 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:26:17.362232 [info ] [MainThread]: 
[0m12:26:17.364354 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:26:17.364865 [info ] [Thread-1 (]: 1 of 6 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:26:17.365361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m12:26:17.365705 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:26:17.371917 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:26:17.372465 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:26:17.389715 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:26:17.419701 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
          )
        
        ...
[0m12:26:17.435487 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:26:17.450206 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:26:17.453673 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.457692 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:26:17.458443 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
  ...
[0m12:26:17.513565 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m12:26:17.533228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e881de0>]}
[0m12:26:17.534165 [info ] [Thread-1 (]: 1 of 6 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m12:26:17.534782 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:26:17.535159 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:26:17.535845 [info ] [Thread-1 (]: 2 of 6 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m12:26:17.536258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:26:17.536592 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:26:17.538265 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:26:17.538831 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:26:17.540793 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:26:17.542164 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m12:26:17.556558 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.558963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:26:17.562386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.564665 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:26:17.565263 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m12:26:17.593137 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m12:26:17.594770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e64e210>]}
[0m12:26:17.595282 [info ] [Thread-1 (]: 2 of 6 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.06s]
[0m12:26:17.595805 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:26:17.596168 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:26:17.596583 [info ] [Thread-1 (]: 3 of 6 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m12:26:17.596972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m12:26:17.597287 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:26:17.599197 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:26:17.599994 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:26:17.601834 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:26:17.603056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m12:26:17.617152 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.622057 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:26:17.625661 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.627655 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:26:17.628180 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m12:26:17.670538 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m12:26:17.672109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e6f4bd0>]}
[0m12:26:17.672613 [info ] [Thread-1 (]: 3 of 6 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.08s]
[0m12:26:17.673126 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:26:17.673495 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:26:17.674009 [info ] [Thread-1 (]: 4 of 6 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m12:26:17.674421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:26:17.674742 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:26:17.676283 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:26:17.676887 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:26:17.678739 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:26:17.680189 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m12:26:17.692005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.694431 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:26:17.697731 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.699982 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:26:17.700560 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m12:26:17.714738 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.716401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e65cc20>]}
[0m12:26:17.716903 [info ] [Thread-1 (]: 4 of 6 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m12:26:17.717592 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:26:17.717962 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:26:17.718434 [info ] [Thread-1 (]: 5 of 6 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m12:26:17.718827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:26:17.719142 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:26:17.721537 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:26:17.722176 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:26:17.725043 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:26:17.726314 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:26:17.745050 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:26:17.747994 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:26:17.751613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.753713 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:26:17.754329 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m12:26:17.812025 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:26:17.813609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e7537d0>]}
[0m12:26:17.814120 [info ] [Thread-1 (]: 5 of 6 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.09s]
[0m12:26:17.814648 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:26:17.815020 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:26:17.815500 [info ] [Thread-1 (]: 6 of 6 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:26:17.815879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:26:17.816205 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:26:17.818513 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:26:17.819105 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:26:17.821194 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:26:17.822640 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    MD5(CONCAT(customer_first_name, customer_last_name, customer_email)) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:26:17.832519 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.834848 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:26:17.838106 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:26:17.840327 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:26:17.840878 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")SELECT
    MD5(CONCAT(customer_first_name, customer_last_name, customer_email)) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
  ...
[0m12:26:17.846510 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:26:17.848071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0acd021-e88c-40de-881c-98f6a0c1d0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22e660e30>]}
[0m12:26:17.848589 [info ] [Thread-1 (]: 6 of 6 OK created sql table model `adw02_star`.`dim_customer` .................. [[32mOK[0m in 0.03s]
[0m12:26:17.849119 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:26:17.850295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:17.850642 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:26:17.850927 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:26:17.851476 [info ] [MainThread]: 
[0m12:26:17.851958 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m12:26:17.853547 [debug] [MainThread]: Command end result
[0m12:26:17.885930 [info ] [MainThread]: 
[0m12:26:17.886359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:17.886664 [info ] [MainThread]: 
[0m12:26:17.886973 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:26:17.887699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7319728, "process_in_blocks": "0", "process_kernel_time": 0.147513, "process_mem_max_rss": "142964", "process_out_blocks": "4504", "process_user_time": 2.331611}
[0m12:26:17.888090 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:17.887997 after 1.73 seconds
[0m12:26:17.888499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b264464a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22cc939b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b22cc93950>]}
[0m12:26:17.888870 [debug] [MainThread]: Flushing usage events
[0m12:30:05.182641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79cb9e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79aac1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79aac1450>]}


============================== 12:30:05.185481 | 97754b20-508e-4af2-bfb6-7b5b5118dea2 ==============================
[0m12:30:05.185481 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:30:05.186000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:05.331465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79baf5cd0>]}
[0m12:30:05.384398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79a933790>]}
[0m12:30:05.385012 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:30:05.469006 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:30:05.573911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:05.574524 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.yml
[0m12:30:05.767421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:30:05.767881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79a90b750>]}
[0m12:30:05.920828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79a46a300>]}
[0m12:30:06.011866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b798af9010>]}
[0m12:30:06.012254 [info ] [MainThread]: Found 6 models, 12 data tests, 10 sources, 608 macros
[0m12:30:06.012634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b798bffa00>]}
[0m12:30:06.014493 [info ] [MainThread]: 
[0m12:30:06.014986 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:30:06.020839 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:30:06.029577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:06.270944 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:30:06.273507 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.295312 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:30:06.298455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.300518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:30:06.306093 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:30:06.317920 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.319236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:30:06.320826 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:30:06.332532 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.334248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b798c22810>]}
[0m12:30:06.334761 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:30:06.335075 [info ] [MainThread]: 
[0m12:30:06.337268 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:30:06.337774 [info ] [Thread-1 (]: 1 of 6 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:30:06.338208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m12:30:06.338630 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:30:06.344578 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:30:06.345164 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:30:06.361991 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:30:06.391767 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
          )
        
        ...
[0m12:30:06.411012 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:30:06.457700 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:30:06.462228 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.467449 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:30:06.468121 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
  ...
[0m12:30:06.523171 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m12:30:06.543564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79a291ff0>]}
[0m12:30:06.544172 [info ] [Thread-1 (]: 1 of 6 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.20s]
[0m12:30:06.544853 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:30:06.545419 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:30:06.545859 [info ] [Thread-1 (]: 2 of 6 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m12:30:06.546329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:30:06.546840 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:30:06.548749 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:30:06.549479 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:30:06.551564 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:30:06.553261 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m12:30:06.567803 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.570371 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:30:06.573612 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.575821 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:30:06.576374 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m12:30:06.605056 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m12:30:06.606777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b792909590>]}
[0m12:30:06.607283 [info ] [Thread-1 (]: 2 of 6 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.06s]
[0m12:30:06.607947 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:30:06.608482 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:30:06.609024 [info ] [Thread-1 (]: 3 of 6 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m12:30:06.609527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m12:30:06.609964 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:30:06.612039 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:30:06.612621 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:30:06.614482 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:30:06.615459 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m12:30:06.629106 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.631849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:30:06.635567 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.637527 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:30:06.638043 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m12:30:06.679593 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m12:30:06.681341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b7929bc8d0>]}
[0m12:30:06.682044 [info ] [Thread-1 (]: 3 of 6 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.07s]
[0m12:30:06.682710 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:30:06.683269 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:30:06.683771 [info ] [Thread-1 (]: 4 of 6 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m12:30:06.684170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:30:06.684602 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:30:06.686228 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:30:06.686794 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:30:06.688689 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:30:06.690106 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m12:30:06.701628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.704074 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:30:06.707535 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.709442 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:30:06.709979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m12:30:06.723878 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.725451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79a301c50>]}
[0m12:30:06.725957 [info ] [Thread-1 (]: 4 of 6 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m12:30:06.726468 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:30:06.726831 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:30:06.727360 [info ] [Thread-1 (]: 5 of 6 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m12:30:06.727749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:30:06.728067 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:30:06.729586 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:30:06.730228 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:30:06.736026 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:30:06.737059 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:30:06.754428 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:30:06.756968 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:30:06.760251 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.762190 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:30:06.762745 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m12:30:06.819069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:30:06.820641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b792a2b2f0>]}
[0m12:30:06.821146 [info ] [Thread-1 (]: 5 of 6 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.09s]
[0m12:30:06.821777 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:30:06.822362 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:30:06.822783 [info ] [Thread-1 (]: 6 of 6 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:30:06.823293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:30:06.823787 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:30:06.826194 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:30:06.826757 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:30:06.828625 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:30:06.830090 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    MD5(CONCAT(customer_first_name, customer_last_name, customer_email)) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:30:06.840478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.842859 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:30:06.846427 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:30:06.848684 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:30:06.849220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")SELECT
    MD5(CONCAT(customer_first_name, customer_last_name, customer_email)) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
  ...
[0m12:30:06.854878 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:30:06.856560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97754b20-508e-4af2-bfb6-7b5b5118dea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b790f4cf50>]}
[0m12:30:06.857074 [info ] [Thread-1 (]: 6 of 6 OK created sql table model `adw02_star`.`dim_customer` .................. [[32mOK[0m in 0.03s]
[0m12:30:06.857742 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:30:06.859060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:06.859351 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:30:06.859637 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:30:06.860029 [info ] [MainThread]: 
[0m12:30:06.860340 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m12:30:06.861631 [debug] [MainThread]: Command end result
[0m12:30:06.895288 [info ] [MainThread]: 
[0m12:30:06.895674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:06.895959 [info ] [MainThread]: 
[0m12:30:06.896259 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:30:06.896928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7547084, "process_in_blocks": "0", "process_kernel_time": 0.151679, "process_mem_max_rss": "143248", "process_out_blocks": "4504", "process_user_time": 2.374687}
[0m12:30:06.897290 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:06.897202 after 1.76 seconds
[0m12:30:06.897610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b79cdfe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b790f4fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b790f4fb30>]}
[0m12:30:06.897925 [debug] [MainThread]: Flushing usage events
[0m12:40:53.813659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615ceb72120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cca81590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cca81450>]}


============================== 12:40:53.816241 | 71ee2ca7-ae66-4b06-840a-096a7bbf5928 ==============================
[0m12:40:53.816241 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:40:53.816716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:40:53.955284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cd9e5cd0>]}
[0m12:40:54.005969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc8fb790>]}
[0m12:40:54.006670 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:40:54.087865 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:40:54.190369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:54.190929 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m12:40:54.409674 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:40:54.410316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc4ea550>]}
[0m12:40:54.554292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc25ed50>]}
[0m12:40:54.639119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc105550>]}
[0m12:40:54.639551 [info ] [MainThread]: Found 6 models, 12 data tests, 10 sources, 608 macros
[0m12:40:54.639845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc066820>]}
[0m12:40:54.641751 [info ] [MainThread]: 
[0m12:40:54.642219 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:40:54.648148 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:40:54.660136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:54.897947 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:40:54.900325 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:54.921589 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:40:54.924279 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:54.926380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:40:54.932017 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:40:54.945075 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:54.946350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:40:54.947830 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:40:54.958688 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:54.960060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615cc086450>]}
[0m12:40:54.960638 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:40:54.961124 [info ] [MainThread]: 
[0m12:40:54.963389 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:40:54.964209 [info ] [Thread-1 (]: 1 of 6 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:40:54.964767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_customer)
[0m12:40:54.965107 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:40:54.972962 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:40:54.973567 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:40:54.992108 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:40:55.024603 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
          )
        
        ...
[0m12:40:55.040017 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.054586 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:40:55.058138 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.062101 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:40:55.062688 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update", "c.address_id", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.customer
),
joined AS (
    SELECT
        c.customer_id as customer_id,
        c.first_name as customer_first_name,
        c.last_name as customer_last_name,
        c.email as customer_email,
        c.active as customer_active,
        c.create_date as customer_created,
        a.address as customer_address,
        a.district as customer_district,
        a.postal_code as customer_postal_code,
        a.phone as customer_phone_number,
        ci.city as customer_city,
        co.country as customer_country,
        c.last_update as customer_last_update,
        c.address_id,
        c.store_id
    FROM source c
    JOIN sakila_proxy.address a ON c.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
)
SELECT * FROM joined
ORDER BY customer_id
  ...
[0m12:40:55.115787 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m12:40:55.133382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615ca3cbcd0>]}
[0m12:40:55.133930 [info ] [Thread-1 (]: 1 of 6 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.17s]
[0m12:40:55.134483 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:40:55.134861 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:40:55.135269 [info ] [Thread-1 (]: 2 of 6 START sql table model `adw02_stag`.`stg_film` ........................... [RUN]
[0m12:40:55.135663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:40:55.135977 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:40:55.137459 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:40:55.138269 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:40:55.140252 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:40:55.141721 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
          )
        
        ...
[0m12:40:55.156523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.158873 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:40:55.162645 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.164760 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:40:55.165301 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.film
)
SELECT
    f.film_id as film_key,
    f.title as film_title,
    f.description as film_description,
    f.release_year as film_release_year,
    l.name as film_language,
    CASE WHEN f.original_language_id IS NOT NULL THEN 1 ELSE 0 END as film_has_original_language,
    f.rental_duration as film_rental_duration,
    f.rental_rate as film_rental_rate,
    f.length as film_duration,
    f.replacement_cost as film_replacement_cost,
    f.rating as film_rating,
    f.special_features as film_special_features,
    f.last_update as film_last_update
FROM source f
JOIN sakila_proxy.language l ON f.language_id = l.language_id
  ...
[0m12:40:55.193667 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m12:40:55.195268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615c87377f0>]}
[0m12:40:55.195782 [info ] [Thread-1 (]: 2 of 6 OK created sql table model `adw02_stag`.`stg_film` ...................... [[32mOK[0m in 0.06s]
[0m12:40:55.196290 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:40:55.196661 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:40:55.197057 [info ] [Thread-1 (]: 3 of 6 START sql table model `adw02_stag`.`stg_rental` ......................... [RUN]
[0m12:40:55.197515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_rental)
[0m12:40:55.197890 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:40:55.199940 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:40:55.200613 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:40:55.202562 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:40:55.203604 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
          )
        
        ...
[0m12:40:55.217939 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.222745 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:40:55.226210 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.228151 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:40:55.228693 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_key", "customer_key", "film_key", "staff_key", "store_key", "rental_date", "return_date", "i.inventory_id", "rental_duration", "last_update")WITH source AS (
    SELECT * FROM sakila_proxy.rental
),
inventory AS (
    SELECT * FROM sakila_proxy.inventory
)
SELECT
    r.rental_id as rental_key,
    r.customer_id as customer_key,
    i.film_id as film_key,
    r.staff_id as staff_key,
    i.store_id as store_key,
    r.rental_date,
    r.return_date,
    i.inventory_id,
    DATEDIFF('second', r.rental_date, r.return_date) as rental_duration,
    r.last_update
FROM source r
JOIN inventory i ON r.inventory_id = i.inventory_id
  ...
[0m12:40:55.269682 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m12:40:55.271546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615ca204bd0>]}
[0m12:40:55.272108 [info ] [Thread-1 (]: 3 of 6 OK created sql table model `adw02_stag`.`stg_rental` .................... [[32mOK[0m in 0.07s]
[0m12:40:55.272655 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:40:55.273042 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:40:55.273487 [info ] [Thread-1 (]: 4 of 6 START sql table model `adw02_stag`.`stg_staff` .......................... [RUN]
[0m12:40:55.273905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:40:55.274288 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:40:55.275979 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:40:55.276567 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:40:55.278412 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:40:55.280052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
          )
        
        ...
[0m12:40:55.291782 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.294212 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:40:55.297654 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.299581 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:40:55.300103 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_password", "staff_last_update", "store_id")WITH source AS (
    SELECT * FROM sakila_proxy.staff
)
SELECT
    staff_id as staff_key,
    first_name as staff_first_name,
    last_name as staff_last_name,
    email as staff_email,
    active as staff_active,
    username as staff_username,
    password as staff_password,
    last_update as staff_last_update,
    store_id as store_id
FROM source
  ...
[0m12:40:55.314072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.315638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615c8772c80>]}
[0m12:40:55.316139 [info ] [Thread-1 (]: 4 of 6 OK created sql table model `adw02_stag`.`stg_staff` ..................... [[32mOK[0m in 0.04s]
[0m12:40:55.316685 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:40:55.317047 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:40:55.317458 [info ] [Thread-1 (]: 5 of 6 START sql table model `adw02_stag`.`stg_store` .......................... [RUN]
[0m12:40:55.317830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:40:55.318139 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:40:55.319624 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:40:55.320226 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:40:55.322618 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:40:55.323665 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
          )
        
        ...
[0m12:40:55.341861 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:40:55.344212 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:40:55.347773 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.349683 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:40:55.350221 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_key", "store_address", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH source AS (
    SELECT * FROM sakila_proxy.store
),
joined AS (
    SELECT
        s.store_id as store_key,
        a.address as store_address,
        a.postal_code as store_postal_code,
        a.phone as store_phone_number,
        ci.city as store_city,
        co.country as store_country,
        s.manager_staff_id as store_manager_staff_id,
        stf.first_name as store_manager_first_name,
        stf.last_name as store_manager_last_name,
        s.last_update as store_last_update
    FROM source s
    JOIN sakila_proxy.address a ON s.address_id = a.address_id
    JOIN sakila_proxy.city ci ON a.city_id = ci.city_id
    JOIN sakila_proxy.country co ON ci.country_id = co.country_id
    JOIN sakila_proxy.staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM joined
  ...
[0m12:40:55.406861 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m12:40:55.408448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615ca22adb0>]}
[0m12:40:55.408972 [info ] [Thread-1 (]: 5 of 6 OK created sql table model `adw02_stag`.`stg_store` ..................... [[32mOK[0m in 0.09s]
[0m12:40:55.409540 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:40:55.409933 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:40:55.410352 [info ] [Thread-1 (]: 6 of 6 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:40:55.410749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:40:55.411091 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:40:55.414397 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:40:55.415064 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:40:55.416849 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:40:55.418554 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    lower(hex(MD5(toString(coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:40:55.429427 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.431770 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:40:55.434918 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:40:55.437116 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:40:55.437676 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")SELECT
    lower(hex(MD5(toString(coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
  ...
[0m12:40:55.445551 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:40:55.447149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71ee2ca7-ae66-4b06-840a-096a7bbf5928', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615c8761790>]}
[0m12:40:55.447661 [info ] [Thread-1 (]: 6 of 6 OK created sql table model `adw02_star`.`dim_customer` .................. [[32mOK[0m in 0.04s]
[0m12:40:55.448160 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:40:55.449383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:55.449682 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:40:55.449955 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:40:55.450334 [info ] [MainThread]: 
[0m12:40:55.450773 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m12:40:55.452105 [debug] [MainThread]: Command end result
[0m12:40:55.482657 [info ] [MainThread]: 
[0m12:40:55.483038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:55.483329 [info ] [MainThread]: 
[0m12:40:55.483640 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:40:55.484333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7093883, "process_in_blocks": "0", "process_kernel_time": 0.146106, "process_mem_max_rss": "143380", "process_out_blocks": "4512", "process_user_time": 2.303964}
[0m12:40:55.484736 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:55.484644 after 1.71 seconds
[0m12:40:55.485053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615ce866ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615c879fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7615c879fb90>]}
[0m12:40:55.485382 [debug] [MainThread]: Flushing usage events
[0m12:53:20.743501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec30996120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e8b9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e8b9450>]}


============================== 12:53:20.746602 | 0997df2d-36f8-4873-8ad1-f8bf741fd96f ==============================
[0m12:53:20.746602 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:20.747053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:20.894788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2f8edcd0>]}
[0m12:53:20.945846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e72b790>]}
[0m12:53:20.946429 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:53:21.032128 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:53:21.149832 [debug] [MainThread]: Partial parsing enabled: 10 files deleted, 10 files added, 0 files changed.
[0m12:53:21.150302 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_country.sql
[0m12:53:21.150656 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_film.sql
[0m12:53:21.150974 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_city.sql
[0m12:53:21.151262 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_staff.sql
[0m12:53:21.151593 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_rental.sql
[0m12:53:21.151878 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_address.sql
[0m12:53:21.152160 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_language.sql
[0m12:53:21.152488 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_inventory.sql
[0m12:53:21.152770 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_store.sql
[0m12:53:21.153125 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_customer.sql
[0m12:53:21.153654 [debug] [MainThread]: Partial parsing: deleted file: sakstar://models/staging/staff/stg_staff.sql
[0m12:53:21.153999 [debug] [MainThread]: Partial parsing: deleted file: sakstar://models/staging/customer/stg_customer.sql
[0m12:53:21.154257 [debug] [MainThread]: Partial parsing: deleted file: sakstar://models/staging/store/stg_store.sql
[0m12:53:21.154517 [debug] [MainThread]: Partial parsing: deleted file: sakstar://models/staging/rental/stg_rental.sql
[0m12:53:21.154766 [debug] [MainThread]: Partial parsing: deleted file: sakstar://models/staging/film/stg_film.sql
[0m12:53:21.378387 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:53:21.378855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e350050>]}
[0m12:53:21.522177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e263110>]}
[0m12:53:21.605659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2c6c0910>]}
[0m12:53:21.606061 [info ] [MainThread]: Found 11 models, 2 data tests, 10 sources, 608 macros
[0m12:53:21.606424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2c663ba0>]}
[0m12:53:21.608042 [info ] [MainThread]: 
[0m12:53:21.608556 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:53:21.614604 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:53:21.626616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:21.870606 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:53:21.873411 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:53:21.896632 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:53:21.899561 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:53:21.902044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:53:21.907304 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:53:21.919134 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:21.920459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:53:21.922004 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:53:21.932726 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:21.934587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2c7ddf10>]}
[0m12:53:21.935099 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:53:21.935424 [info ] [MainThread]: 
[0m12:53:21.937594 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m12:53:21.938123 [info ] [Thread-1 (]: 1 of 4 START sql table model `adw02_stag`.`stg_address` ........................ [RUN]
[0m12:53:21.938621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_address)
[0m12:53:21.938950 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m12:53:21.945669 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m12:53:21.946254 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m12:53:21.965212 [debug] [Thread-1 (]: Creating new relation stg_address
[0m12:53:21.995529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m12:53:22.018814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:53:22.033656 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:53:22.036864 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:53:22.040479 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m12:53:22.040990 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "address2", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m12:53:22.055905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:22.073790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfa9878b0>]}
[0m12:53:22.074330 [info ] [Thread-1 (]: 1 of 4 OK created sql table model `adw02_stag`.`stg_address` ................... [[32mOK[0m in 0.13s]
[0m12:53:22.074993 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m12:53:22.075383 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m12:53:22.075798 [info ] [Thread-1 (]: 2 of 4 START sql table model `adw02_stag`.`stg_city` ........................... [RUN]
[0m12:53:22.076212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m12:53:22.076547 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m12:53:22.078934 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m12:53:22.079569 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m12:53:22.081444 [debug] [Thread-1 (]: Creating new relation stg_city
[0m12:53:22.082911 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
          )
        
        ...
[0m12:53:22.099663 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:53:22.102082 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:53:22.105323 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:53:22.106921 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m12:53:22.107440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
  ...
[0m12:53:22.120959 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:22.122596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfa71bf70>]}
[0m12:53:22.123114 [info ] [Thread-1 (]: 2 of 4 OK created sql table model `adw02_stag`.`stg_city` ...................... [[32mOK[0m in 0.05s]
[0m12:53:22.123648 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m12:53:22.124066 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:53:22.124652 [info ] [Thread-1 (]: 3 of 4 START sql table model `adw02_stag`.`stg_customer` ....................... [RUN]
[0m12:53:22.125037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_customer)
[0m12:53:22.125445 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:53:22.127800 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:53:22.128389 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:53:22.130708 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:53:22.131708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m12:53:22.146425 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:22.148902 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:53:22.152462 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:53:22.157755 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:53:22.158370 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m12:53:22.173415 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:53:22.175036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfa7ffad0>]}
[0m12:53:22.175699 [info ] [Thread-1 (]: 3 of 4 OK created sql table model `adw02_stag`.`stg_customer` .................. [[32mOK[0m in 0.05s]
[0m12:53:22.176411 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:53:22.177172 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:53:22.177605 [info ] [Thread-1 (]: 4 of 4 START sql table model `adw02_star`.`dim_customer` ....................... [RUN]
[0m12:53:22.177980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.dim_customer)
[0m12:53:22.178317 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:53:22.181595 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:53:22.182167 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:53:22.184364 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:53:22.185322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    lower(hex(MD5(toString(coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        ...
[0m12:53:22.189591 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT
    lower(hex(MD5(toString(coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
    customer_id,
    customer_first_name,
    customer_last_name,
    customer_email,
    customer_active,
    customer_created,
    customer_address,
    customer_district,
    customer_postal_code,
    customer_phone_number,
    customer_city,
    customer_country,
    customer_last_update
FROM `adw02_stag`.`stg_customer`
          )
        
        
[0m12:53:22.201594 [debug] [Thread-1 (]: Database Error in model dim_customer (models/marts/dim/dim_customer/dim_customer.sql)
  Code: 47.
  DB::Exception: Unknown expression or function identifier `customer_first_name` in scope SELECT lower(hex(MD5(toString(concat(coalesce(CAST(customer_first_name, 'String'), '_dbt_utils_surrogate_key_null_'), '-', coalesce(CAST(customer_last_name, 'String'), '_dbt_utils_surrogate_key_null_'), '-', coalesce(CAST(customer_email, 'String'), '_dbt_utils_surrogate_key_null_')))))) AS customer_skey, customer_id, customer_first_name, customer_last_name, customer_email, customer_active, customer_created, customer_address, customer_district, customer_postal_code, customer_phone_number, customer_city, customer_country, customer_last_update FROM adw02_stag.stg_customer. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<char const*, String&, String, String, String>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<String>::type>, char const*&&, String&, String&&, String&&, String&&) @ 0x000000001290b021
  3. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dde6a
  4. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  5. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  6. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  7. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  8. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  10. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  11. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  13. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  14. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  15. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  16. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  17. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  18. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  19. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  20. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  21. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  22. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  23. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  24. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  25. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  26. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  27. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  28. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  29. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  30. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  31. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
[0m12:53:22.202262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0997df2d-36f8-4873-8ad1-f8bf741fd96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2c8c0a60>]}
[0m12:53:22.202832 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model `adw02_star`.`dim_customer` .............. [[31mERROR[0m in 0.02s]
[0m12:53:22.203636 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:53:22.205240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:22.205543 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:53:22.205869 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:53:22.206282 [info ] [MainThread]: 
[0m12:53:22.206666 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m12:53:22.207905 [debug] [MainThread]: Command end result
[0m12:53:22.242126 [info ] [MainThread]: 
[0m12:53:22.242614 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:22.242930 [info ] [MainThread]: 
[0m12:53:22.243653 [error] [MainThread]:   Database Error in model dim_customer (models/marts/dim/dim_customer/dim_customer.sql)
  Code: 47.
  DB::Exception: Unknown expression or function identifier `customer_first_name` in scope SELECT lower(hex(MD5(toString(concat(coalesce(CAST(customer_first_name, 'String'), '_dbt_utils_surrogate_key_null_'), '-', coalesce(CAST(customer_last_name, 'String'), '_dbt_utils_surrogate_key_null_'), '-', coalesce(CAST(customer_email, 'String'), '_dbt_utils_surrogate_key_null_')))))) AS customer_skey, customer_id, customer_first_name, customer_last_name, customer_email, customer_active, customer_created, customer_address, customer_district, customer_postal_code, customer_phone_number, customer_city, customer_country, customer_last_update FROM adw02_stag.stg_customer. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<char const*, String&, String, String, String>(int, FormatStringHelperImpl<std::type_identity<char const*>::type, std::type_identity<String&>::type, std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<String>::type>, char const*&&, String&, String&&, String&&, String&&) @ 0x000000001290b021
  3. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dde6a
  4. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  5. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  6. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  7. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  8. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  10. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  11. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  13. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  14. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  15. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  16. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  17. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  18. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  19. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  20. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  21. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  22. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  23. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f1819
  24. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  25. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  26. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  27. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  28. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  29. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  30. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  31. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
[0m12:53:22.244251 [info ] [MainThread]: 
[0m12:53:22.244634 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:53:22.245478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5432609, "process_in_blocks": "0", "process_kernel_time": 0.128473, "process_mem_max_rss": "143516", "process_out_blocks": "4312", "process_user_time": 2.391997}
[0m12:53:22.245942 [debug] [MainThread]: Command `dbt run` failed at 12:53:22.245826 after 1.54 seconds
[0m12:53:22.246305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2f211130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febfa81df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2e407170>]}
[0m12:53:22.246665 [debug] [MainThread]: Flushing usage events
[0m12:56:46.943516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f58a2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f37ad590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f37ad450>]}


============================== 12:56:46.946255 | b1753d89-9e79-4722-a79c-5228dda6e0d1 ==============================
[0m12:56:46.946255 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:46.946704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:47.090532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f47e1cd0>]}
[0m12:56:47.140417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f3637570>]}
[0m12:56:47.141032 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:56:47.217463 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:56:47.318307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m12:56:47.318826 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_country.sql
[0m12:56:47.319202 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_rental.sql
[0m12:56:47.319564 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_film.sql
[0m12:56:47.319903 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_language.sql
[0m12:56:47.320244 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_store.sql
[0m12:56:47.320588 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_inventory.sql
[0m12:56:47.320925 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_staff.sql
[0m12:56:47.321290 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m12:56:47.555746 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:56:47.556161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f3235950>]}
[0m12:56:47.705852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f175b110>]}
[0m12:56:47.795240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f15d0750>]}
[0m12:56:47.795719 [info ] [MainThread]: Found 11 models, 2 data tests, 10 sources, 608 macros
[0m12:56:47.796019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f1557ba0>]}
[0m12:56:47.797998 [info ] [MainThread]: 
[0m12:56:47.798587 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:56:47.805062 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:56:47.816218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:48.064278 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:56:48.066781 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.089256 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:56:48.092117 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.094435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m12:56:48.099945 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:56:48.111854 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.113370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m12:56:48.114824 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:56:48.126325 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.127793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f16de210>]}
[0m12:56:48.128263 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:56:48.128576 [info ] [MainThread]: 
[0m12:56:48.130554 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m12:56:48.131050 [info ] [Thread-1 (]: 1 of 11 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m12:56:48.131525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_address)
[0m12:56:48.131886 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m12:56:48.138735 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m12:56:48.139271 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m12:56:48.155847 [debug] [Thread-1 (]: Creating new relation stg_address
[0m12:56:48.185192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.196480 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.211640 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.215039 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.219056 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m12:56:48.219723 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "address2", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m12:56:48.234261 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.252122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb803cd0>]}
[0m12:56:48.252680 [info ] [Thread-1 (]: 1 of 11 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.12s]
[0m12:56:48.253249 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m12:56:48.253679 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m12:56:48.254272 [info ] [Thread-1 (]: 2 of 11 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m12:56:48.254715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m12:56:48.255037 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m12:56:48.257391 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m12:56:48.257936 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m12:56:48.259790 [debug] [Thread-1 (]: Creating new relation stg_city
[0m12:56:48.261064 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.272260 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.274622 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.277757 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.279340 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m12:56:48.279864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
  ...
[0m12:56:48.293185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.294880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb5a3bb0>]}
[0m12:56:48.295406 [info ] [Thread-1 (]: 2 of 11 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m12:56:48.295916 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m12:56:48.296279 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m12:56:48.296811 [info ] [Thread-1 (]: 3 of 11 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m12:56:48.297231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m12:56:48.297606 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m12:56:48.300457 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m12:56:48.300974 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m12:56:48.302921 [debug] [Thread-1 (]: Creating new relation stg_country
[0m12:56:48.304097 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.314857 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.319742 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.323190 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.324747 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m12:56:48.325405 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
  ...
[0m12:56:48.338401 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.340090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb680750>]}
[0m12:56:48.340622 [info ] [Thread-1 (]: 3 of 11 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m12:56:48.341334 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m12:56:48.341741 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:56:48.342184 [info ] [Thread-1 (]: 4 of 11 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m12:56:48.342608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m12:56:48.343003 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:56:48.345596 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:56:48.346332 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:56:48.348156 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:56:48.349897 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.361898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.364368 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.367453 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.369457 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:56:48.369995 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m12:56:48.384489 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.386323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f30b4bb0>]}
[0m12:56:48.386857 [info ] [Thread-1 (]: 4 of 11 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m12:56:48.387483 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:56:48.387874 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:56:48.388404 [info ] [Thread-1 (]: 5 of 11 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m12:56:48.388813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:56:48.389200 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:56:48.391694 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:56:48.392414 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:56:48.394974 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:56:48.396046 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.407433 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.409963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.413378 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.416057 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:56:48.416570 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m12:56:48.432585 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:56:48.434224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb6efd70>]}
[0m12:56:48.434759 [info ] [Thread-1 (]: 5 of 11 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m12:56:48.435299 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:56:48.435702 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m12:56:48.436144 [info ] [Thread-1 (]: 6 of 11 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m12:56:48.436614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m12:56:48.436967 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m12:56:48.439408 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m12:56:48.440000 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m12:56:48.442228 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m12:56:48.443864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.455207 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.457677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.461008 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.462787 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m12:56:48.463400 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m12:56:48.478212 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.480043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb5d4c50>]}
[0m12:56:48.480600 [info ] [Thread-1 (]: 6 of 11 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m12:56:48.481142 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m12:56:48.481540 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m12:56:48.481981 [info ] [Thread-1 (]: 7 of 11 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m12:56:48.482511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m12:56:48.482898 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m12:56:48.485504 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m12:56:48.486101 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m12:56:48.488462 [debug] [Thread-1 (]: Creating new relation stg_language
[0m12:56:48.489630 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.501240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.503575 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.506781 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.508636 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m12:56:48.509134 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
  ...
[0m12:56:48.522454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.524116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb6ef050>]}
[0m12:56:48.524737 [info ] [Thread-1 (]: 7 of 11 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m12:56:48.525236 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m12:56:48.525656 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:56:48.526264 [info ] [Thread-1 (]: 8 of 11 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m12:56:48.526788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m12:56:48.527104 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:56:48.529683 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:56:48.530269 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:56:48.532797 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:56:48.534325 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.546285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.548661 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.552026 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.554009 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:56:48.554525 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m12:56:48.579730 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:56:48.581395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb5d5f70>]}
[0m12:56:48.581925 [info ] [Thread-1 (]: 8 of 11 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m12:56:48.582504 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:56:48.582951 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:56:48.583716 [info ] [Thread-1 (]: 9 of 11 START sql table model `adw02_stag`.`stg_staff` ......................... [RUN]
[0m12:56:48.584135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:56:48.584494 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:56:48.586996 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:56:48.587624 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:56:48.589926 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:56:48.590964 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.603483 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.606040 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.609789 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.612022 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:56:48.612547 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "picture", "email", "store_id", "active", "username", "password", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
  ...
[0m12:56:48.627899 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.629609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb5d6990>]}
[0m12:56:48.630311 [info ] [Thread-1 (]: 9 of 11 OK created sql table model `adw02_stag`.`stg_staff` .................... [[32mOK[0m in 0.05s]
[0m12:56:48.630881 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:56:48.631334 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:56:48.631793 [info ] [Thread-1 (]: 10 of 11 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m12:56:48.632325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:56:48.632689 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:56:48.635400 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:56:48.635994 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:56:48.638068 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:56:48.639584 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m12:56:48.651711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.654525 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:56:48.657914 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:56:48.659634 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:56:48.660158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m12:56:48.673760 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:56:48.675495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb5d7170>]}
[0m12:56:48.676030 [info ] [Thread-1 (]: 10 of 11 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m12:56:48.676666 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:56:48.677056 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:56:48.677735 [info ] [Thread-1 (]: 11 of 11 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m12:56:48.678148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:56:48.678579 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:56:48.683903 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:56:48.684583 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:56:48.686972 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:56:48.688119 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m12:56:48.691592 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        
[0m12:56:48.705085 [debug] [Thread-1 (]: Database Error in model dim_customer (models/marts/dim/dim_customer/dim_customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 1166 (c) (line 38, col 9): c.customer_id AS customer_id,
          c.first_name AS customer_first_name,
          c.last_name AS customer_last_name,
          c.email AS customer_email,
          c.a... Expected one of: token, Comma, FROM, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb490894ac3
  12. ? @ 0x00007fb490926850
[0m12:56:48.705678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1753d89-9e79-4722-a79c-5228dda6e0d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377c9cd0590>]}
[0m12:56:48.706226 [error] [Thread-1 (]: 11 of 11 ERROR creating sql table model `adw02_star`.`dim_customer` ............ [[31mERROR[0m in 0.03s]
[0m12:56:48.706853 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:56:48.708845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:48.709147 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:56:48.709543 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:56:48.709907 [info ] [MainThread]: 
[0m12:56:48.710312 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m12:56:48.712584 [debug] [MainThread]: Command end result
[0m12:56:48.747275 [info ] [MainThread]: 
[0m12:56:48.747723 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:48.748089 [info ] [MainThread]: 
[0m12:56:48.748715 [error] [MainThread]:   Database Error in model dim_customer (models/marts/dim/dim_customer/dim_customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 1166 (c) (line 38, col 9): c.customer_id AS customer_id,
          c.first_name AS customer_first_name,
          c.last_name AS customer_last_name,
          c.email AS customer_email,
          c.a... Expected one of: token, Comma, FROM, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb490894ac3
  12. ? @ 0x00007fb490926850
[0m12:56:48.749319 [info ] [MainThread]: 
[0m12:56:48.749644 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:56:48.750328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8471297, "process_in_blocks": "1672", "process_kernel_time": 0.151562, "process_mem_max_rss": "143304", "process_out_blocks": "4488", "process_user_time": 2.487609}
[0m12:56:48.750722 [debug] [MainThread]: Command `dbt run` failed at 12:56:48.750627 after 1.85 seconds
[0m12:56:48.751054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377f5570890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb6ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377cb6efd70>]}
[0m12:56:48.751399 [debug] [MainThread]: Flushing usage events
[0m12:57:59.801079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed678e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed4699590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed4699450>]}


============================== 12:57:59.803923 | 32862051-2636-4e94-ac1b-98d5d4ef9929 ==============================
[0m12:57:59.803923 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:57:59.804532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:59.958698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed56cdcd0>]}
[0m12:58:00.009170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed450b790>]}
[0m12:58:00.009889 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m12:58:00.087762 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:58:00.192530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:00.193051 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m12:58:00.402304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:58:00.402738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed40f5f50>]}
[0m12:58:00.556187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed3e7a7b0>]}
[0m12:58:00.646072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed3e549f0>]}
[0m12:58:00.646597 [info ] [MainThread]: Found 11 models, 2 data tests, 10 sources, 608 macros
[0m12:58:00.646943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed3e53ba0>]}
[0m12:58:00.649148 [info ] [MainThread]: 
[0m12:58:00.649886 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:58:00.656594 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:58:00.668689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:00.919089 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:58:00.928814 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:00.966724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:58:00.969703 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:00.972480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m12:58:00.977722 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m12:58:00.990906 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:00.992151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m12:58:00.993940 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m12:58:01.005325 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.006728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed3e1a810>]}
[0m12:58:01.007175 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m12:58:01.007571 [info ] [MainThread]: 
[0m12:58:01.009762 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m12:58:01.010249 [info ] [Thread-1 (]: 1 of 11 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m12:58:01.010820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.stg_address)
[0m12:58:01.011415 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m12:58:01.018272 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m12:58:01.019188 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m12:58:01.037242 [debug] [Thread-1 (]: Creating new relation stg_address
[0m12:58:01.067623 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.078214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.092885 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.096292 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.099921 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m12:58:01.100472 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "address2", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m12:58:01.115132 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.134513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed2693c20>]}
[0m12:58:01.135083 [info ] [Thread-1 (]: 1 of 11 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.12s]
[0m12:58:01.135622 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m12:58:01.136074 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m12:58:01.136714 [info ] [Thread-1 (]: 2 of 11 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m12:58:01.137222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m12:58:01.137578 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m12:58:01.140072 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m12:58:01.140755 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m12:58:01.142766 [debug] [Thread-1 (]: Creating new relation stg_city
[0m12:58:01.144639 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.159633 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.169279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.180919 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.187616 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m12:58:01.189804 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
  ...
[0m12:58:01.240564 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m12:58:01.246704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d3f6b0>]}
[0m12:58:01.248731 [info ] [Thread-1 (]: 2 of 11 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.11s]
[0m12:58:01.250628 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m12:58:01.251798 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m12:58:01.253082 [info ] [Thread-1 (]: 3 of 11 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m12:58:01.254439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m12:58:01.255420 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m12:58:01.260940 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m12:58:01.262198 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m12:58:01.267144 [debug] [Thread-1 (]: Creating new relation stg_country
[0m12:58:01.268904 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.281425 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.286846 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.290703 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.292553 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m12:58:01.293135 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
  ...
[0m12:58:01.308466 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.310255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1e16ed0>]}
[0m12:58:01.310841 [info ] [Thread-1 (]: 3 of 11 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.06s]
[0m12:58:01.311434 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m12:58:01.311852 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m12:58:01.312675 [info ] [Thread-1 (]: 4 of 11 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m12:58:01.313153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m12:58:01.313533 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m12:58:01.316132 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m12:58:01.316753 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m12:58:01.318779 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m12:58:01.320236 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.331508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.333823 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.337090 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.338973 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m12:58:01.339521 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m12:58:01.354500 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.356852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d12eb0>]}
[0m12:58:01.357360 [info ] [Thread-1 (]: 4 of 11 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m12:58:01.357868 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m12:58:01.358224 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m12:58:01.358641 [info ] [Thread-1 (]: 5 of 11 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m12:58:01.359146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m12:58:01.359496 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m12:58:01.361893 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m12:58:01.362428 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m12:58:01.364826 [debug] [Thread-1 (]: Creating new relation stg_film
[0m12:58:01.365809 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.378432 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.380758 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.384146 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.386691 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m12:58:01.387210 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m12:58:01.403517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:58:01.405094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1deb1d0>]}
[0m12:58:01.405604 [info ] [Thread-1 (]: 5 of 11 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m12:58:01.406102 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m12:58:01.406498 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m12:58:01.406911 [info ] [Thread-1 (]: 6 of 11 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m12:58:01.407348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m12:58:01.407665 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m12:58:01.409959 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m12:58:01.410529 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m12:58:01.412490 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m12:58:01.413920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.425045 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.427554 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.431435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.433032 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m12:58:01.433601 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m12:58:01.449739 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:58:01.451627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d940b0>]}
[0m12:58:01.452257 [info ] [Thread-1 (]: 6 of 11 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m12:58:01.452813 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m12:58:01.453247 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m12:58:01.453866 [info ] [Thread-1 (]: 7 of 11 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m12:58:01.454546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m12:58:01.454997 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m12:58:01.457353 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m12:58:01.457876 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m12:58:01.460306 [debug] [Thread-1 (]: Creating new relation stg_language
[0m12:58:01.461295 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.472755 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.475136 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.478576 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.480435 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m12:58:01.480936 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
  ...
[0m12:58:01.494621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.496367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1e73590>]}
[0m12:58:01.496933 [info ] [Thread-1 (]: 7 of 11 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m12:58:01.497556 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m12:58:01.498064 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m12:58:01.498602 [info ] [Thread-1 (]: 8 of 11 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m12:58:01.499028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m12:58:01.499515 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m12:58:01.502030 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m12:58:01.502689 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m12:58:01.504791 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m12:58:01.506077 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.517700 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.520080 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.523404 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.525169 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m12:58:01.525704 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m12:58:01.549161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:58:01.550775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d95190>]}
[0m12:58:01.551273 [info ] [Thread-1 (]: 8 of 11 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m12:58:01.551810 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m12:58:01.552176 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m12:58:01.552712 [info ] [Thread-1 (]: 9 of 11 START sql table model `adw02_stag`.`stg_staff` ......................... [RUN]
[0m12:58:01.553090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m12:58:01.553412 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m12:58:01.555926 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m12:58:01.556526 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m12:58:01.558885 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m12:58:01.559890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.571115 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.573625 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.577338 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.579559 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m12:58:01.580156 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "picture", "email", "store_id", "active", "username", "password", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
  ...
[0m12:58:01.595297 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.596965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1e73bf0>]}
[0m12:58:01.597470 [info ] [Thread-1 (]: 9 of 11 OK created sql table model `adw02_stag`.`stg_staff` .................... [[32mOK[0m in 0.04s]
[0m12:58:01.597963 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m12:58:01.598321 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m12:58:01.598730 [info ] [Thread-1 (]: 10 of 11 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m12:58:01.599101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m12:58:01.599419 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m12:58:01.601782 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m12:58:01.602389 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m12:58:01.604250 [debug] [Thread-1 (]: Creating new relation stg_store
[0m12:58:01.605659 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m12:58:01.617995 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.620316 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m12:58:01.623624 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.625193 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m12:58:01.625741 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m12:58:01.640234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.641828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d962d0>]}
[0m12:58:01.642319 [info ] [Thread-1 (]: 10 of 11 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m12:58:01.643049 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m12:58:01.643418 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m12:58:01.643823 [info ] [Thread-1 (]: 11 of 11 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m12:58:01.644193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m12:58:01.644511 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m12:58:01.649048 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m12:58:01.649706 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m12:58:01.651528 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m12:58:01.652475 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m12:58:01.665987 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:58:01.670523 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m12:58:01.673857 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:58:01.676127 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m12:58:01.676706 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m12:58:01.695054 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m12:58:01.697541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32862051-2636-4e94-ac1b-98d5d4ef9929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1e72f30>]}
[0m12:58:01.698043 [info ] [Thread-1 (]: 11 of 11 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m12:58:01.698540 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m12:58:01.699733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:01.700016 [debug] [MainThread]: Connection 'model.sakstar.dim_customer' was left open.
[0m12:58:01.700283 [debug] [MainThread]: On model.sakstar.dim_customer: Close
[0m12:58:01.700675 [info ] [MainThread]: 
[0m12:58:01.701022 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m12:58:01.703157 [debug] [MainThread]: Command end result
[0m12:58:01.732287 [info ] [MainThread]: 
[0m12:58:01.732718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:01.733137 [info ] [MainThread]: 
[0m12:58:01.733588 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:58:01.734610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9737865, "process_in_blocks": "0", "process_kernel_time": 0.140836, "process_mem_max_rss": "142964", "process_out_blocks": "4488", "process_user_time": 2.552405}
[0m12:58:01.735220 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:01.735100 after 1.97 seconds
[0m12:58:01.735625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed564ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d97bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ed1d97ad0>]}
[0m12:58:01.735970 [debug] [MainThread]: Flushing usage events
[0m13:02:22.390235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c4792120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c26b5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c26b5450>]}


============================== 13:02:22.392988 | ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7 ==============================
[0m13:02:22.392988 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:02:22.393536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:02:22.544567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c36e9cd0>]}
[0m13:02:22.602805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c2527790>]}
[0m13:02:22.603489 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:02:22.692985 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:02:22.817120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 2 files changed.
[0m13:02:22.817877 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_store/dim_store.sql
[0m13:02:22.818425 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_staff/dim_staff.sql
[0m13:02:22.818808 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_film/dim_film.sql
[0m13:02:22.819518 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.yml
[0m13:02:22.819856 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.sql
[0m13:02:23.036380 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:02:23.036840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c2111d50>]}
[0m13:02:23.180633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c2251b80>]}
[0m13:02:23.266691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c203b3f0>]}
[0m13:02:23.267083 [info ] [MainThread]: Found 14 models, 4 data tests, 10 sources, 608 macros
[0m13:02:23.267436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c0677ba0>]}
[0m13:02:23.269801 [info ] [MainThread]: 
[0m13:02:23.270340 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:02:23.277040 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:02:23.339639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:23.536217 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:02:23.538853 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.563267 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:02:23.565941 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.568953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m13:02:23.574255 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m13:02:23.586286 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.587566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m13:02:23.589076 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m13:02:23.601663 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.603094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c082e8d0>]}
[0m13:02:23.603637 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m13:02:23.603945 [info ] [MainThread]: 
[0m13:02:23.606062 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m13:02:23.606590 [info ] [Thread-1 (]: 1 of 14 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m13:02:23.607031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_address)
[0m13:02:23.607412 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m13:02:23.614976 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m13:02:23.615538 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m13:02:23.634741 [debug] [Thread-1 (]: Creating new relation stg_address
[0m13:02:23.667689 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.677875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.693381 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.696662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.700235 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m13:02:23.700808 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "address2", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m13:02:23.715168 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.734912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8baedbd80>]}
[0m13:02:23.735526 [info ] [Thread-1 (]: 1 of 14 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.13s]
[0m13:02:23.736055 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m13:02:23.736479 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m13:02:23.737020 [info ] [Thread-1 (]: 2 of 14 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m13:02:23.737488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m13:02:23.737812 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m13:02:23.740350 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m13:02:23.740899 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m13:02:23.743133 [debug] [Thread-1 (]: Creating new relation stg_city
[0m13:02:23.744709 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.756030 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.758689 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.762406 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.764340 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m13:02:23.764876 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
  ...
[0m13:02:23.778847 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.780654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c3004f50>]}
[0m13:02:23.781159 [info ] [Thread-1 (]: 2 of 14 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m13:02:23.781676 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m13:02:23.782032 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m13:02:23.782435 [info ] [Thread-1 (]: 3 of 14 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m13:02:23.782811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m13:02:23.783132 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m13:02:23.785704 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m13:02:23.786332 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m13:02:23.791762 [debug] [Thread-1 (]: Creating new relation stg_country
[0m13:02:23.793007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.804151 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.806996 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.810514 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.812042 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m13:02:23.812566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
  ...
[0m13:02:23.827297 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.829068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba612cd0>]}
[0m13:02:23.829580 [info ] [Thread-1 (]: 3 of 14 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.05s]
[0m13:02:23.830084 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m13:02:23.830504 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m13:02:23.830921 [info ] [Thread-1 (]: 4 of 14 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m13:02:23.831388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m13:02:23.831733 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m13:02:23.834258 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m13:02:23.834901 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m13:02:23.836863 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m13:02:23.838301 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.850353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.852774 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.856240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.858164 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m13:02:23.858705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m13:02:23.874149 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:23.875756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba57b770>]}
[0m13:02:23.876255 [info ] [Thread-1 (]: 4 of 14 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m13:02:23.876765 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m13:02:23.877128 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m13:02:23.877711 [info ] [Thread-1 (]: 5 of 14 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m13:02:23.878129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m13:02:23.878467 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m13:02:23.880909 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m13:02:23.881481 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m13:02:23.884056 [debug] [Thread-1 (]: Creating new relation stg_film
[0m13:02:23.885192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.897642 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.899997 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.903602 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.906599 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m13:02:23.907201 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m13:02:23.925234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:23.926983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba642d50>]}
[0m13:02:23.927582 [info ] [Thread-1 (]: 5 of 14 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m13:02:23.928337 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m13:02:23.928762 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m13:02:23.929373 [info ] [Thread-1 (]: 6 of 14 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m13:02:23.929899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m13:02:23.930222 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m13:02:23.932819 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m13:02:23.933429 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m13:02:23.935394 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m13:02:23.936974 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.948523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.951359 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:23.954729 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:23.956408 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m13:02:23.956923 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m13:02:23.972384 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:23.974086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba590a10>]}
[0m13:02:23.974625 [info ] [Thread-1 (]: 6 of 14 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m13:02:23.975158 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m13:02:23.975535 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m13:02:23.976146 [info ] [Thread-1 (]: 7 of 14 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m13:02:23.976758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m13:02:23.977083 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m13:02:23.979573 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m13:02:23.980252 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m13:02:23.982882 [debug] [Thread-1 (]: Creating new relation stg_language
[0m13:02:23.983912 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
          )
        
        ...
[0m13:02:23.994874 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:23.997204 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:24.000646 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.002751 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m13:02:24.003297 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
  ...
[0m13:02:24.017410 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.019058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba641fd0>]}
[0m13:02:24.019855 [info ] [Thread-1 (]: 7 of 14 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m13:02:24.020570 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m13:02:24.020998 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m13:02:24.021616 [info ] [Thread-1 (]: 8 of 14 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m13:02:24.022265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m13:02:24.022716 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m13:02:24.025541 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m13:02:24.026447 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m13:02:24.029137 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m13:02:24.030815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m13:02:24.041626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.044157 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:24.047809 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.049649 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m13:02:24.050174 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m13:02:24.073990 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.075941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba591d30>]}
[0m13:02:24.076453 [info ] [Thread-1 (]: 8 of 14 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m13:02:24.076981 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m13:02:24.077383 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m13:02:24.077986 [info ] [Thread-1 (]: 9 of 14 START sql table model `adw02_stag`.`stg_staff` ......................... [RUN]
[0m13:02:24.078562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m13:02:24.078914 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m13:02:24.081521 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m13:02:24.082256 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m13:02:24.085088 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m13:02:24.086254 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
          )
        
        ...
[0m13:02:24.098052 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.100445 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:24.104297 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.106371 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m13:02:24.106888 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "picture", "email", "store_id", "active", "username", "password", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
  ...
[0m13:02:24.124046 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.125669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba5926f0>]}
[0m13:02:24.126185 [info ] [Thread-1 (]: 9 of 14 OK created sql table model `adw02_stag`.`stg_staff` .................... [[32mOK[0m in 0.05s]
[0m13:02:24.126693 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m13:02:24.127144 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m13:02:24.127618 [info ] [Thread-1 (]: 10 of 14 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m13:02:24.128148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m13:02:24.128481 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m13:02:24.130917 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m13:02:24.131552 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m13:02:24.133610 [debug] [Thread-1 (]: Creating new relation stg_store
[0m13:02:24.135078 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m13:02:24.146685 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.149119 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:02:24.152774 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.154364 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m13:02:24.154877 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m13:02:24.168591 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.170206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba592ed0>]}
[0m13:02:24.170709 [info ] [Thread-1 (]: 10 of 14 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m13:02:24.171361 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m13:02:24.171873 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m13:02:24.172286 [info ] [Thread-1 (]: 11 of 14 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m13:02:24.172688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m13:02:24.173103 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m13:02:24.180551 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m13:02:24.181123 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m13:02:24.182951 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m13:02:24.183919 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m13:02:24.197700 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.200319 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:02:24.203915 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.206180 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m13:02:24.206763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m13:02:24.229898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.231472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba642f30>]}
[0m13:02:24.232010 [info ] [Thread-1 (]: 11 of 14 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m13:02:24.232556 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m13:02:24.232957 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m13:02:24.233367 [info ] [Thread-1 (]: 12 of 14 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m13:02:24.233750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m13:02:24.234076 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m13:02:24.236937 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m13:02:24.237603 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m13:02:24.240044 [debug] [Thread-1 (]: Creating new relation dim_film
[0m13:02:24.241133 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        f.film_id AS film_key,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m13:02:24.252508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.254885 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:02:24.258096 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.260589 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m13:02:24.261189 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_key", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        f.film_id AS film_key,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m13:02:24.277683 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.279325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba5924b0>]}
[0m13:02:24.279836 [info ] [Thread-1 (]: 12 of 14 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m13:02:24.280357 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m13:02:24.280941 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m13:02:24.281516 [info ] [Thread-1 (]: 13 of 14 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m13:02:24.282148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m13:02:24.282556 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m13:02:24.286028 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m13:02:24.286583 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m13:02:24.288407 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m13:02:24.289374 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        s.staff_id AS staff_key,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m13:02:24.301601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.304197 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:02:24.307543 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.309795 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m13:02:24.310407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_key", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        s.staff_id AS staff_key,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m13:02:24.327014 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.328627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba6425d0>]}
[0m13:02:24.329121 [info ] [Thread-1 (]: 13 of 14 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m13:02:24.329649 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m13:02:24.330039 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m13:02:24.330442 [info ] [Thread-1 (]: 14 of 14 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m13:02:24.330836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m13:02:24.331153 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m13:02:24.334489 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m13:02:24.335182 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m13:02:24.337069 [debug] [Thread-1 (]: Creating new relation dim_store
[0m13:02:24.338453 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        s.store_id AS store_key,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m13:02:24.350501 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:02:24.352786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:02:24.355882 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:02:24.357978 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m13:02:24.358584 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_key", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        s.store_id AS store_key,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m13:02:24.376285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:02:24.377908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7df6b7-160d-4351-bb5b-15cd7f1dbdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba592e10>]}
[0m13:02:24.378489 [info ] [Thread-1 (]: 14 of 14 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m13:02:24.379025 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m13:02:24.380230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:24.380516 [debug] [MainThread]: Connection 'model.sakstar.dim_store' was left open.
[0m13:02:24.380790 [debug] [MainThread]: On model.sakstar.dim_store: Close
[0m13:02:24.381247 [info ] [MainThread]: 
[0m13:02:24.381888 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m13:02:24.384111 [debug] [MainThread]: Command end result
[0m13:02:24.414790 [info ] [MainThread]: 
[0m13:02:24.415202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:24.415625 [info ] [MainThread]: 
[0m13:02:24.416077 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:02:24.416956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0702205, "process_in_blocks": "0", "process_kernel_time": 0.163646, "process_mem_max_rss": "143416", "process_out_blocks": "4696", "process_user_time": 2.557907}
[0m13:02:24.417525 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:24.417391 after 2.07 seconds
[0m13:02:24.418142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8c2f66ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba593b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf8ba593290>]}
[0m13:02:24.418614 [debug] [MainThread]: Flushing usage events
[0m13:08:03.337865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a548899e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54868c1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54868c1450>]}


============================== 13:08:03.345813 | 97bb5a84-fe63-4219-a638-79b850c4f191 ==============================
[0m13:08:03.345813 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:08:03.346286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:03.487530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54878f5cd0>]}
[0m13:08:03.536040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5486733790>]}
[0m13:08:03.536635 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:08:03.621644 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:08:03.738442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 3 files changed.
[0m13:08:03.738961 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_film/dim_film.yml
[0m13:08:03.739312 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_store/dim_store.yml
[0m13:08:03.739699 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_staff/dim_staff.yml
[0m13:08:03.740048 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_store/dim_store.sql
[0m13:08:03.740399 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_film/dim_film.sql
[0m13:08:03.740737 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_staff/dim_staff.sql
[0m13:08:03.962696 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:08:03.963114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5486341f50>]}
[0m13:08:04.129024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54860c32f0>]}
[0m13:08:04.267099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54861f0670>]}
[0m13:08:04.267546 [info ] [MainThread]: Found 14 models, 16 data tests, 10 sources, 608 macros
[0m13:08:04.267847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a54861c5090>]}
[0m13:08:04.270006 [info ] [MainThread]: 
[0m13:08:04.270546 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:08:04.277025 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:08:04.286644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:04.481130 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:08:04.483753 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.505599 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:08:04.508588 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.511555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m13:08:04.518785 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m13:08:04.531266 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.532885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m13:08:04.534959 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m13:08:04.546532 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.547894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a548601ec90>]}
[0m13:08:04.548560 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m13:08:04.548862 [info ] [MainThread]: 
[0m13:08:04.551017 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m13:08:04.551567 [info ] [Thread-1 (]: 1 of 14 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m13:08:04.552028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.stg_address)
[0m13:08:04.552417 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m13:08:04.559752 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m13:08:04.560317 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m13:08:04.577804 [debug] [Thread-1 (]: Creating new relation stg_address
[0m13:08:04.607669 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.620074 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.657790 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.662891 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.668266 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m13:08:04.668937 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "address2", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    address2,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m13:08:04.684626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:04.702610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547feec050>]}
[0m13:08:04.703210 [info ] [Thread-1 (]: 1 of 14 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.15s]
[0m13:08:04.703757 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m13:08:04.704139 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m13:08:04.704722 [info ] [Thread-1 (]: 2 of 14 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m13:08:04.705136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m13:08:04.705569 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m13:08:04.707981 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m13:08:04.708567 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m13:08:04.710486 [debug] [Thread-1 (]: Creating new relation stg_city
[0m13:08:04.712148 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.724486 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.726826 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.730132 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.731707 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m13:08:04.732220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id,
    last_update
FROM source
  ...
[0m13:08:04.746680 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.748300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fee7750>]}
[0m13:08:04.748817 [info ] [Thread-1 (]: 2 of 14 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m13:08:04.749362 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m13:08:04.749846 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m13:08:04.750491 [info ] [Thread-1 (]: 3 of 14 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m13:08:04.751023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m13:08:04.751434 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m13:08:04.754033 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m13:08:04.754625 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m13:08:04.757110 [debug] [Thread-1 (]: Creating new relation stg_country
[0m13:08:04.758111 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.770146 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.772978 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.776354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.778785 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m13:08:04.779375 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country,
    last_update
FROM source
  ...
[0m13:08:04.792523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.794177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547ffac250>]}
[0m13:08:04.794748 [info ] [Thread-1 (]: 3 of 14 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m13:08:04.795288 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m13:08:04.795686 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m13:08:04.796369 [info ] [Thread-1 (]: 4 of 14 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m13:08:04.796750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m13:08:04.797066 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m13:08:04.800509 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m13:08:04.801071 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m13:08:04.803666 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m13:08:04.805244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.817745 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.820507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.824054 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.826468 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m13:08:04.827018 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m13:08:04.841691 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.843256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a548608fbd0>]}
[0m13:08:04.843841 [info ] [Thread-1 (]: 4 of 14 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m13:08:04.844350 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m13:08:04.844711 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m13:08:04.845188 [info ] [Thread-1 (]: 5 of 14 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m13:08:04.845575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m13:08:04.845911 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m13:08:04.848381 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m13:08:04.849055 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m13:08:04.851387 [debug] [Thread-1 (]: Creating new relation stg_film
[0m13:08:04.852349 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.864516 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.866875 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.870722 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.872823 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m13:08:04.873331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m13:08:04.889705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:04.891311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8b2f0>]}
[0m13:08:04.891884 [info ] [Thread-1 (]: 5 of 14 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m13:08:04.892413 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m13:08:04.892842 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m13:08:04.893303 [info ] [Thread-1 (]: 6 of 14 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m13:08:04.893702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m13:08:04.894018 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m13:08:04.896424 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m13:08:04.897019 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m13:08:04.898947 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m13:08:04.900512 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.911889 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.914406 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.917648 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.919477 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m13:08:04.920045 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m13:08:04.934705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.936312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547e57c230>]}
[0m13:08:04.936880 [info ] [Thread-1 (]: 6 of 14 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m13:08:04.937404 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m13:08:04.937770 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m13:08:04.938216 [info ] [Thread-1 (]: 7 of 14 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m13:08:04.938599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m13:08:04.938910 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m13:08:04.941157 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m13:08:04.941789 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m13:08:04.944399 [debug] [Thread-1 (]: Creating new relation stg_language
[0m13:08:04.945413 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
          )
        
        ...
[0m13:08:04.957868 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.960169 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:04.963644 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:04.967849 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m13:08:04.968402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name,
    last_update
FROM source
  ...
[0m13:08:04.981970 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:04.983583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8be90>]}
[0m13:08:04.984093 [info ] [Thread-1 (]: 7 of 14 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m13:08:04.984606 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m13:08:04.984973 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m13:08:04.985519 [info ] [Thread-1 (]: 8 of 14 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m13:08:04.985892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m13:08:04.986201 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m13:08:04.988349 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m13:08:04.988872 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m13:08:04.990725 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m13:08:04.992145 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m13:08:05.003100 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.005843 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:05.009800 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.011913 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m13:08:05.012443 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m13:08:05.035944 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:05.037588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8b230>]}
[0m13:08:05.038084 [info ] [Thread-1 (]: 8 of 14 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m13:08:05.038667 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m13:08:05.039036 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m13:08:05.039507 [info ] [Thread-1 (]: 9 of 14 START sql table model `adw02_stag`.`stg_staff` ......................... [RUN]
[0m13:08:05.039877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m13:08:05.040188 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m13:08:05.043064 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m13:08:05.043872 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m13:08:05.047546 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m13:08:05.048564 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
          )
        
        ...
[0m13:08:05.061559 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.063910 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:05.067154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.070622 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m13:08:05.071142 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "picture", "email", "store_id", "active", "username", "password", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    picture,
    email,
    store_id,
    active,
    username,
    password,
    last_update
FROM source
  ...
[0m13:08:05.085581 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.087208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe88530>]}
[0m13:08:05.087725 [info ] [Thread-1 (]: 9 of 14 OK created sql table model `adw02_stag`.`stg_staff` .................... [[32mOK[0m in 0.05s]
[0m13:08:05.088241 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m13:08:05.088664 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m13:08:05.089297 [info ] [Thread-1 (]: 10 of 14 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m13:08:05.089852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m13:08:05.090175 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m13:08:05.092667 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m13:08:05.093455 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m13:08:05.095718 [debug] [Thread-1 (]: Creating new relation stg_store
[0m13:08:05.097190 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m13:08:05.109005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.111446 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:08:05.114695 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.116316 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m13:08:05.116836 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m13:08:05.130234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.131803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547e57c950>]}
[0m13:08:05.132302 [info ] [Thread-1 (]: 10 of 14 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m13:08:05.132856 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m13:08:05.133217 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m13:08:05.133670 [info ] [Thread-1 (]: 11 of 14 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m13:08:05.134043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m13:08:05.134552 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m13:08:05.139097 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m13:08:05.139863 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m13:08:05.141752 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m13:08:05.142732 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m13:08:05.155643 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.158269 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:08:05.161621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.163826 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m13:08:05.164414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m13:08:05.181825 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:05.183455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a548640ba10>]}
[0m13:08:05.183959 [info ] [Thread-1 (]: 11 of 14 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m13:08:05.184520 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m13:08:05.184901 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m13:08:05.185324 [info ] [Thread-1 (]: 12 of 14 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m13:08:05.185814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m13:08:05.186151 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m13:08:05.189870 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m13:08:05.190447 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m13:08:05.192662 [debug] [Thread-1 (]: Creating new relation dim_film
[0m13:08:05.193717 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m13:08:05.206631 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.208942 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:08:05.212214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.214591 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m13:08:05.215155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m13:08:05.232442 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:05.234109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8af30>]}
[0m13:08:05.234625 [info ] [Thread-1 (]: 12 of 14 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m13:08:05.235158 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m13:08:05.235528 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m13:08:05.235930 [info ] [Thread-1 (]: 13 of 14 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m13:08:05.236382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m13:08:05.236710 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m13:08:05.241709 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m13:08:05.242382 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m13:08:05.244388 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m13:08:05.245697 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m13:08:05.258320 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.260741 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:08:05.264033 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:08:05.267489 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m13:08:05.268045 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m13:08:05.285031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:05.286595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547e57d430>]}
[0m13:08:05.287097 [info ] [Thread-1 (]: 13 of 14 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m13:08:05.287671 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m13:08:05.288040 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m13:08:05.288471 [info ] [Thread-1 (]: 14 of 14 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m13:08:05.288865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m13:08:05.289184 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m13:08:05.293828 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m13:08:05.294520 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m13:08:05.296427 [debug] [Thread-1 (]: Creating new relation dim_store
[0m13:08:05.297416 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m13:08:05.316461 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:08:05.327144 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:08:05.340005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:08:05.348918 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m13:08:05.351367 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m13:08:05.394065 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m13:08:05.396466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb5a84-fe63-4219-a638-79b850c4f191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547e57daf0>]}
[0m13:08:05.397270 [info ] [Thread-1 (]: 14 of 14 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.11s]
[0m13:08:05.398133 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m13:08:05.399844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:05.400291 [debug] [MainThread]: Connection 'model.sakstar.dim_store' was left open.
[0m13:08:05.400751 [debug] [MainThread]: On model.sakstar.dim_store: Close
[0m13:08:05.401462 [info ] [MainThread]: 
[0m13:08:05.402150 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m13:08:05.405955 [debug] [MainThread]: Command end result
[0m13:08:05.448974 [info ] [MainThread]: 
[0m13:08:05.449394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:05.449713 [info ] [MainThread]: 
[0m13:08:05.450060 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:08:05.451530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.153208, "process_in_blocks": "2568", "process_kernel_time": 0.173859, "process_mem_max_rss": "143164", "process_out_blocks": "4896", "process_user_time": 2.553966}
[0m13:08:05.451924 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:05.451824 after 2.15 seconds
[0m13:08:05.452276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5486769f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a547fe8bd70>]}
[0m13:08:05.452665 [debug] [MainThread]: Flushing usage events
[0m13:21:00.006476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d6f8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4e99590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4e99450>]}


============================== 13:21:00.009415 | ee96b03e-424a-42ad-9f92-22b843fb22a7 ==============================
[0m13:21:00.009415 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:21:00.009986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:00.154886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d5ecdcd0>]}
[0m13:21:00.204298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4d0b790>]}
[0m13:21:00.204890 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:21:00.283942 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:21:00.389675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:21:00.390225 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_language.sql
[0m13:21:00.390617 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_city.sql
[0m13:21:00.390964 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_country.sql
[0m13:21:00.391304 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_address.sql
[0m13:21:00.391656 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/stg_staff.sql
[0m13:21:00.619231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4931b50>]}
[0m13:21:00.711422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4cedf40>]}
[0m13:21:00.711810 [info ] [MainThread]: Found 14 models, 16 data tests, 10 sources, 608 macros
[0m13:21:00.712108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4682190>]}
[0m13:21:00.714226 [info ] [MainThread]: 
[0m13:21:00.714759 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:21:00.721284 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:21:00.730660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:00.924371 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:21:00.926786 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:00.991728 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:21:00.994414 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:00.997184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m13:21:01.003434 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m13:21:01.017839 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.019094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m13:21:01.020556 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m13:21:01.031874 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.033282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c90c6a90>]}
[0m13:21:01.033765 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m13:21:01.034058 [info ] [MainThread]: 
[0m13:21:01.035962 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m13:21:01.036541 [info ] [Thread-1 (]: 1 of 14 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m13:21:01.036989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.stg_address)
[0m13:21:01.037387 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m13:21:01.044551 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m13:21:01.045099 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m13:21:01.063319 [debug] [Thread-1 (]: Creating new relation stg_address
[0m13:21:01.093744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.104967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.120761 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.124582 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.128351 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m13:21:01.128911 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m13:21:01.143937 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.162482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8c7c290>]}
[0m13:21:01.163060 [info ] [Thread-1 (]: 1 of 14 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.12s]
[0m13:21:01.163627 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m13:21:01.164035 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m13:21:01.164624 [info ] [Thread-1 (]: 2 of 14 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m13:21:01.165051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m13:21:01.165463 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m13:21:01.168147 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m13:21:01.168834 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m13:21:01.171324 [debug] [Thread-1 (]: Creating new relation stg_city
[0m13:21:01.173135 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m13:21:01.184272 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.186707 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.189853 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.191570 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m13:21:01.192112 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m13:21:01.205509 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.207159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c90fa570>]}
[0m13:21:01.207703 [info ] [Thread-1 (]: 2 of 14 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m13:21:01.208255 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m13:21:01.208784 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m13:21:01.209228 [info ] [Thread-1 (]: 3 of 14 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m13:21:01.209740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m13:21:01.210098 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m13:21:01.213118 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m13:21:01.213739 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m13:21:01.215529 [debug] [Thread-1 (]: Creating new relation stg_country
[0m13:21:01.216488 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m13:21:01.228710 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.231516 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.235136 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.236695 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m13:21:01.237299 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m13:21:01.250499 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.252327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4b75810>]}
[0m13:21:01.252949 [info ] [Thread-1 (]: 3 of 14 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m13:21:01.253668 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m13:21:01.254182 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m13:21:01.254910 [info ] [Thread-1 (]: 4 of 14 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m13:21:01.255477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m13:21:01.256126 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m13:21:01.259130 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m13:21:01.259720 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m13:21:01.261886 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m13:21:01.263293 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.274827 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.277294 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.280788 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.282836 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m13:21:01.283432 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m13:21:01.299553 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.301412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d469d0>]}
[0m13:21:01.301992 [info ] [Thread-1 (]: 4 of 14 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m13:21:01.302672 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m13:21:01.303092 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m13:21:01.303717 [info ] [Thread-1 (]: 5 of 14 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m13:21:01.304287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m13:21:01.304650 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m13:21:01.307280 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m13:21:01.307992 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m13:21:01.310369 [debug] [Thread-1 (]: Creating new relation stg_film
[0m13:21:01.311353 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.324160 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.326727 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.330022 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.332238 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m13:21:01.332763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m13:21:01.348842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.350424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8dcd7f0>]}
[0m13:21:01.350927 [info ] [Thread-1 (]: 5 of 14 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m13:21:01.351445 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m13:21:01.351807 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m13:21:01.352315 [info ] [Thread-1 (]: 6 of 14 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m13:21:01.352720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m13:21:01.353042 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m13:21:01.355375 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m13:21:01.355926 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m13:21:01.357853 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m13:21:01.361552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.373025 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.375529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.378973 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.380740 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m13:21:01.381398 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m13:21:01.396448 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.398040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d83710>]}
[0m13:21:01.398544 [info ] [Thread-1 (]: 6 of 14 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.05s]
[0m13:21:01.399040 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m13:21:01.399418 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m13:21:01.399898 [info ] [Thread-1 (]: 7 of 14 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m13:21:01.400266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m13:21:01.400586 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m13:21:01.402843 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m13:21:01.403386 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m13:21:01.405721 [debug] [Thread-1 (]: Creating new relation stg_language
[0m13:21:01.406682 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m13:21:01.418136 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.420731 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.423959 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.425882 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m13:21:01.426457 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m13:21:01.439463 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.441027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d82f30>]}
[0m13:21:01.441637 [info ] [Thread-1 (]: 7 of 14 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m13:21:01.442139 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m13:21:01.442502 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m13:21:01.442895 [info ] [Thread-1 (]: 8 of 14 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m13:21:01.443271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m13:21:01.443706 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m13:21:01.446003 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m13:21:01.446643 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m13:21:01.448526 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m13:21:01.449983 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.461916 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.464229 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.467462 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.469228 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m13:21:01.469762 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m13:21:01.493477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.495332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d4d205f0>]}
[0m13:21:01.495849 [info ] [Thread-1 (]: 8 of 14 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m13:21:01.496437 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m13:21:01.496809 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m13:21:01.497217 [info ] [Thread-1 (]: 9 of 14 START sql table model `adw02_stag`.`stg_staff` ......................... [RUN]
[0m13:21:01.497605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m13:21:01.497922 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m13:21:01.500320 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m13:21:01.500961 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m13:21:01.503270 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m13:21:01.504295 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.516702 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.519185 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.522573 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.524799 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m13:21:01.525306 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m13:21:01.539621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.541199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d82870>]}
[0m13:21:01.541805 [info ] [Thread-1 (]: 9 of 14 OK created sql table model `adw02_stag`.`stg_staff` .................... [[32mOK[0m in 0.04s]
[0m13:21:01.542318 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m13:21:01.542697 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m13:21:01.543214 [info ] [Thread-1 (]: 10 of 14 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m13:21:01.543636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m13:21:01.543949 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m13:21:01.546300 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m13:21:01.546857 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m13:21:01.548733 [debug] [Thread-1 (]: Creating new relation stg_store
[0m13:21:01.550155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m13:21:01.563128 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.565570 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:21:01.568900 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.570643 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m13:21:01.571199 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m13:21:01.584357 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.585923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d25010>]}
[0m13:21:01.586431 [info ] [Thread-1 (]: 10 of 14 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m13:21:01.586950 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m13:21:01.587370 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m13:21:01.587781 [info ] [Thread-1 (]: 11 of 14 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m13:21:01.588172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m13:21:01.588717 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m13:21:01.602459 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m13:21:01.603066 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m13:21:01.605117 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m13:21:01.606124 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m13:21:01.618411 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.620998 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:21:01.624544 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.627011 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m13:21:01.627574 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m13:21:01.645064 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.646701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d24590>]}
[0m13:21:01.647199 [info ] [Thread-1 (]: 11 of 14 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m13:21:01.647738 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m13:21:01.648138 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m13:21:01.648751 [info ] [Thread-1 (]: 12 of 14 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m13:21:01.649382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m13:21:01.649708 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m13:21:01.653699 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m13:21:01.654336 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m13:21:01.656674 [debug] [Thread-1 (]: Creating new relation dim_film
[0m13:21:01.657683 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m13:21:01.669704 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.672029 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:21:01.675285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.677809 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m13:21:01.678376 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m13:21:01.695161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.696813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d26750>]}
[0m13:21:01.697402 [info ] [Thread-1 (]: 12 of 14 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m13:21:01.697909 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m13:21:01.698324 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m13:21:01.698746 [info ] [Thread-1 (]: 13 of 14 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m13:21:01.699130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m13:21:01.699453 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m13:21:01.703423 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m13:21:01.704086 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m13:21:01.706279 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m13:21:01.707262 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m13:21:01.719675 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.721991 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:21:01.725134 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.727404 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m13:21:01.727955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m13:21:01.744625 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.746419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d27050>]}
[0m13:21:01.747043 [info ] [Thread-1 (]: 13 of 14 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m13:21:01.747691 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m13:21:01.748114 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m13:21:01.748637 [info ] [Thread-1 (]: 14 of 14 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m13:21:01.749038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m13:21:01.749514 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m13:21:01.757267 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m13:21:01.757933 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m13:21:01.759931 [debug] [Thread-1 (]: Creating new relation dim_store
[0m13:21:01.760975 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m13:21:01.773954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:21:01.776933 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:21:01.780554 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:21:01.782743 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m13:21:01.783298 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m13:21:01.801201 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:21:01.802792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee96b03e-424a-42ad-9f92-22b843fb22a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d83830>]}
[0m13:21:01.803292 [info ] [Thread-1 (]: 14 of 14 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m13:21:01.803933 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m13:21:01.805126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:01.805418 [debug] [MainThread]: Connection 'model.sakstar.dim_store' was left open.
[0m13:21:01.805696 [debug] [MainThread]: On model.sakstar.dim_store: Close
[0m13:21:01.806091 [info ] [MainThread]: 
[0m13:21:01.806483 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m13:21:01.808990 [debug] [MainThread]: Command end result
[0m13:21:01.841480 [info ] [MainThread]: 
[0m13:21:01.841857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:01.842148 [info ] [MainThread]: 
[0m13:21:01.842472 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:21:01.843175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8818867, "process_in_blocks": "0", "process_kernel_time": 0.170641, "process_mem_max_rss": "141972", "process_out_blocks": "4904", "process_user_time": 2.358703}
[0m13:21:01.843559 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:01.843466 after 1.88 seconds
[0m13:21:01.843875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d580d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d248f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827c8d24950>]}
[0m13:21:01.844191 [debug] [MainThread]: Flushing usage events
[0m10:33:59.588347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e408c9a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406ba5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406ba5450>]}


============================== 10:33:59.592973 | d4dc0c4a-1ec0-41de-a19c-59f72eec7a69 ==============================
[0m10:33:59.592973 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:33:59.593668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:59.754491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e407bd9cd0>]}
[0m10:33:59.806318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406a2f570>]}
[0m10:33:59.807225 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m10:33:59.895724 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:34:00.039619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:34:00.040140 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/dim/dim_date/dim_date.sql
[0m10:34:00.267174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e40663df50>]}
[0m10:34:00.381096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e4069fa030>]}
[0m10:34:00.381541 [info ] [MainThread]: Found 15 models, 16 data tests, 10 sources, 608 macros
[0m10:34:00.381885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e4064e5d30>]}
[0m10:34:00.384251 [info ] [MainThread]: 
[0m10:34:00.384915 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:34:00.391555 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:34:00.401859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:00.645440 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:00.648078 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:00.733853 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:00.736898 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:00.740059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m10:34:00.745379 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m10:34:00.757253 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:00.758574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m10:34:00.760286 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m10:34:00.772295 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:00.773792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e4063a0ef0>]}
[0m10:34:00.774291 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m10:34:00.774606 [info ] [MainThread]: 
[0m10:34:00.777816 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m10:34:00.778392 [info ] [Thread-1 (]: 1 of 15 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m10:34:00.778867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m10:34:00.779464 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m10:34:00.786229 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m10:34:00.787118 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m10:34:00.807997 [debug] [Thread-1 (]: Creating new relation dim_date
[0m10:34:00.838925 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
);
          )
        
        ...
[0m10:34:00.842214 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
);
          )
        
        
[0m10:34:00.857162 [debug] [Thread-1 (]: Database Error in model dim_date (models/marts/dim/dim_date/dim_date.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 653 (end of query) (line 29, col 2): ;
            )
          
          . Expected one of: FILTER, RESPECT NULLS, IGNORE NULLS, OVER, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, GLOBAL, LOCAL, ANY, ALL, ASOF, SEMI, ANTI, ONLY, LEFT, RIGHT, FULL, CROSS, PASTE, JOIN, token, OpeningRoundBracket, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb58e694ac3
  12. ? @ 0x00007fb58e726850
[0m10:34:00.858397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3feda3d10>]}
[0m10:34:00.858942 [error] [Thread-1 (]: 1 of 15 ERROR creating sql table model `adw02_star`.`dim_date` ................. [[31mERROR[0m in 0.08s]
[0m10:34:00.859593 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m10:34:00.860026 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m10:34:00.860522 [info ] [Thread-1 (]: 2 of 15 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m10:34:00.861005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m10:34:00.861388 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m10:34:00.863812 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m10:34:00.865060 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m10:34:00.867406 [debug] [Thread-1 (]: Creating new relation stg_address
[0m10:34:00.868444 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m10:34:00.887529 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:00.902428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:00.905813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:00.909771 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m10:34:00.910345 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m10:34:00.928611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:00.945252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fee42990>]}
[0m10:34:00.945761 [info ] [Thread-1 (]: 2 of 15 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.08s]
[0m10:34:00.946310 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m10:34:00.946678 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m10:34:00.947151 [info ] [Thread-1 (]: 3 of 15 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m10:34:00.947688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m10:34:00.948021 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m10:34:00.950533 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m10:34:00.951126 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m10:34:00.953481 [debug] [Thread-1 (]: Creating new relation stg_city
[0m10:34:00.954479 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m10:34:00.966591 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:00.969052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:00.972717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:00.974331 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m10:34:00.974828 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m10:34:00.988542 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:00.990261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406882990>]}
[0m10:34:00.990755 [info ] [Thread-1 (]: 3 of 15 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m10:34:00.991336 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m10:34:00.991720 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m10:34:00.992193 [info ] [Thread-1 (]: 4 of 15 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m10:34:00.992597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m10:34:00.992989 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m10:34:00.995835 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m10:34:00.996522 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m10:34:00.998388 [debug] [Thread-1 (]: Creating new relation stg_country
[0m10:34:00.999423 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m10:34:01.011741 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.014396 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.017686 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.019245 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m10:34:01.019746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m10:34:01.032548 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.034213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fd091ad0>]}
[0m10:34:01.034713 [info ] [Thread-1 (]: 4 of 15 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m10:34:01.035231 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m10:34:01.035592 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m10:34:01.035995 [info ] [Thread-1 (]: 5 of 15 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m10:34:01.036412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m10:34:01.036736 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m10:34:01.039136 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m10:34:01.039765 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m10:34:01.042263 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m10:34:01.043346 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.055814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.058376 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.061656 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.063533 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m10:34:01.064067 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m10:34:01.078394 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.079953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fe9a8bb0>]}
[0m10:34:01.080461 [info ] [Thread-1 (]: 5 of 15 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m10:34:01.080970 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m10:34:01.081391 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m10:34:01.081941 [info ] [Thread-1 (]: 6 of 15 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m10:34:01.082491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m10:34:01.082831 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m10:34:01.086002 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m10:34:01.086618 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m10:34:01.088721 [debug] [Thread-1 (]: Creating new relation stg_film
[0m10:34:01.089942 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.101852 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.106687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.110291 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.112537 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m10:34:01.113089 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m10:34:01.129503 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.131187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406a2b830>]}
[0m10:34:01.131743 [info ] [Thread-1 (]: 6 of 15 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m10:34:01.132386 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m10:34:01.132762 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m10:34:01.133288 [info ] [Thread-1 (]: 7 of 15 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m10:34:01.133712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m10:34:01.134134 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m10:34:01.136607 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m10:34:01.137250 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m10:34:01.139536 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m10:34:01.140466 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.152432 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.154738 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.157961 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.159512 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m10:34:01.160043 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m10:34:01.175244 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.176831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e40688e270>]}
[0m10:34:01.177408 [info ] [Thread-1 (]: 7 of 15 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m10:34:01.177916 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m10:34:01.178284 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m10:34:01.178681 [info ] [Thread-1 (]: 8 of 15 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m10:34:01.179128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m10:34:01.179536 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m10:34:01.182142 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m10:34:01.182638 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m10:34:01.184262 [debug] [Thread-1 (]: Creating new relation stg_language
[0m10:34:01.185155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m10:34:01.196742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.199598 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.203474 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.204975 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m10:34:01.205521 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m10:34:01.218547 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.220129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea0fb30>]}
[0m10:34:01.220636 [info ] [Thread-1 (]: 8 of 15 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m10:34:01.221218 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m10:34:01.221609 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m10:34:01.222010 [info ] [Thread-1 (]: 9 of 15 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m10:34:01.222533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m10:34:01.222856 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m10:34:01.225334 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m10:34:01.226050 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m10:34:01.227984 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m10:34:01.229362 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.241283 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.244052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.247967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.249739 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m10:34:01.250260 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m10:34:01.273709 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.275356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea1c6b0>]}
[0m10:34:01.275862 [info ] [Thread-1 (]: 9 of 15 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m10:34:01.276441 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m10:34:01.276813 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m10:34:01.277293 [info ] [Thread-1 (]: 10 of 15 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m10:34:01.277811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m10:34:01.278157 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m10:34:01.280875 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m10:34:01.281505 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m10:34:01.283947 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m10:34:01.284959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.297097 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.299957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.303381 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.305297 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m10:34:01.305940 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m10:34:01.320061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.321729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406a2a390>]}
[0m10:34:01.322232 [info ] [Thread-1 (]: 10 of 15 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m10:34:01.322734 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m10:34:01.323104 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m10:34:01.323505 [info ] [Thread-1 (]: 11 of 15 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m10:34:01.323873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m10:34:01.324416 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m10:34:01.326875 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m10:34:01.327481 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m10:34:01.329339 [debug] [Thread-1 (]: Creating new relation stg_store
[0m10:34:01.330729 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:01.342335 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.344629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:01.347892 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.349620 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m10:34:01.350402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m10:34:01.363518 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.365099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea1eb10>]}
[0m10:34:01.365608 [info ] [Thread-1 (]: 11 of 15 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m10:34:01.366120 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m10:34:01.366484 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m10:34:01.367006 [info ] [Thread-1 (]: 12 of 15 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m10:34:01.367513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m10:34:01.367847 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m10:34:01.381436 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m10:34:01.382064 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m10:34:01.383976 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m10:34:01.385027 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m10:34:01.396568 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.399174 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:01.402707 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.404954 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m10:34:01.405545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m10:34:01.424633 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.426192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea1f290>]}
[0m10:34:01.426687 [info ] [Thread-1 (]: 12 of 15 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m10:34:01.427195 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m10:34:01.427560 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m10:34:01.428063 [info ] [Thread-1 (]: 13 of 15 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m10:34:01.428441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m10:34:01.428755 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m10:34:01.432624 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m10:34:01.433168 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m10:34:01.435609 [debug] [Thread-1 (]: Creating new relation dim_film
[0m10:34:01.436780 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:01.450481 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.452896 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:01.456564 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.458738 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m10:34:01.459532 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m10:34:01.476867 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.478484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea1ddf0>]}
[0m10:34:01.478981 [info ] [Thread-1 (]: 13 of 15 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m10:34:01.479488 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m10:34:01.479844 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m10:34:01.480247 [info ] [Thread-1 (]: 14 of 15 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m10:34:01.480614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m10:34:01.480929 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m10:34:01.485214 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m10:34:01.485906 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m10:34:01.490592 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m10:34:01.491702 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:01.504767 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.507140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:01.510624 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.512834 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m10:34:01.513414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m10:34:01.529678 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.531276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e4064b3170>]}
[0m10:34:01.531800 [info ] [Thread-1 (]: 14 of 15 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m10:34:01.532401 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m10:34:01.532895 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m10:34:01.533296 [info ] [Thread-1 (]: 15 of 15 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m10:34:01.533678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m10:34:01.534167 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m10:34:01.539471 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m10:34:01.540302 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m10:34:01.542980 [debug] [Thread-1 (]: Creating new relation dim_store
[0m10:34:01.544494 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:01.557700 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:01.560396 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:01.563917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:01.566099 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m10:34:01.566792 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m10:34:01.585366 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:01.586925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4dc0c4a-1ec0-41de-a19c-59f72eec7a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fea1fd70>]}
[0m10:34:01.587449 [info ] [Thread-1 (]: 15 of 15 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m10:34:01.587951 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m10:34:01.589184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:01.589474 [debug] [MainThread]: Connection 'model.sakstar.dim_store' was left open.
[0m10:34:01.589789 [debug] [MainThread]: On model.sakstar.dim_store: Close
[0m10:34:01.590213 [info ] [MainThread]: 
[0m10:34:01.590700 [info ] [MainThread]: Finished running 15 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m10:34:01.593121 [debug] [MainThread]: Command end result
[0m10:34:01.633973 [info ] [MainThread]: 
[0m10:34:01.634400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:34:01.634700 [info ] [MainThread]: 
[0m10:34:01.635168 [error] [MainThread]:   Database Error in model dim_date (models/marts/dim/dim_date/dim_date.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 653 (end of query) (line 29, col 2): ;
            )
          
          . Expected one of: FILTER, RESPECT NULLS, IGNORE NULLS, OVER, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, GLOBAL, LOCAL, ANY, ALL, ASOF, SEMI, ANTI, ONLY, LEFT, RIGHT, FULL, CROSS, PASTE, JOIN, token, OpeningRoundBracket, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb58e694ac3
  12. ? @ 0x00007fb58e726850
[0m10:34:01.635548 [info ] [MainThread]: 
[0m10:34:01.635897 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m10:34:01.637422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0916078, "process_in_blocks": "65824", "process_kernel_time": 0.211493, "process_mem_max_rss": "142548", "process_out_blocks": "4936", "process_user_time": 2.476352}
[0m10:34:01.637958 [debug] [MainThread]: Command `dbt run` failed at 10:34:01.637825 after 2.09 seconds
[0m10:34:01.638392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e407b57d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e406a2b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e3fd127ef0>]}
[0m10:34:01.638743 [debug] [MainThread]: Flushing usage events
[0m10:34:40.075711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790037d92120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035cb5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035cb5450>]}


============================== 10:34:40.078499 | 0190ac2d-459e-4a30-8090-58bbcb40ce82 ==============================
[0m10:34:40.078499 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:34:40.078978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:34:40.222129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790036ce9cd0>]}
[0m10:34:40.270837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035b27790>]}
[0m10:34:40.271411 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m10:34:40.349825 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:34:40.455565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:34:40.456106 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_date/dim_date.sql
[0m10:34:40.670055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035725e50>]}
[0m10:34:40.758765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035b09f40>]}
[0m10:34:40.759207 [info ] [MainThread]: Found 15 models, 16 data tests, 10 sources, 608 macros
[0m10:34:40.759547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7900355d5d30>]}
[0m10:34:40.761737 [info ] [MainThread]: 
[0m10:34:40.762217 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:34:40.768286 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:34:40.777630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:41.001930 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:41.007285 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:41.070551 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:34:41.073463 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:41.076165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m10:34:41.081490 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m10:34:41.093787 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:41.095128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m10:34:41.096598 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m10:34:41.108579 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:41.109988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7900354b0ef0>]}
[0m10:34:41.110461 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m10:34:41.110757 [info ] [MainThread]: 
[0m10:34:41.112945 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m10:34:41.113641 [info ] [Thread-1 (]: 1 of 15 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m10:34:41.114094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m10:34:41.114652 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m10:34:41.120910 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m10:34:41.121471 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m10:34:41.139741 [debug] [Thread-1 (]: Creating new relation dim_date
[0m10:34:41.172341 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m10:34:41.240555 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:34:41.271241 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:41.275764 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:41.282197 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m10:34:41.283135 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m10:34:42.699714 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.42 seconds
[0m10:34:42.718391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015cdc350>]}
[0m10:34:42.718976 [info ] [Thread-1 (]: 1 of 15 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.60s]
[0m10:34:42.719527 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m10:34:42.719967 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m10:34:42.720455 [info ] [Thread-1 (]: 2 of 15 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m10:34:42.721016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m10:34:42.721632 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m10:34:42.724214 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m10:34:42.724866 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m10:34:42.727343 [debug] [Thread-1 (]: Creating new relation stg_address
[0m10:34:42.728744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m10:34:42.792242 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:34:42.794658 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:42.798055 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:42.799832 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m10:34:42.800370 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m10:34:42.814788 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.816457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79001611bac0>]}
[0m10:34:42.817061 [info ] [Thread-1 (]: 2 of 15 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.10s]
[0m10:34:42.817688 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m10:34:42.818210 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m10:34:42.818619 [info ] [Thread-1 (]: 3 of 15 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m10:34:42.819063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m10:34:42.819527 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m10:34:42.822851 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m10:34:42.823446 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m10:34:42.825522 [debug] [Thread-1 (]: Creating new relation stg_city
[0m10:34:42.826529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m10:34:42.838513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.841151 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:42.844715 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:42.846213 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m10:34:42.846718 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m10:34:42.860787 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.862349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035b32cb0>]}
[0m10:34:42.862856 [info ] [Thread-1 (]: 3 of 15 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m10:34:42.863481 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m10:34:42.863977 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m10:34:42.864404 [info ] [Thread-1 (]: 4 of 15 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m10:34:42.864871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m10:34:42.865375 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m10:34:42.868211 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m10:34:42.868901 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m10:34:42.871709 [debug] [Thread-1 (]: Creating new relation stg_country
[0m10:34:42.872742 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m10:34:42.884951 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.887302 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:42.890576 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:42.892014 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m10:34:42.892575 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m10:34:42.905850 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.907513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015d6e650>]}
[0m10:34:42.908016 [info ] [Thread-1 (]: 4 of 15 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m10:34:42.908540 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m10:34:42.908944 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m10:34:42.909360 [info ] [Thread-1 (]: 5 of 15 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m10:34:42.909737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m10:34:42.910061 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m10:34:42.912756 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m10:34:42.913386 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m10:34:42.915250 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m10:34:42.916262 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m10:34:42.928345 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.930923 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:42.934336 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:42.936174 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m10:34:42.936691 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m10:34:42.950598 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.952167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015c8e350>]}
[0m10:34:42.952666 [info ] [Thread-1 (]: 5 of 15 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m10:34:42.953260 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m10:34:42.953767 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m10:34:42.954171 [info ] [Thread-1 (]: 6 of 15 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m10:34:42.954575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m10:34:42.954925 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m10:34:42.957304 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m10:34:42.958063 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m10:34:42.962521 [debug] [Thread-1 (]: Creating new relation stg_film
[0m10:34:42.963578 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m10:34:42.976427 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:42.978826 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:42.982019 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:42.984199 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m10:34:42.984846 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m10:34:43.001239 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.002847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dbba10>]}
[0m10:34:43.003384 [info ] [Thread-1 (]: 6 of 15 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m10:34:43.003932 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m10:34:43.004333 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m10:34:43.004766 [info ] [Thread-1 (]: 7 of 15 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m10:34:43.005205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m10:34:43.005556 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m10:34:43.008365 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m10:34:43.009002 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m10:34:43.010871 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m10:34:43.011850 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:43.024292 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.026945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:43.030322 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.032131 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m10:34:43.032753 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m10:34:43.048175 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.049777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dbb170>]}
[0m10:34:43.050319 [info ] [Thread-1 (]: 7 of 15 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m10:34:43.050861 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m10:34:43.051259 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m10:34:43.051706 [info ] [Thread-1 (]: 8 of 15 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m10:34:43.052157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m10:34:43.052513 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m10:34:43.054784 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m10:34:43.055459 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m10:34:43.058197 [debug] [Thread-1 (]: Creating new relation stg_language
[0m10:34:43.060564 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m10:34:43.073878 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.076269 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:43.079568 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.081370 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m10:34:43.082000 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m10:34:43.095217 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.096811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790035b3cbf0>]}
[0m10:34:43.097348 [info ] [Thread-1 (]: 8 of 15 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m10:34:43.097887 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m10:34:43.098287 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m10:34:43.098957 [info ] [Thread-1 (]: 9 of 15 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m10:34:43.099488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m10:34:43.100105 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m10:34:43.103297 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m10:34:43.103915 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m10:34:43.105778 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m10:34:43.106787 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:43.118143 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.120721 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:43.124205 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.125981 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m10:34:43.126707 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m10:34:43.150920 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.152497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dba450>]}
[0m10:34:43.153002 [info ] [Thread-1 (]: 9 of 15 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m10:34:43.153517 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m10:34:43.153882 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m10:34:43.154292 [info ] [Thread-1 (]: 10 of 15 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m10:34:43.154673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m10:34:43.155030 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m10:34:43.157376 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m10:34:43.158071 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m10:34:43.159910 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m10:34:43.161313 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m10:34:43.172915 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.175268 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:43.178724 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.180855 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m10:34:43.181419 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m10:34:43.196705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.198293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79001438ca10>]}
[0m10:34:43.198810 [info ] [Thread-1 (]: 10 of 15 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m10:34:43.199322 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m10:34:43.199712 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m10:34:43.200118 [info ] [Thread-1 (]: 11 of 15 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m10:34:43.200491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m10:34:43.200953 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m10:34:43.203491 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m10:34:43.204109 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m10:34:43.206387 [debug] [Thread-1 (]: Creating new relation stg_store
[0m10:34:43.207336 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m10:34:43.218921 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.221277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:34:43.224735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.227094 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m10:34:43.227629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m10:34:43.240776 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.242472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dba090>]}
[0m10:34:43.242988 [info ] [Thread-1 (]: 11 of 15 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m10:34:43.243674 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m10:34:43.244028 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m10:34:43.244431 [info ] [Thread-1 (]: 12 of 15 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m10:34:43.244804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m10:34:43.245184 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m10:34:43.259203 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m10:34:43.259789 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m10:34:43.261952 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m10:34:43.262940 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m10:34:43.274461 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.276760 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:43.279890 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.282172 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m10:34:43.282738 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m10:34:43.302690 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.304263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79001438daf0>]}
[0m10:34:43.304763 [info ] [Thread-1 (]: 12 of 15 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m10:34:43.305271 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m10:34:43.305628 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m10:34:43.306022 [info ] [Thread-1 (]: 13 of 15 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m10:34:43.306494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m10:34:43.306816 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m10:34:43.310976 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m10:34:43.311582 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m10:34:43.313366 [debug] [Thread-1 (]: Creating new relation dim_film
[0m10:34:43.314580 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:43.327917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.330280 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:43.333677 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.335896 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m10:34:43.336465 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m10:34:43.353385 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.355243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79001438d610>]}
[0m10:34:43.355738 [info ] [Thread-1 (]: 13 of 15 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m10:34:43.356246 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m10:34:43.356604 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m10:34:43.357140 [info ] [Thread-1 (]: 14 of 15 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m10:34:43.357551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m10:34:43.357885 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m10:34:43.366115 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m10:34:43.366743 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m10:34:43.368887 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m10:34:43.370028 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:43.382102 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.384651 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:43.388077 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.390279 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m10:34:43.390854 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m10:34:43.407405 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.409005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dba450>]}
[0m10:34:43.409511 [info ] [Thread-1 (]: 14 of 15 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m10:34:43.410015 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m10:34:43.410382 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m10:34:43.410902 [info ] [Thread-1 (]: 15 of 15 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m10:34:43.411296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m10:34:43.411617 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m10:34:43.416016 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m10:34:43.416589 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m10:34:43.418781 [debug] [Thread-1 (]: Creating new relation dim_store
[0m10:34:43.419949 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m10:34:43.433859 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:34:43.436273 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:34:43.439739 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:34:43.441935 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m10:34:43.442542 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m10:34:43.461422 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:34:43.463146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0190ac2d-459e-4a30-8090-58bbcb40ce82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790015dbb2f0>]}
[0m10:34:43.463875 [info ] [Thread-1 (]: 15 of 15 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m10:34:43.464592 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m10:34:43.465742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:43.466022 [debug] [MainThread]: Connection 'model.sakstar.dim_store' was left open.
[0m10:34:43.466303 [debug] [MainThread]: On model.sakstar.dim_store: Close
[0m10:34:43.466689 [info ] [MainThread]: 
[0m10:34:43.466998 [info ] [MainThread]: Finished running 15 table models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m10:34:43.469285 [debug] [MainThread]: Command end result
[0m10:34:43.501798 [info ] [MainThread]: 
[0m10:34:43.502185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:43.502479 [info ] [MainThread]: 
[0m10:34:43.502779 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m10:34:43.503455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.469639, "process_in_blocks": "8", "process_kernel_time": 0.155344, "process_mem_max_rss": "141920", "process_out_blocks": "4928", "process_user_time": 2.419614}
[0m10:34:43.503825 [debug] [MainThread]: Command `dbt run` succeeded at 10:34:43.503736 after 3.47 seconds
[0m10:34:43.504143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790036625190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79003560ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79001438fef0>]}
[0m10:34:43.504467 [debug] [MainThread]: Flushing usage events
[0m10:56:01.690937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520cf92120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520aeb5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520aeb5450>]}


============================== 10:56:01.693636 | b18d9d36-4697-4d53-ab4f-12d511244fec ==============================
[0m10:56:01.693636 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:56:01.694126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:56:01.839495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520bee9cd0>]}
[0m10:56:01.889729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520ad27790>]}
[0m10:56:01.890382 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m10:56:01.971089 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:56:02.073795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:56:02.074282 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m10:56:02.297963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520a929850>]}
[0m10:56:02.388064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520ad09f40>]}
[0m10:56:02.388573 [info ] [MainThread]: Found 16 models, 16 data tests, 10 sources, 608 macros
[0m10:56:02.388866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520a6ca190>]}
[0m10:56:02.391398 [info ] [MainThread]: 
[0m10:56:02.391860 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:56:02.398376 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:56:02.407857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:02.599687 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:56:02.602381 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:02.665088 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:56:02.668233 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:02.671013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m10:56:02.676345 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m10:56:02.689386 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:02.690661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m10:56:02.692215 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m10:56:02.703341 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:02.705485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520a72b520>]}
[0m10:56:02.705958 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m10:56:02.706261 [info ] [MainThread]: 
[0m10:56:02.708364 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m10:56:02.708870 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m10:56:02.709309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.dim_date)
[0m10:56:02.709675 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m10:56:02.715937 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m10:56:02.716511 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m10:56:02.735862 [debug] [Thread-1 (]: Creating new relation dim_date
[0m10:56:02.765467 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m10:56:02.833366 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:56:02.862469 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:56:02.867184 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:02.873776 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m10:56:02.874372 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m10:56:04.231991 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.36 seconds
[0m10:56:04.249259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785208524410>]}
[0m10:56:04.249793 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.54s]
[0m10:56:04.250339 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m10:56:04.250721 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m10:56:04.251201 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m10:56:04.251607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m10:56:04.251926 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m10:56:04.254115 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m10:56:04.254698 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m10:56:04.256845 [debug] [Thread-1 (]: Creating new relation stg_address
[0m10:56:04.257855 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.270398 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.272735 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.275846 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.277772 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m10:56:04.278435 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m10:56:04.294514 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.296174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785208983c20>]}
[0m10:56:04.296680 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.04s]
[0m10:56:04.297238 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m10:56:04.297599 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m10:56:04.298000 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m10:56:04.298397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m10:56:04.298855 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m10:56:04.301668 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m10:56:04.302398 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m10:56:04.304313 [debug] [Thread-1 (]: Creating new relation stg_city
[0m10:56:04.305291 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m10:56:04.316717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.319315 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.322521 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.324047 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m10:56:04.324546 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m10:56:04.337368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.338956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520ad5b430>]}
[0m10:56:04.339457 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m10:56:04.339955 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m10:56:04.340324 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m10:56:04.340758 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m10:56:04.341231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m10:56:04.341554 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m10:56:04.343903 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m10:56:04.344482 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m10:56:04.346787 [debug] [Thread-1 (]: Creating new relation stg_country
[0m10:56:04.347733 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m10:56:04.359330 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.361675 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.364842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.366261 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m10:56:04.366779 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m10:56:04.379620 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.381479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852085efdd0>]}
[0m10:56:04.381974 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m10:56:04.382503 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m10:56:04.382903 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m10:56:04.383519 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m10:56:04.384132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m10:56:04.384462 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m10:56:04.387239 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m10:56:04.387786 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m10:56:04.389699 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m10:56:04.390677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.401429 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.404054 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.407335 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.409242 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m10:56:04.409761 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m10:56:04.423966 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.425547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084d9390>]}
[0m10:56:04.426055 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.04s]
[0m10:56:04.426561 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m10:56:04.426920 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m10:56:04.427330 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m10:56:04.427705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m10:56:04.428118 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m10:56:04.430876 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m10:56:04.431653 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m10:56:04.436341 [debug] [Thread-1 (]: Creating new relation stg_film
[0m10:56:04.437402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.451554 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.453918 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.456914 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.459108 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m10:56:04.459633 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m10:56:04.477325 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.478974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c4d10>]}
[0m10:56:04.479521 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m10:56:04.480128 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m10:56:04.480615 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m10:56:04.481131 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m10:56:04.481652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m10:56:04.481978 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m10:56:04.484705 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m10:56:04.485250 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m10:56:04.487093 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m10:56:04.488058 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.499368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.501943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.505076 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.506631 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m10:56:04.507231 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m10:56:04.521963 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.523517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c6930>]}
[0m10:56:04.524016 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m10:56:04.524575 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m10:56:04.524936 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m10:56:04.525359 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m10:56:04.525745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m10:56:04.526071 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m10:56:04.528801 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m10:56:04.529513 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m10:56:04.531364 [debug] [Thread-1 (]: Creating new relation stg_language
[0m10:56:04.532895 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m10:56:04.544749 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.547071 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.549964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.551432 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m10:56:04.552021 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m10:56:04.564198 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.565794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852087a6e10>]}
[0m10:56:04.566332 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m10:56:04.566866 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m10:56:04.567285 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m10:56:04.567754 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m10:56:04.568236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m10:56:04.568598 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m10:56:04.571274 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m10:56:04.572141 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m10:56:04.574518 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m10:56:04.575940 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.588072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.590667 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.594075 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.595851 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m10:56:04.596486 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m10:56:04.624996 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m10:56:04.627008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c7890>]}
[0m10:56:04.627700 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.06s]
[0m10:56:04.628560 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m10:56:04.629110 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m10:56:04.629783 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m10:56:04.630292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m10:56:04.630671 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m10:56:04.633202 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m10:56:04.633919 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m10:56:04.635987 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m10:56:04.637580 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.649817 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.652464 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.656068 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.658418 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m10:56:04.658935 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m10:56:04.673298 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.674854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852083a0e90>]}
[0m10:56:04.675354 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m10:56:04.676052 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m10:56:04.676414 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m10:56:04.676832 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m10:56:04.677346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m10:56:04.677701 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m10:56:04.680344 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m10:56:04.680910 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m10:56:04.683231 [debug] [Thread-1 (]: Creating new relation stg_store
[0m10:56:04.684491 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m10:56:04.696615 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.698980 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:56:04.702269 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.704101 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m10:56:04.704608 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m10:56:04.717878 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.719435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c7890>]}
[0m10:56:04.719934 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m10:56:04.720455 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m10:56:04.720830 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m10:56:04.721239 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m10:56:04.721690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m10:56:04.722010 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m10:56:04.725963 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m10:56:04.726663 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m10:56:04.729081 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m10:56:04.730482 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m10:56:04.743939 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.746258 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:56:04.749576 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.751803 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m10:56:04.752377 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m10:56:04.770997 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.772565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c7b30>]}
[0m10:56:04.773070 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m10:56:04.773570 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m10:56:04.773926 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m10:56:04.774338 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m10:56:04.774718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m10:56:04.775028 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m10:56:04.779275 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m10:56:04.779961 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m10:56:04.781853 [debug] [Thread-1 (]: Creating new relation dim_film
[0m10:56:04.782864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m10:56:04.795568 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.798340 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:56:04.801894 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.804507 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m10:56:04.805082 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m10:56:04.822420 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.824629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852083a1d90>]}
[0m10:56:04.825537 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m10:56:04.826073 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m10:56:04.826439 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m10:56:04.826847 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m10:56:04.827430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m10:56:04.827838 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m10:56:04.831900 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m10:56:04.832585 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m10:56:04.837375 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m10:56:04.838436 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m10:56:04.852619 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.855176 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:56:04.858755 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.860973 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m10:56:04.861577 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m10:56:04.878478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.880041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852087a6bd0>]}
[0m10:56:04.880565 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m10:56:04.881087 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m10:56:04.881458 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m10:56:04.881864 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m10:56:04.882300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m10:56:04.882618 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m10:56:04.887157 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m10:56:04.887820 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m10:56:04.890257 [debug] [Thread-1 (]: Creating new relation dim_store
[0m10:56:04.891301 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m10:56:04.903954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:56:04.906304 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:56:04.909842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:56:04.911951 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m10:56:04.912540 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m10:56:04.931675 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:56:04.933402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852087a76b0>]}
[0m10:56:04.933901 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m10:56:04.934409 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m10:56:04.935181 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m10:56:04.935723 [info ] [Thread-1 (]: 16 of 16 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m10:56:04.936136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m10:56:04.936458 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m10:56:04.942104 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m10:56:04.942692 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m10:56:04.944505 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m10:56:04.945504 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        DATEDIFF(COALESCE(r.return_date, CURRENT_TIMESTAMP()), r.rental_date) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

-- Obtener la fecha de dim_date que corresponde con la fecha de alquiler
date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON DATE(r.rental_date) = d.date_actual
          )
        
        ...
[0m10:56:04.952743 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        DATEDIFF(COALESCE(r.return_date, CURRENT_TIMESTAMP()), r.rental_date) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

-- Obtener la fecha de dim_date que corresponde con la fecha de alquiler
date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON DATE(r.rental_date) = d.date_actual
          )
        
        
[0m10:56:04.962817 [debug] [Thread-1 (]: Database Error in model fct_rentals (models/marts/fact/fct_rentals/fct_rentals.sql)
  Code: 42.
  DB::Exception: An incorrect number of arguments was specified for function 'dateDiff'. Expected 3 mandatory arguments and 1 optional argument, got 2 arguments: In scope rental_data AS (SELECT r.rental_id, r.rental_date, r.return_date, r.customer_id, r.staff_id, i.film_id, i.store_id, dateDiff(coalesce(r.return_date, now()), r.rental_date) AS rental_duration FROM adw02_stag.stg_rental AS r LEFT JOIN adw02_stag.stg_inventory AS i ON r.inventory_id = i.inventory_id). Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String, String&, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String&>::type, std::type_identity<String>::type>, String&&, String&, String&&) @ 0x0000000011997beb
  3. DB::validateFunctionArguments(DB::IFunction const&, std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&) @ 0x0000000011997abf
  4. DB::(anonymous namespace)::FunctionDateDiff<true>::getReturnTypeImpl(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x000000000ad638b3
  5. DB::IFunctionOverloadResolver::build(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987daa
  6. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f773e
  7. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  8. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  9. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  11. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  12. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  13. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  14. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  15. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  16. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  17. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  18. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  19. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  20. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  21. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  22. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  23. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  24. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  25. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  26. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  27. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  28. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  29. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  30. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  31. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
[0m10:56:04.963511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b18d9d36-4697-4d53-ab4f-12d511244fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520855b2f0>]}
[0m10:56:04.964123 [error] [Thread-1 (]: 16 of 16 ERROR creating sql table model `adw02_star`.`fct_rentals` ............. [[31mERROR[0m in 0.03s]
[0m10:56:04.964888 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m10:56:04.966846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:04.967276 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m10:56:04.967700 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m10:56:04.968071 [info ] [MainThread]: 
[0m10:56:04.968381 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m10:56:04.971055 [debug] [MainThread]: Command end result
[0m10:56:05.009290 [info ] [MainThread]: 
[0m10:56:05.009665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:56:05.009944 [info ] [MainThread]: 
[0m10:56:05.010543 [error] [MainThread]:   Database Error in model fct_rentals (models/marts/fact/fct_rentals/fct_rentals.sql)
  Code: 42.
  DB::Exception: An incorrect number of arguments was specified for function 'dateDiff'. Expected 3 mandatory arguments and 1 optional argument, got 2 arguments: In scope rental_data AS (SELECT r.rental_id, r.rental_date, r.return_date, r.customer_id, r.staff_id, i.film_id, i.store_id, dateDiff(coalesce(r.return_date, now()), r.rental_date) AS rental_duration FROM adw02_stag.stg_rental AS r LEFT JOIN adw02_stag.stg_inventory AS i ON r.inventory_id = i.inventory_id). Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x0000000009c73bec
  2. DB::Exception::Exception<String, String&, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String&>::type, std::type_identity<String>::type>, String&&, String&, String&&) @ 0x0000000011997beb
  3. DB::validateFunctionArguments(DB::IFunction const&, std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&, std::vector<DB::FunctionArgumentDescriptor, std::allocator<DB::FunctionArgumentDescriptor>> const&) @ 0x0000000011997abf
  4. DB::(anonymous namespace)::FunctionDateDiff<true>::getReturnTypeImpl(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x000000000ad638b3
  5. DB::IFunctionOverloadResolver::build(std::vector<DB::ColumnWithTypeAndName, std::allocator<DB::ColumnWithTypeAndName>> const&) const @ 0x0000000011987daa
  6. DB::QueryAnalyzer::resolveFunction(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x00000000128f773e
  7. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbd20
  8. DB::QueryAnalyzer::resolveExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool) @ 0x00000000128db154
  9. DB::QueryAnalyzer::resolveProjectionExpressionNodeList(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&) @ 0x000000001290bba7
  10. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d18ba
  11. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x00000000128dbc5c
  12. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c523
  13. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  14. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  15. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  16. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  17. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  18. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  19. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  20. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  21. DB::QueryAnalyzer::resolveJoin(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290deba
  22. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001290c5af
  23. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x00000000128d186f
  24. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x00000000128cfb8c
  25. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x00000000128cf3f3
  26. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x0000000012924db6
  27. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.5923817706791937394) @ 0x0000000013234fe5
  28. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x0000000013232f7c
  29. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x0000000013235419
  30. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000131981de
  31. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000131a0c2a
[0m10:56:05.011085 [info ] [MainThread]: 
[0m10:56:05.011385 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m10:56:05.012195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3628285, "process_in_blocks": "0", "process_kernel_time": 0.165219, "process_mem_max_rss": "142000", "process_out_blocks": "5016", "process_user_time": 2.42533}
[0m10:56:05.012760 [debug] [MainThread]: Command `dbt run` failed at 10:56:05.012630 after 3.36 seconds
[0m10:56:05.013165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78520c10c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852084c6db0>]}
[0m10:56:05.013496 [debug] [MainThread]: Flushing usage events
[0m10:57:38.606249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98f67a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d58d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d58d450>]}


============================== 10:57:38.608924 | 1f048008-9da4-4813-bda3-f638d9246f54 ==============================
[0m10:57:38.608924 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:57:38.609378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:38.748302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98e4f1cd0>]}
[0m10:57:38.796273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d41f570>]}
[0m10:57:38.796824 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m10:57:38.873412 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:57:38.972678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:38.973209 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m10:57:39.191898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d019850>]}
[0m10:57:39.278766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d3ea030>]}
[0m10:57:39.279159 [info ] [MainThread]: Found 16 models, 16 data tests, 10 sources, 608 macros
[0m10:57:39.279454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98cdc6190>]}
[0m10:57:39.281516 [info ] [MainThread]: 
[0m10:57:39.282071 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:57:39.288324 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:57:39.296937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:39.491925 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:57:39.494404 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:39.556019 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:57:39.559201 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:39.561853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m10:57:39.567236 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m10:57:39.580484 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:39.581746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m10:57:39.583253 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m10:57:39.595157 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:39.597459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98ce07520>]}
[0m10:57:39.597916 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m10:57:39.598269 [info ] [MainThread]: 
[0m10:57:39.600429 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m10:57:39.600936 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m10:57:39.601454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m10:57:39.601787 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m10:57:39.608243 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m10:57:39.608770 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m10:57:39.625922 [debug] [Thread-1 (]: Creating new relation dim_date
[0m10:57:39.655113 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m10:57:39.721889 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:57:39.755792 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:39.760789 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:39.767465 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m10:57:39.768176 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m10:57:41.160218 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.39 seconds
[0m10:57:41.177396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986c08410>]}
[0m10:57:41.177934 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.58s]
[0m10:57:41.178468 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m10:57:41.178859 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m10:57:41.179265 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m10:57:41.179831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m10:57:41.180273 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m10:57:41.182938 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m10:57:41.183488 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m10:57:41.185437 [debug] [Thread-1 (]: Creating new relation stg_address
[0m10:57:41.186368 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.201173 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.203455 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.206442 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.208159 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m10:57:41.208683 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m10:57:41.223269 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.224837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986e9bc20>]}
[0m10:57:41.225360 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.05s]
[0m10:57:41.225876 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m10:57:41.226263 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m10:57:41.226661 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m10:57:41.227123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m10:57:41.227439 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m10:57:41.230306 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m10:57:41.230902 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m10:57:41.232599 [debug] [Thread-1 (]: Creating new relation stg_city
[0m10:57:41.233556 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m10:57:41.244644 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.247201 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.250272 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.251733 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m10:57:41.252248 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m10:57:41.266528 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.268332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98d23f430>]}
[0m10:57:41.268899 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m10:57:41.269517 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m10:57:41.269929 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m10:57:41.270403 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m10:57:41.270850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m10:57:41.271224 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m10:57:41.273834 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m10:57:41.274549 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m10:57:41.277068 [debug] [Thread-1 (]: Creating new relation stg_country
[0m10:57:41.278140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m10:57:41.289372 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.291993 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.295482 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.297123 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m10:57:41.297698 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m10:57:41.312106 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.313925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986cbee50>]}
[0m10:57:41.314513 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m10:57:41.315134 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m10:57:41.315546 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m10:57:41.316009 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m10:57:41.316473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m10:57:41.316839 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m10:57:41.319904 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m10:57:41.320615 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m10:57:41.322592 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m10:57:41.323618 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.335561 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.338510 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.342139 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.344312 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m10:57:41.344899 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m10:57:41.361393 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.363183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986bb9390>]}
[0m10:57:41.363755 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m10:57:41.364383 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m10:57:41.364796 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m10:57:41.365266 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m10:57:41.365712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m10:57:41.366163 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m10:57:41.368820 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m10:57:41.369555 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m10:57:41.374186 [debug] [Thread-1 (]: Creating new relation stg_film
[0m10:57:41.375201 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.386821 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.389107 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.392407 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.394467 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m10:57:41.394979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m10:57:41.411140 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.412685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba6ed0>]}
[0m10:57:41.413192 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m10:57:41.413710 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m10:57:41.414080 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m10:57:41.414476 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m10:57:41.414960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m10:57:41.415294 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m10:57:41.417961 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m10:57:41.418534 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m10:57:41.420274 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m10:57:41.421151 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.432735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.435245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.438373 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.439886 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m10:57:41.440460 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m10:57:41.455753 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.457365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba6e70>]}
[0m10:57:41.457857 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m10:57:41.458378 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m10:57:41.458727 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m10:57:41.459171 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m10:57:41.459550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m10:57:41.459970 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m10:57:41.462309 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m10:57:41.462833 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m10:57:41.464699 [debug] [Thread-1 (]: Creating new relation stg_language
[0m10:57:41.466251 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m10:57:41.476478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.478746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.481621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.483075 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m10:57:41.483590 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m10:57:41.496574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.498206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986eb3e30>]}
[0m10:57:41.498712 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m10:57:41.499232 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m10:57:41.499596 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m10:57:41.499999 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m10:57:41.500400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m10:57:41.500899 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m10:57:41.503757 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m10:57:41.504317 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m10:57:41.506106 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m10:57:41.507130 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.518988 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.521536 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.524806 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.527177 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m10:57:41.527686 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m10:57:41.550796 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.552378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba7d10>]}
[0m10:57:41.552882 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m10:57:41.553416 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m10:57:41.553856 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m10:57:41.554336 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m10:57:41.554745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m10:57:41.555198 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m10:57:41.557513 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m10:57:41.558137 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m10:57:41.559880 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m10:57:41.561208 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.574089 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.576417 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.579768 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.581695 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m10:57:41.582240 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m10:57:41.595742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.597399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98527d310>]}
[0m10:57:41.598063 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m10:57:41.598587 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m10:57:41.598967 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m10:57:41.599430 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m10:57:41.599816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m10:57:41.600142 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m10:57:41.602359 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m10:57:41.603166 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m10:57:41.605397 [debug] [Thread-1 (]: Creating new relation stg_store
[0m10:57:41.606303 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m10:57:41.617733 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.620126 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m10:57:41.623669 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.625231 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m10:57:41.625745 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m10:57:41.639149 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.640727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba70b0>]}
[0m10:57:41.641286 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m10:57:41.641806 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m10:57:41.642191 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m10:57:41.642595 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m10:57:41.643001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m10:57:41.643348 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m10:57:41.647372 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m10:57:41.648109 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m10:57:41.650274 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m10:57:41.651294 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m10:57:41.663943 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.666267 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:41.669368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.671511 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m10:57:41.672091 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m10:57:41.689551 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.691145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba5610>]}
[0m10:57:41.691640 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m10:57:41.692214 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m10:57:41.692566 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m10:57:41.692953 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m10:57:41.693342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m10:57:41.693652 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m10:57:41.697695 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m10:57:41.698359 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m10:57:41.700099 [debug] [Thread-1 (]: Creating new relation dim_film
[0m10:57:41.701031 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m10:57:41.713254 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.716045 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:41.719453 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.721903 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m10:57:41.722469 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m10:57:41.740110 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.741700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98527e150>]}
[0m10:57:41.742204 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m10:57:41.742725 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m10:57:41.743145 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m10:57:41.743654 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m10:57:41.744190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m10:57:41.744513 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m10:57:41.748455 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m10:57:41.749244 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m10:57:41.754689 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m10:57:41.755809 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m10:57:41.768318 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.770800 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:41.774130 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.776316 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m10:57:41.776903 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m10:57:41.794562 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.796125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986eb3830>]}
[0m10:57:41.796628 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m10:57:41.797251 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m10:57:41.797771 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m10:57:41.798227 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m10:57:41.798645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m10:57:41.799119 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m10:57:41.803593 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m10:57:41.804140 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m10:57:41.806425 [debug] [Thread-1 (]: Creating new relation dim_store
[0m10:57:41.807461 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m10:57:41.819251 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.821539 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:41.824956 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.827025 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m10:57:41.827590 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m10:57:41.846288 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:57:41.847837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986eb3830>]}
[0m10:57:41.848418 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m10:57:41.849025 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m10:57:41.849946 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m10:57:41.850377 [info ] [Thread-1 (]: 16 of 16 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m10:57:41.850808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m10:57:41.851286 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m10:57:41.855770 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m10:57:41.856330 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m10:57:41.857980 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m10:57:41.858908 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

-- Obtener la fecha de dim_date que corresponde con la fecha de alquiler
date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m10:57:41.871173 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:57:41.873808 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m10:57:41.877118 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:57:41.879106 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m10:57:41.879762 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `adw02_star`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

-- Obtener la fecha de dim_date que corresponde con la fecha de alquiler
date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m10:57:41.938628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:57:41.940190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f048008-9da4-4813-bda3-f638d9246f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae986ba6210>]}
[0m10:57:41.940689 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `adw02_star`.`fct_rentals` ................. [[32mOK[0m in 0.09s]
[0m10:57:41.941307 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m10:57:41.942469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:41.942756 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m10:57:41.943049 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m10:57:41.943457 [info ] [MainThread]: 
[0m10:57:41.943976 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m10:57:41.946921 [debug] [MainThread]: Command end result
[0m10:57:41.980001 [info ] [MainThread]: 
[0m10:57:41.980403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:41.980697 [info ] [MainThread]: 
[0m10:57:41.981000 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m10:57:41.981750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4145877, "process_in_blocks": "0", "process_kernel_time": 0.176176, "process_mem_max_rss": "142036", "process_out_blocks": "4992", "process_user_time": 2.315747}
[0m10:57:41.982138 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:41.982045 after 3.42 seconds
[0m10:57:41.982451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98e709130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98527fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae98527fdd0>]}
[0m10:57:41.982764 [debug] [MainThread]: Flushing usage events
[0m11:01:24.795196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e598a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3895590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3895450>]}


============================== 11:01:24.797764 | 4d3e7e21-6930-4671-94ca-0d9766647908 ==============================
[0m11:01:24.797764 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:01:24.798394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:01:24.940515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e48c9cd0>]}
[0m11:01:24.989436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3707790>]}
[0m11:01:24.989992 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:01:25.069567 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:01:25.174681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:25.175337 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m11:01:25.400670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3341850>]}
[0m11:01:25.495868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e36e9f40>]}
[0m11:01:25.496325 [info ] [MainThread]: Found 16 models, 16 data tests, 10 sources, 608 macros
[0m11:01:25.496631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3096190>]}
[0m11:01:25.498945 [info ] [MainThread]: 
[0m11:01:25.499477 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:01:25.506018 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:01:25.516248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:25.713573 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:01:25.716107 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:25.779872 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:01:25.782670 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:25.785393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m11:01:25.790917 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m11:01:25.803842 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:25.805187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m11:01:25.806752 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:01:25.818639 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:25.820085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e3113520>]}
[0m11:01:25.820548 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:01:25.820865 [info ] [MainThread]: 
[0m11:01:25.823200 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m11:01:25.823928 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m11:01:25.824470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m11:01:25.824859 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m11:01:25.831926 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m11:01:25.832788 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m11:01:25.850927 [debug] [Thread-1 (]: Creating new relation dim_date
[0m11:01:25.882477 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m11:01:25.951771 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:01:25.985979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:01:25.990828 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:25.999144 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m11:01:26.000054 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m11:01:27.556044 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.56 seconds
[0m11:01:27.573777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0f00950>]}
[0m11:01:27.574347 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.75s]
[0m11:01:27.574868 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m11:01:27.575254 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m11:01:27.575734 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m11:01:27.576144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m11:01:27.576462 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m11:01:27.578823 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m11:01:27.579499 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m11:01:27.581754 [debug] [Thread-1 (]: Creating new relation stg_address
[0m11:01:27.582901 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.594019 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.596553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.600220 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.602028 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m11:01:27.602566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m11:01:27.617817 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.619434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e1363c20>]}
[0m11:01:27.620053 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.04s]
[0m11:01:27.620600 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m11:01:27.620967 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m11:01:27.621550 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m11:01:27.621961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m11:01:27.622293 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m11:01:27.625123 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m11:01:27.625701 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m11:01:27.627733 [debug] [Thread-1 (]: Creating new relation stg_city
[0m11:01:27.628820 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m11:01:27.639951 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.642690 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.646325 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.648056 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m11:01:27.648577 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m11:01:27.662742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.664330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e373b890>]}
[0m11:01:27.664832 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m11:01:27.665371 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m11:01:27.665751 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m11:01:27.666236 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m11:01:27.666658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m11:01:27.666978 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m11:01:27.669518 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m11:01:27.670103 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m11:01:27.672531 [debug] [Thread-1 (]: Creating new relation stg_country
[0m11:01:27.673504 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m11:01:27.685306 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.687683 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.691749 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.693390 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m11:01:27.694022 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m11:01:27.709455 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.711873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0fc2250>]}
[0m11:01:27.712659 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.05s]
[0m11:01:27.713440 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m11:01:27.713989 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:01:27.714677 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m11:01:27.715271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m11:01:27.715784 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:01:27.720052 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:01:27.720824 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:01:27.723615 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:01:27.725112 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.736742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.740794 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.744431 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.747325 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:01:27.748088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m11:01:27.762565 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.764947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0eb5390>]}
[0m11:01:27.765724 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m11:01:27.766500 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:01:27.767063 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m11:01:27.767695 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m11:01:27.768424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m11:01:27.769089 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m11:01:27.773054 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m11:01:27.773848 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m11:01:27.780339 [debug] [Thread-1 (]: Creating new relation stg_film
[0m11:01:27.781985 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.795444 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.797769 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.801520 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.803611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m11:01:27.804144 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m11:01:27.821802 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:27.823403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ea35f0>]}
[0m11:01:27.823905 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.06s]
[0m11:01:27.824415 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m11:01:27.824769 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m11:01:27.825225 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m11:01:27.825597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m11:01:27.825912 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m11:01:27.828677 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m11:01:27.829260 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m11:01:27.831141 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m11:01:27.832114 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.843260 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.845914 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.849496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.851201 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m11:01:27.851711 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m11:01:27.866862 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.868526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ea31d0>]}
[0m11:01:27.869054 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m11:01:27.869549 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m11:01:27.869961 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m11:01:27.870577 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m11:01:27.871243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m11:01:27.871596 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m11:01:27.874263 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m11:01:27.874818 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m11:01:27.876968 [debug] [Thread-1 (]: Creating new relation stg_language
[0m11:01:27.878965 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m11:01:27.889520 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.891882 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.895385 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.897247 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m11:01:27.897767 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m11:01:27.910571 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.912339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e1382630>]}
[0m11:01:27.912847 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m11:01:27.913363 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m11:01:27.913750 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m11:01:27.914355 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m11:01:27.914952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m11:01:27.915326 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m11:01:27.918449 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m11:01:27.919153 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m11:01:27.921014 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m11:01:27.921981 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.932894 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.935492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.938655 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.940476 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m11:01:27.941005 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m11:01:27.965142 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:27.966791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ea3c50>]}
[0m11:01:27.967332 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m11:01:27.967848 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m11:01:27.968229 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:01:27.968696 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m11:01:27.969164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m11:01:27.969486 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:01:27.971868 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:01:27.972498 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:01:27.974405 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:01:27.975909 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m11:01:27.986742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:27.989358 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:27.993014 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:27.994909 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:01:27.995509 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m11:01:28.009622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.011340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0f792b0>]}
[0m11:01:28.011842 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m11:01:28.012526 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:01:28.012891 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:01:28.013363 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m11:01:28.013882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:01:28.014212 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:01:28.016595 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:01:28.017208 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:01:28.019709 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:01:28.020696 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m11:01:28.032508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.034826 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:01:28.038668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:28.040526 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:01:28.041126 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m11:01:28.054371 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.056009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ea1670>]}
[0m11:01:28.056526 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m11:01:28.057025 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:01:28.057403 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m11:01:28.057872 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m11:01:28.058382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m11:01:28.058715 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m11:01:28.062927 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m11:01:28.063579 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m11:01:28.066246 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m11:01:28.067373 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m11:01:28.081583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.083920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:01:28.087821 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:28.090082 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m11:01:28.090758 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m11:01:28.113777 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:28.115436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ea3cb0>]}
[0m11:01:28.115945 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m11:01:28.116451 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m11:01:28.116814 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m11:01:28.117277 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m11:01:28.117662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m11:01:28.118069 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m11:01:28.122516 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m11:01:28.123141 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m11:01:28.124970 [debug] [Thread-1 (]: Creating new relation dim_film
[0m11:01:28.126202 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m11:01:28.139636 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.142607 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:01:28.146702 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:28.150283 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m11:01:28.151186 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m11:01:28.169881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:28.172103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0f7a0f0>]}
[0m11:01:28.172611 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m11:01:28.173537 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m11:01:28.174083 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m11:01:28.174750 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m11:01:28.175357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m11:01:28.175870 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m11:01:28.180258 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m11:01:28.180942 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m11:01:28.186621 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m11:01:28.187770 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m11:01:28.199218 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.202061 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:01:28.205654 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:28.209060 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m11:01:28.209939 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m11:01:28.228565 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:28.230403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e1383650>]}
[0m11:01:28.230957 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.06s]
[0m11:01:28.231665 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m11:01:28.232106 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m11:01:28.232732 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m11:01:28.233402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m11:01:28.233742 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m11:01:28.238563 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m11:01:28.239297 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m11:01:28.241560 [debug] [Thread-1 (]: Creating new relation dim_store
[0m11:01:28.242508 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m11:01:28.255475 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:01:28.258109 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:01:28.261491 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:01:28.263743 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m11:01:28.264402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m11:01:28.283072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:01:28.285413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e1382e70>]}
[0m11:01:28.286208 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m11:01:28.286923 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m11:01:28.287821 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m11:01:28.288437 [info ] [Thread-1 (]: 16 of 16 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m11:01:28.288829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m11:01:28.289199 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m11:01:28.294269 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m11:01:28.294817 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m11:01:28.296910 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m11:01:28.297967 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    #COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m11:01:28.300857 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    #COUNT(*) OVER() AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        
[0m11:01:28.310316 [debug] [Thread-1 (]: Database Error in model fct_rentals (models/marts/fact/fct_rentals/fct_rentals.sql)
  Code: 62.
  DB::Exception: Unrecognized token: Syntax error: failed at position 1231 (#) (line 52, col 5): #COUNT(*) OVER() AS count_rentals,
      r.rental_duration
  FROM rental_data r
  JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
  JOIN `adw02_star`.... . Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb58e694ac3
  12. ? @ 0x00007fb58e726850
[0m11:01:28.310806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3e7e21-6930-4671-94ca-0d9766647908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0ff4290>]}
[0m11:01:28.311426 [error] [Thread-1 (]: 16 of 16 ERROR creating sql table model `adw02_star`.`fct_rentals` ............. [[31mERROR[0m in 0.02s]
[0m11:01:28.312091 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m11:01:28.314054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:28.314445 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m11:01:28.314795 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m11:01:28.315170 [info ] [MainThread]: 
[0m11:01:28.315492 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m11:01:28.318234 [debug] [MainThread]: Command end result
[0m11:01:28.352116 [info ] [MainThread]: 
[0m11:01:28.352499 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:28.352787 [info ] [MainThread]: 
[0m11:01:28.353242 [error] [MainThread]:   Database Error in model fct_rentals (models/marts/fact/fct_rentals/fct_rentals.sql)
  Code: 62.
  DB::Exception: Unrecognized token: Syntax error: failed at position 1231 (#) (line 52, col 5): #COUNT(*) OVER() AS count_rentals,
      r.rental_duration
  FROM rental_data r
  JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
  JOIN `adw02_star`.... . Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f2be35b
  1. DB::Exception::createDeprecated(String const&, int, bool) @ 0x000000000f38594d
  2. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x00000000153f7ad2
  3. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x000000001358a985
  4. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000013589be6
  5. DB::TCPHandler::runImpl() @ 0x00000000148e9cfe
  6. DB::TCPHandler::run() @ 0x00000000149089f9
  7. Poco::Net::TCPServerConnection::start() @ 0x000000001800e967
  8. Poco::Net::TCPServerDispatcher::run() @ 0x000000001800edb9
  9. Poco::PooledThread::run() @ 0x0000000017fda0db
  10. Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000017fd85bd
  11. ? @ 0x00007fb58e694ac3
  12. ? @ 0x00007fb58e726850
[0m11:01:28.353589 [info ] [MainThread]: 
[0m11:01:28.353927 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[0m11:01:28.354688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5993888, "process_in_blocks": "0", "process_kernel_time": 0.166848, "process_mem_max_rss": "141752", "process_out_blocks": "4984", "process_user_time": 2.472189}
[0m11:01:28.355100 [debug] [MainThread]: Command `dbt run` failed at 11:01:28.354981 after 3.60 seconds
[0m11:01:28.355486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e551a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0f79f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0f7ac90>]}
[0m11:01:28.355846 [debug] [MainThread]: Flushing usage events
[0m11:04:15.470537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8ea196120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e80b9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e80b9450>]}


============================== 11:04:15.473235 | 634df76d-60d7-44d3-a7eb-452490a194ed ==============================
[0m11:04:15.473235 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:04:15.473787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:04:15.618230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e90edcd0>]}
[0m11:04:15.667814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e7f2b790>]}
[0m11:04:15.668440 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m11:04:15.748949 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:04:15.853712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:15.854300 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m11:04:16.084288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e7b49750>]}
[0m11:04:16.179154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e7f0df40>]}
[0m11:04:16.179567 [info ] [MainThread]: Found 16 models, 16 data tests, 10 sources, 608 macros
[0m11:04:16.179908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e78d2190>]}
[0m11:04:16.182527 [info ] [MainThread]: 
[0m11:04:16.183208 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:04:16.189958 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:04:16.199721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:16.404064 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:04:16.406797 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:16.469863 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:04:16.473006 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:16.476330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m11:04:16.482419 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m11:04:16.495146 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:16.496398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m11:04:16.497894 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m11:04:16.509298 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:16.510803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e792f520>]}
[0m11:04:16.511273 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m11:04:16.511584 [info ] [MainThread]: 
[0m11:04:16.513895 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m11:04:16.514462 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m11:04:16.514997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.dim_date)
[0m11:04:16.515358 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m11:04:16.521650 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m11:04:16.522283 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m11:04:16.541461 [debug] [Thread-1 (]: Creating new relation dim_date
[0m11:04:16.573923 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m11:04:16.639078 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:04:16.653618 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:16.657311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:16.662194 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m11:04:16.662769 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m11:04:18.141891 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.48 seconds
[0m11:04:18.159460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e572c410>]}
[0m11:04:18.159999 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.64s]
[0m11:04:18.160670 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m11:04:18.161249 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m11:04:18.161661 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m11:04:18.162229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m11:04:18.162568 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m11:04:18.165010 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m11:04:18.165553 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m11:04:18.167910 [debug] [Thread-1 (]: Creating new relation stg_address
[0m11:04:18.168961 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.180498 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.184087 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.187370 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.189132 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m11:04:18.189664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m11:04:18.203744 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.205372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e5b8bc20>]}
[0m11:04:18.205875 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.04s]
[0m11:04:18.206389 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m11:04:18.206748 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m11:04:18.207211 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m11:04:18.207625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m11:04:18.208000 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m11:04:18.210766 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m11:04:18.211385 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m11:04:18.213304 [debug] [Thread-1 (]: Creating new relation stg_city
[0m11:04:18.214303 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m11:04:18.226875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.229532 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.232847 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.234564 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m11:04:18.235196 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m11:04:18.248077 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.249669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e7f5f930>]}
[0m11:04:18.250220 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m11:04:18.250750 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m11:04:18.251141 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m11:04:18.251689 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m11:04:18.252129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m11:04:18.252652 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m11:04:18.255030 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m11:04:18.255888 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m11:04:18.258241 [debug] [Thread-1 (]: Creating new relation stg_country
[0m11:04:18.259223 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m11:04:18.270711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.273057 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.276302 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.277752 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m11:04:18.278373 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m11:04:18.291170 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.292781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e57f29d0>]}
[0m11:04:18.293316 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m11:04:18.293884 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m11:04:18.294279 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m11:04:18.294741 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m11:04:18.295157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m11:04:18.295521 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m11:04:18.298360 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m11:04:18.298984 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m11:04:18.301029 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m11:04:18.302017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.318659 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.329117 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.340806 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.348560 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m11:04:18.350433 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m11:04:18.380194 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m11:04:18.382923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56dd390>]}
[0m11:04:18.383783 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.09s]
[0m11:04:18.384623 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m11:04:18.385228 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m11:04:18.385893 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m11:04:18.386554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m11:04:18.387121 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m11:04:18.390315 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m11:04:18.391270 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m11:04:18.396897 [debug] [Thread-1 (]: Creating new relation stg_film
[0m11:04:18.398178 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.410412 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.412733 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.415942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.418098 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m11:04:18.418736 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m11:04:18.435292 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.436876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56cb530>]}
[0m11:04:18.437409 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m11:04:18.437950 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m11:04:18.438350 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m11:04:18.438782 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m11:04:18.439216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m11:04:18.439570 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m11:04:18.443192 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m11:04:18.443817 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m11:04:18.445715 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m11:04:18.446682 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.464006 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.474533 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.482233 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.485735 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m11:04:18.487004 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m11:04:18.511194 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.513121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56cb230>]}
[0m11:04:18.513701 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.07s]
[0m11:04:18.514250 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m11:04:18.514676 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m11:04:18.515141 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m11:04:18.515709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m11:04:18.516091 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m11:04:18.519028 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m11:04:18.519868 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m11:04:18.521939 [debug] [Thread-1 (]: Creating new relation stg_language
[0m11:04:18.523686 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m11:04:18.537421 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.539790 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.543105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.544527 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m11:04:18.545051 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m11:04:18.557981 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.559558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e599f0b0>]}
[0m11:04:18.560070 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m11:04:18.560579 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m11:04:18.560943 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m11:04:18.561347 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m11:04:18.561917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m11:04:18.562260 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m11:04:18.565236 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m11:04:18.565796 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m11:04:18.567651 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m11:04:18.568604 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.580905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.583541 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.586748 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.588548 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m11:04:18.589098 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m11:04:18.612078 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.613632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56cb590>]}
[0m11:04:18.614153 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m11:04:18.614658 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m11:04:18.615020 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m11:04:18.615427 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m11:04:18.615840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m11:04:18.616169 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m11:04:18.618833 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m11:04:18.619520 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m11:04:18.621393 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m11:04:18.623278 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.635705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.638342 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.642018 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.644731 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m11:04:18.645386 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m11:04:18.659108 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.660709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e45a93d0>]}
[0m11:04:18.661215 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m11:04:18.661757 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m11:04:18.662125 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m11:04:18.662530 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m11:04:18.663020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m11:04:18.663534 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m11:04:18.666899 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m11:04:18.667561 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m11:04:18.670119 [debug] [Thread-1 (]: Creating new relation stg_store
[0m11:04:18.671257 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m11:04:18.688455 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.698663 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m11:04:18.710886 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.719345 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m11:04:18.721559 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m11:04:18.762398 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:04:18.764841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56cbcb0>]}
[0m11:04:18.765622 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.10s]
[0m11:04:18.766642 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m11:04:18.767351 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m11:04:18.768322 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m11:04:18.769265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m11:04:18.770125 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m11:04:18.775443 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m11:04:18.776170 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m11:04:18.778851 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m11:04:18.779924 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m11:04:18.792532 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.794921 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:18.798286 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.800470 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m11:04:18.801088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m11:04:18.819796 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.821613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56c9730>]}
[0m11:04:18.822151 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m11:04:18.822770 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m11:04:18.823302 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m11:04:18.823726 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m11:04:18.824158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m11:04:18.824598 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m11:04:18.828962 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m11:04:18.829516 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m11:04:18.831822 [debug] [Thread-1 (]: Creating new relation dim_film
[0m11:04:18.833103 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m11:04:18.846021 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.848961 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:18.852435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.854852 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m11:04:18.855493 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_has_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.original_language_id IS NOT NULL AS film_has_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m11:04:18.873670 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.875258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e45aa210>]}
[0m11:04:18.875769 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m11:04:18.876290 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m11:04:18.876666 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m11:04:18.877106 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m11:04:18.877526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m11:04:18.877849 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m11:04:18.882266 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m11:04:18.882952 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m11:04:18.888562 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m11:04:18.889685 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
          )
        
        ...
[0m11:04:18.901806 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.904363 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:18.907806 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.910058 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m11:04:18.910655 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_username", "staff_address", "staff_district", "staff_postal_code", "staff_phone_number", "staff_city", "staff_country", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.username AS staff_username,
        a.address AS staff_address,
        a.district AS staff_district,
        a.postal_code AS staff_postal_code,
        a.phone AS staff_phone_number,
        ci.city AS staff_city,
        co.country AS staff_country,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
  ...
[0m11:04:18.928453 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.930078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e599f170>]}
[0m11:04:18.930583 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m11:04:18.931220 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m11:04:18.931718 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m11:04:18.932215 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m11:04:18.932824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m11:04:18.933277 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m11:04:18.938243 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m11:04:18.938943 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m11:04:18.941379 [debug] [Thread-1 (]: Creating new relation dim_store
[0m11:04:18.942493 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m11:04:18.955994 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:18.958333 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:18.961495 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:18.963557 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m11:04:18.964127 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m11:04:18.982702 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:04:18.984244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e599f890>]}
[0m11:04:18.984733 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m11:04:18.985264 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m11:04:18.986060 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m11:04:18.986473 [info ] [Thread-1 (]: 16 of 16 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m11:04:18.986856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m11:04:18.987220 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m11:04:18.992090 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m11:04:18.992646 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m11:04:18.994356 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m11:04:18.995331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m11:04:19.008329 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:04:19.010967 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m11:04:19.014400 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:04:19.016379 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m11:04:19.017093 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `adw02_star`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m11:04:19.082513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:04:19.084077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634df76d-60d7-44d3-a7eb-452490a194ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e56cba70>]}
[0m11:04:19.084578 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `adw02_star`.`fct_rentals` ................. [[32mOK[0m in 0.10s]
[0m11:04:19.085091 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m11:04:19.086226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:19.086524 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m11:04:19.087048 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m11:04:19.087583 [info ] [MainThread]: 
[0m11:04:19.087966 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m11:04:19.091369 [debug] [MainThread]: Command end result
[0m11:04:19.127795 [info ] [MainThread]: 
[0m11:04:19.128280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:19.128591 [info ] [MainThread]: 
[0m11:04:19.129066 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m11:04:19.129792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6991456, "process_in_blocks": "0", "process_kernel_time": 0.160114, "process_mem_max_rss": "141632", "process_out_blocks": "4992", "process_user_time": 2.468597}
[0m11:04:19.130190 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:19.130089 after 3.70 seconds
[0m11:04:19.130529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e90be270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e45abef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d8e45abe90>]}
[0m11:04:19.130871 [debug] [MainThread]: Flushing usage events
[0m09:10:27.785301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782509286120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7825071a5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7825071a5450>]}


============================== 09:10:27.790033 | 66cd405b-5090-4735-8b09-fcb2e8cd4249 ==============================
[0m09:10:27.790033 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:10:27.790621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:10:27.805010 [info ] [MainThread]: dbt version: 1.8.9
[0m09:10:27.805449 [info ] [MainThread]: python version: 3.13.2
[0m09:10:27.805744 [info ] [MainThread]: python path: /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/env/bin/python
[0m09:10:27.806044 [info ] [MainThread]: os info: Linux-6.14.2-arch1-1-x86_64-with-glibc2.41
[0m09:10:27.869216 [info ] [MainThread]: Using profiles dir at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar
[0m09:10:27.869615 [info ] [MainThread]: Using profiles.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/profiles.yml
[0m09:10:27.869944 [info ] [MainThread]: Using dbt_project.yml file at /home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/dbt_project.yml
[0m09:10:27.870729 [info ] [MainThread]: adapter type: clickhouse
[0m09:10:27.871228 [info ] [MainThread]: adapter version: 1.8.9
[0m09:10:27.958164 [info ] [MainThread]: Configuration:
[0m09:10:27.958565 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:10:27.958845 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:10:27.959224 [info ] [MainThread]: Required dependencies:
[0m09:10:27.959514 [debug] [MainThread]: Executing "git --help"
[0m09:10:27.966714 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:10:27.967366 [debug] [MainThread]: STDERR: "b''"
[0m09:10:27.967653 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:10:27.968057 [info ] [MainThread]: Connection:
[0m09:10:27.968428 [info ] [MainThread]:   driver: None
[0m09:10:27.968696 [info ] [MainThread]:   host: localhost
[0m09:10:27.968962 [info ] [MainThread]:   port: 9000
[0m09:10:27.969306 [info ] [MainThread]:   user: user
[0m09:10:27.969572 [info ] [MainThread]:   schema: adw02_stag
[0m09:10:27.969840 [info ] [MainThread]:   retries: 1
[0m09:10:27.970176 [info ] [MainThread]:   database_engine: None
[0m09:10:27.970477 [info ] [MainThread]:   cluster_mode: False
[0m09:10:27.970741 [info ] [MainThread]:   secure: False
[0m09:10:27.971001 [info ] [MainThread]:   verify: True
[0m09:10:27.971320 [info ] [MainThread]:   client_cert: None
[0m09:10:27.971619 [info ] [MainThread]:   client_cert_key: None
[0m09:10:27.971884 [info ] [MainThread]:   connect_timeout: 10
[0m09:10:27.972256 [info ] [MainThread]:   send_receive_timeout: 300
[0m09:10:27.972545 [info ] [MainThread]:   sync_request_timeout: 5
[0m09:10:27.972810 [info ] [MainThread]:   compress_block_size: 1048576
[0m09:10:27.973154 [info ] [MainThread]:   compression: 
[0m09:10:27.973530 [info ] [MainThread]:   check_exchange: True
[0m09:10:27.973798 [info ] [MainThread]:   custom_settings: None
[0m09:10:27.974242 [info ] [MainThread]:   use_lw_deletes: False
[0m09:10:27.974576 [info ] [MainThread]:   allow_automatic_deduplication: False
[0m09:10:27.974862 [info ] [MainThread]:   tcp_keepalive: False
[0m09:10:27.975408 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m09:10:28.051689 [debug] [MainThread]: Acquiring new clickhouse connection 'debug'
[0m09:10:28.052050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:28.324156 [debug] [MainThread]: dbt_clickhouse adapter: On debug: select 1 as id...
[0m09:10:28.326432 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:28.350548 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:10:28.350911 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:10:28.351992 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6070994, "process_in_blocks": "61864", "process_kernel_time": 0.166145, "process_mem_max_rss": "132332", "process_out_blocks": "24", "process_user_time": 1.47756}
[0m09:10:28.352563 [debug] [MainThread]: Command `dbt debug` succeeded at 09:10:28.352421 after 0.61 seconds
[0m09:10:28.354410 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:10:28.354785 [debug] [MainThread]: On debug: Close
[0m09:10:28.355305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782506f2e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78250565d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782506ed7570>]}
[0m09:10:28.355825 [debug] [MainThread]: Flushing usage events
[0m09:10:35.791253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e879e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e66c1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e66c1450>]}


============================== 09:10:35.794179 | 5a17012b-ed5b-4c2e-b014-6e3509ac8d0b ==============================
[0m09:10:35.794179 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:10:35.794765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:10:35.955476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e76f5cd0>]}
[0m09:10:36.006121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e6533790>]}
[0m09:10:36.006787 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m09:10:36.096023 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:10:36.237478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m09:10:36.238107 [debug] [MainThread]: Partial parsing: added file: sakstar://models/marts/fact/fct_rentals/fct_rentals.yml
[0m09:10:36.238612 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_customer/dim_customer.yml
[0m09:10:36.239086 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_staff/dim_staff.yml
[0m09:10:36.239722 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_film/dim_film.yml
[0m09:10:36.240256 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_store/dim_store.yml
[0m09:10:36.240563 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_film/dim_film.sql
[0m09:10:36.240851 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_staff/dim_staff.sql
[0m09:10:36.471561 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:10:36.471984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e6149850>]}
[0m09:10:36.700503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e607fc50>]}
[0m09:10:36.842856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e5e70130>]}
[0m09:10:36.843259 [info ] [MainThread]: Found 16 models, 29 data tests, 10 sources, 608 macros
[0m09:10:36.843569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e6108460>]}
[0m09:10:36.846285 [info ] [MainThread]: 
[0m09:10:36.846955 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:10:36.853338 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:10:36.862940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:37.059326 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:10:37.062036 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:37.086352 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:10:37.089479 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:37.093045 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:10:37.096216 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:37.098173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__marts)
[0m09:10:37.098586 [debug] [ThreadPool]: Creating schema "schema: "marts"
"
[0m09:10:37.104503 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__marts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "create__marts"} */
create database if not exists `marts`
        
  
        
  ...
[0m09:10:37.109423 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:37.112149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__marts, now list__adw02_star)
[0m09:10:37.117106 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m09:10:37.129416 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:37.130688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m09:10:37.132095 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m09:10:37.143366 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:37.144842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__marts)
[0m09:10:37.146644 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__marts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'marts'
      

  ...
[0m09:10:37.158644 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:37.160092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e5f3a690>]}
[0m09:10:37.160583 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m09:10:37.160891 [info ] [MainThread]: 
[0m09:10:37.164691 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m09:10:37.165259 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m09:10:37.165676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__marts, now model.sakstar.dim_date)
[0m09:10:37.166003 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m09:10:37.171948 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m09:10:37.172534 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m09:10:37.190796 [debug] [Thread-1 (]: Creating new relation dim_date
[0m09:10:37.218385 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m09:10:38.512685 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.29 seconds
[0m09:10:38.552961 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:10:38.557004 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:38.563386 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m09:10:38.564074 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m09:10:39.775449 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.21 seconds
[0m09:10:39.793225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de300730>]}
[0m09:10:39.793798 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 2.63s]
[0m09:10:39.794459 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m09:10:39.795106 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m09:10:39.795784 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m09:10:39.796284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m09:10:39.796648 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m09:10:39.799237 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m09:10:39.799856 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m09:10:39.802215 [debug] [Thread-1 (]: Creating new relation stg_address
[0m09:10:39.803227 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m09:10:39.835547 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:10:39.840917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:39.845031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:39.848701 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m09:10:39.849802 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m09:10:39.865477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:39.867126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de323f70>]}
[0m09:10:39.867675 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.07s]
[0m09:10:39.868303 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m09:10:39.868721 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m09:10:39.869283 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m09:10:39.869750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m09:10:39.870120 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m09:10:39.873062 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m09:10:39.873770 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m09:10:39.876470 [debug] [Thread-1 (]: Creating new relation stg_city
[0m09:10:39.877710 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m09:10:39.893326 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:39.896401 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:39.900594 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:39.903389 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m09:10:39.904302 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m09:10:39.921374 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:39.924102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1dfdd6750>]}
[0m09:10:39.924999 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.05s]
[0m09:10:39.925916 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m09:10:39.926611 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m09:10:39.927420 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m09:10:39.928224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m09:10:39.928943 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m09:10:39.933273 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m09:10:39.934231 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m09:10:39.938132 [debug] [Thread-1 (]: Creating new relation stg_country
[0m09:10:39.939994 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m09:10:39.954396 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:39.958634 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:39.962168 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:39.963828 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m09:10:39.964468 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m09:10:39.977790 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:39.979362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e5fecd00>]}
[0m09:10:39.979858 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.05s]
[0m09:10:39.980368 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m09:10:39.980738 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m09:10:39.981253 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m09:10:39.981631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m09:10:39.981946 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m09:10:39.984636 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m09:10:39.985219 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m09:10:39.987052 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m09:10:39.987997 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.007281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.011899 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.015415 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.017422 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m09:10:40.018010 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m09:10:40.032725 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.034302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1dfc4a990>]}
[0m09:10:40.034802 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m09:10:40.035314 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m09:10:40.035683 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m09:10:40.036278 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m09:10:40.036662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m09:10:40.036974 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m09:10:40.039266 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m09:10:40.039824 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m09:10:40.042009 [debug] [Thread-1 (]: Creating new relation stg_film
[0m09:10:40.042993 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.058172 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.060457 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.063850 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.065929 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m09:10:40.066445 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m09:10:40.082708 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.084267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1dfc493d0>]}
[0m09:10:40.084765 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m09:10:40.085272 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m09:10:40.085635 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m09:10:40.086035 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m09:10:40.086513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m09:10:40.086862 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m09:10:40.089612 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m09:10:40.090157 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m09:10:40.092215 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m09:10:40.093322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.105374 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.108027 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.111303 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.112847 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m09:10:40.113360 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m09:10:40.128685 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.130622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1dfc482f0>]}
[0m09:10:40.131132 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m09:10:40.131745 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m09:10:40.132336 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m09:10:40.132842 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m09:10:40.133333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m09:10:40.133774 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m09:10:40.136383 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m09:10:40.137057 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m09:10:40.139275 [debug] [Thread-1 (]: Creating new relation stg_language
[0m09:10:40.140277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m09:10:40.151676 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.156036 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.159621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.161201 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m09:10:40.161831 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m09:10:40.175403 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.177019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1dfc4a1b0>]}
[0m09:10:40.177624 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m09:10:40.178266 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m09:10:40.178659 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m09:10:40.179266 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m09:10:40.179848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m09:10:40.180175 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m09:10:40.182942 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m09:10:40.183601 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m09:10:40.185548 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m09:10:40.186526 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.198840 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.201429 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.204728 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.206437 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m09:10:40.206942 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m09:10:40.234203 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:10:40.236131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de336090>]}
[0m09:10:40.236874 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.06s]
[0m09:10:40.237734 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m09:10:40.238203 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m09:10:40.238707 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m09:10:40.239176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m09:10:40.239563 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m09:10:40.242267 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m09:10:40.242942 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m09:10:40.245588 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m09:10:40.246727 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.259342 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.261833 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.265723 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.267667 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m09:10:40.268319 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m09:10:40.284608 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.286326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de334ad0>]}
[0m09:10:40.286887 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.05s]
[0m09:10:40.287602 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m09:10:40.288151 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m09:10:40.288792 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m09:10:40.289333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m09:10:40.289653 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m09:10:40.292437 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m09:10:40.293181 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m09:10:40.295014 [debug] [Thread-1 (]: Creating new relation stg_store
[0m09:10:40.295959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m09:10:40.308236 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.310827 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:10:40.313948 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.315562 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m09:10:40.316210 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m09:10:40.329496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.331033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de336990>]}
[0m09:10:40.331534 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m09:10:40.332033 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m09:10:40.332405 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m09:10:40.332852 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m09:10:40.333351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m09:10:40.333801 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m09:10:40.337935 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m09:10:40.338495 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m09:10:40.340678 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m09:10:40.341645 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m09:10:40.353854 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.356381 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:10:40.359978 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.362610 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m09:10:40.363234 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m09:10:40.383677 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.385298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de337650>]}
[0m09:10:40.385835 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.05s]
[0m09:10:40.386382 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m09:10:40.386784 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m09:10:40.387247 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m09:10:40.387691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m09:10:40.388045 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m09:10:40.391986 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m09:10:40.392756 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m09:10:40.397692 [debug] [Thread-1 (]: Creating new relation dim_film
[0m09:10:40.398900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m09:10:40.411623 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.414174 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:10:40.417593 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.419898 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m09:10:40.420694 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m09:10:40.439188 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.441176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de337dd0>]}
[0m09:10:40.441718 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m09:10:40.442272 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m09:10:40.442676 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m09:10:40.443360 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m09:10:40.443899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m09:10:40.444478 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m09:10:40.450664 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m09:10:40.451312 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m09:10:40.453383 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m09:10:40.454612 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m09:10:40.466911 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.469753 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:10:40.473349 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.475834 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m09:10:40.476434 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m09:10:40.483167 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.484804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de337a70>]}
[0m09:10:40.485353 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.04s]
[0m09:10:40.485993 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m09:10:40.486521 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m09:10:40.486948 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m09:10:40.487368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m09:10:40.487841 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m09:10:40.492517 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m09:10:40.493204 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m09:10:40.495452 [debug] [Thread-1 (]: Creating new relation dim_store
[0m09:10:40.496717 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m09:10:40.511089 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:10:40.513544 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:10:40.516826 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.518946 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m09:10:40.519762 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m09:10:40.541742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.543665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de336c90>]}
[0m09:10:40.544343 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.06s]
[0m09:10:40.545439 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m09:10:40.546264 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m09:10:40.546778 [info ] [Thread-1 (]: 16 of 16 START sql table model `marts`.`fct_rentals` ........................... [RUN]
[0m09:10:40.547222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m09:10:40.547667 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m09:10:40.552703 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m09:10:40.553349 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m09:10:40.555229 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m09:10:40.556578 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `marts`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m09:10:40.574710 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:10:40.577033 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'marts'
    
    order by position
  ...
[0m09:10:40.580293 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:10:40.582155 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m09:10:40.582768 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `marts`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m09:10:40.661088 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:10:40.662933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a17012b-ed5b-4c2e-b014-6e3509ac8d0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de337410>]}
[0m09:10:40.663515 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `marts`.`fct_rentals` ...................... [[32mOK[0m in 0.12s]
[0m09:10:40.664023 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m09:10:40.665262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:40.665678 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m09:10:40.665962 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m09:10:40.666401 [info ] [MainThread]: 
[0m09:10:40.666833 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m09:10:40.669390 [debug] [MainThread]: Command end result
[0m09:10:40.707071 [info ] [MainThread]: 
[0m09:10:40.707476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:40.707779 [info ] [MainThread]: 
[0m09:10:40.708151 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m09:10:40.708957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9592004, "process_in_blocks": "3408", "process_kernel_time": 0.189675, "process_mem_max_rss": "144084", "process_out_blocks": "5168", "process_user_time": 2.726433}
[0m09:10:40.709506 [debug] [MainThread]: Command `dbt run` succeeded at 09:10:40.709369 after 4.96 seconds
[0m09:10:40.709978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e701c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1e79f4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d1de26bd70>]}
[0m09:10:40.710482 [debug] [MainThread]: Flushing usage events
[0m09:25:14.310359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef76a6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef55b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef55b1450>]}


============================== 09:25:14.313389 | 95227803-b7e8-4c0a-92b6-a374b8e32aec ==============================
[0m09:25:14.313389 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:25:14.313860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:25:14.464041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef65e5cd0>]}
[0m09:25:14.512374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef5427680>]}
[0m09:25:14.512944 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m09:25:14.594743 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:25:14.702244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:25:14.702553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:25:14.744549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef53f9450>]}
[0m09:25:14.841491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef5405f40>]}
[0m09:25:14.841875 [info ] [MainThread]: Found 16 models, 29 data tests, 10 sources, 608 macros
[0m09:25:14.842176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef4f4c590>]}
[0m09:25:14.844442 [info ] [MainThread]: 
[0m09:25:14.845041 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:25:14.851485 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:25:14.862317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:15.083565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:25:15.086476 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.115011 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:25:15.118094 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.120605 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:25:15.123321 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.125076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__adw02_star)
[0m09:25:15.125519 [debug] [ThreadPool]: Creating schema "schema: "adw02_star"
"
[0m09:25:15.131093 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "create__adw02_star"} */
create database if not exists `adw02_star`
        
  
        
  ...
[0m09:25:15.135837 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.136880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__adw02_star, now create__marts)
[0m09:25:15.137344 [debug] [ThreadPool]: Creating schema "schema: "marts"
"
[0m09:25:15.139340 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__marts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "create__marts"} */
create database if not exists `marts`
        
  
        
  ...
[0m09:25:15.144465 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.147414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__marts, now list__adw02_star)
[0m09:25:15.152091 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m09:25:15.163688 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:15.164938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__marts)
[0m09:25:15.166423 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__marts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'marts'
      

  ...
[0m09:25:15.177482 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:15.178721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__marts, now list__adw02_stag)
[0m09:25:15.180550 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m09:25:15.191407 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:15.192888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef4ef4940>]}
[0m09:25:15.193349 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m09:25:15.193653 [info ] [MainThread]: 
[0m09:25:15.195581 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m09:25:15.196149 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m09:25:15.196604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m09:25:15.196944 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m09:25:15.202877 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m09:25:15.203516 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m09:25:15.226084 [debug] [Thread-1 (]: Creating new relation dim_date
[0m09:25:15.257086 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m09:25:15.298650 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:25:15.355963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:25:15.359810 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:15.365437 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m09:25:15.365999 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m09:25:16.258387 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.89 seconds
[0m09:25:16.276033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeef0efad0>]}
[0m09:25:16.276622 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.08s]
[0m09:25:16.277214 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m09:25:16.277630 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m09:25:16.278091 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m09:25:16.278543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m09:25:16.278866 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m09:25:16.281810 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m09:25:16.282555 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m09:25:16.284442 [debug] [Thread-1 (]: Creating new relation stg_address
[0m09:25:16.285497 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.297374 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.300066 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.303639 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.305434 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m09:25:16.305955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m09:25:16.321906 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.323638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeef16b280>]}
[0m09:25:16.324195 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.05s]
[0m09:25:16.324905 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m09:25:16.325316 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m09:25:16.325732 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m09:25:16.326233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m09:25:16.326866 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m09:25:16.329342 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m09:25:16.329924 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m09:25:16.331830 [debug] [Thread-1 (]: Creating new relation stg_city
[0m09:25:16.333320 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m09:25:16.345295 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.347831 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.351343 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.352908 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m09:25:16.353418 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m09:25:16.367203 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.368757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeee0e210>]}
[0m09:25:16.369269 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m09:25:16.369767 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m09:25:16.370195 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m09:25:16.370598 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m09:25:16.370982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m09:25:16.371368 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m09:25:16.373790 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m09:25:16.374379 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m09:25:16.376633 [debug] [Thread-1 (]: Creating new relation stg_country
[0m09:25:16.377661 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m09:25:16.389135 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.392041 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.395976 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.397461 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m09:25:16.397964 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m09:25:16.411118 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.413301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef5260ed0>]}
[0m09:25:16.413829 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m09:25:16.414345 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m09:25:16.414711 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m09:25:16.415131 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m09:25:16.415548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m09:25:16.415904 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m09:25:16.418463 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m09:25:16.419156 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m09:25:16.421118 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m09:25:16.422727 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.435454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.437774 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.440988 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.442951 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m09:25:16.443606 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m09:25:16.459493 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.461256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed1e9e0>]}
[0m09:25:16.461784 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m09:25:16.462331 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m09:25:16.462720 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m09:25:16.463207 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m09:25:16.463772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m09:25:16.464096 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m09:25:16.466638 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m09:25:16.467250 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m09:25:16.469578 [debug] [Thread-1 (]: Creating new relation stg_film
[0m09:25:16.470550 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.481956 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.484553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.488165 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.490340 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m09:25:16.490860 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m09:25:16.507974 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.509583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeedfcb90>]}
[0m09:25:16.510080 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m09:25:16.510683 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m09:25:16.511245 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m09:25:16.512003 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m09:25:16.512454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m09:25:16.512771 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m09:25:16.515126 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m09:25:16.515853 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m09:25:16.517841 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m09:25:16.519172 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.531580 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.533920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.537424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.538950 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m09:25:16.539465 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m09:25:16.554317 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.555907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed69370>]}
[0m09:25:16.556412 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.04s]
[0m09:25:16.556940 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m09:25:16.557312 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m09:25:16.557748 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m09:25:16.558221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m09:25:16.558542 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m09:25:16.560854 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m09:25:16.561398 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m09:25:16.563674 [debug] [Thread-1 (]: Creating new relation stg_language
[0m09:25:16.564638 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m09:25:16.576670 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.579025 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.582755 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.584177 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m09:25:16.584683 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m09:25:16.597807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.599702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeedffef0>]}
[0m09:25:16.600220 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m09:25:16.600773 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m09:25:16.601226 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m09:25:16.601835 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m09:25:16.602577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m09:25:16.603159 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m09:25:16.606038 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m09:25:16.606726 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m09:25:16.608984 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m09:25:16.613543 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.625526 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.628161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.631493 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.633261 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m09:25:16.633771 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m09:25:16.657009 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.658642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeedfd310>]}
[0m09:25:16.659167 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.06s]
[0m09:25:16.659686 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m09:25:16.660053 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m09:25:16.660514 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m09:25:16.660896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m09:25:16.661214 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m09:25:16.663579 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m09:25:16.664182 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m09:25:16.666486 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m09:25:16.667489 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.679763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.682058 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.685295 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.687789 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m09:25:16.688312 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m09:25:16.703021 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.704822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeedffa10>]}
[0m09:25:16.705444 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.04s]
[0m09:25:16.705943 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m09:25:16.706404 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m09:25:16.706852 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m09:25:16.707345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m09:25:16.708015 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m09:25:16.711001 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m09:25:16.711682 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m09:25:16.713847 [debug] [Thread-1 (]: Creating new relation stg_store
[0m09:25:16.715442 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m09:25:16.726748 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.729054 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:25:16.732511 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.734051 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m09:25:16.734560 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m09:25:16.748093 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.749650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef54343b0>]}
[0m09:25:16.750215 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m09:25:16.750709 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m09:25:16.751065 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m09:25:16.751475 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m09:25:16.751870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m09:25:16.752195 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m09:25:16.769091 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m09:25:16.769759 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m09:25:16.771510 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m09:25:16.772437 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m09:25:16.785533 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.788155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:25:16.791444 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.793914 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m09:25:16.794490 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m09:25:16.812447 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.814039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed69c10>]}
[0m09:25:16.814549 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m09:25:16.815050 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m09:25:16.815431 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m09:25:16.815910 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m09:25:16.816337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m09:25:16.816853 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m09:25:16.820719 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m09:25:16.821281 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m09:25:16.823483 [debug] [Thread-1 (]: Creating new relation dim_film
[0m09:25:16.824483 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m09:25:16.836486 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.838783 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:25:16.842054 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.844616 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m09:25:16.845285 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m09:25:16.863197 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.865307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeedfe5d0>]}
[0m09:25:16.865831 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m09:25:16.866344 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m09:25:16.866711 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m09:25:16.867255 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m09:25:16.867645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m09:25:16.867962 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m09:25:16.871848 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m09:25:16.872387 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m09:25:16.875010 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m09:25:16.876024 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m09:25:16.888137 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.890465 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:25:16.893838 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.895725 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m09:25:16.896273 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m09:25:16.902560 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.904096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed6b830>]}
[0m09:25:16.904620 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.04s]
[0m09:25:16.905158 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m09:25:16.905614 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m09:25:16.906137 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m09:25:16.906540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m09:25:16.906895 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m09:25:16.912037 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m09:25:16.912584 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m09:25:16.914308 [debug] [Thread-1 (]: Creating new relation dim_store
[0m09:25:16.915319 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m09:25:16.928623 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.931244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:25:16.934590 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.936638 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m09:25:16.937228 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m09:25:16.956917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:25:16.958744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed6b050>]}
[0m09:25:16.959279 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.05s]
[0m09:25:16.959813 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m09:25:16.960528 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m09:25:16.961007 [info ] [Thread-1 (]: 16 of 16 START sql table model `marts`.`fct_rentals` ........................... [RUN]
[0m09:25:16.961450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m09:25:16.961804 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m09:25:16.966170 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m09:25:16.966701 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m09:25:16.968887 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m09:25:16.970102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `marts`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m09:25:16.983055 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:25:16.985413 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'marts'
    
    order by position
  ...
[0m09:25:16.988731 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:25:16.991158 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m09:25:16.991716 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `marts`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m09:25:17.052243 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:25:17.053792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95227803-b7e8-4c0a-92b6-a374b8e32aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afeeed69190>]}
[0m09:25:17.054298 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `marts`.`fct_rentals` ...................... [[32mOK[0m in 0.09s]
[0m09:25:17.054812 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m09:25:17.055943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:17.056233 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m09:25:17.056508 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m09:25:17.056919 [info ] [MainThread]: 
[0m09:25:17.057298 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m09:25:17.059892 [debug] [MainThread]: Command end result
[0m09:25:17.096988 [info ] [MainThread]: 
[0m09:25:17.097416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:17.097731 [info ] [MainThread]: 
[0m09:25:17.098031 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m09:25:17.098718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8356624, "process_in_blocks": "0", "process_kernel_time": 0.148181, "process_mem_max_rss": "139620", "process_out_blocks": "3680", "process_user_time": 2.32654}
[0m09:25:17.099089 [debug] [MainThread]: Command `dbt run` succeeded at 09:25:17.099001 after 2.84 seconds
[0m09:25:17.099410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef73e7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef5436f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afef5437230>]}
[0m09:25:17.099719 [debug] [MainThread]: Flushing usage events
[0m09:27:28.467287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b86a8e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b849ad590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b849ad450>]}


============================== 09:27:28.470103 | 7dee3295-114b-4e09-8e12-c7ef5c6687f1 ==============================
[0m09:27:28.470103 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:27:28.475560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --debug', 'send_anonymous_usage_stats': 'True'}
[0m09:27:28.632805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b859e1cd0>]}
[0m09:27:28.683498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b84837570>]}
[0m09:27:28.684246 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m09:27:28.764664 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:27:28.873493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:28.873879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:28.915163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b847f5550>]}
[0m09:27:29.016038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b84802030>]}
[0m09:27:29.016540 [info ] [MainThread]: Found 16 models, 29 data tests, 10 sources, 608 macros
[0m09:27:29.016852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b841d0590>]}
[0m09:27:29.019786 [info ] [MainThread]: 
[0m09:27:29.020500 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:27:29.027047 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:27:29.038681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:29.252982 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:27:29.255522 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:29.278169 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:27:29.281333 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:29.284043 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:27:29.287479 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:29.290782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m09:27:29.296240 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m09:27:29.310980 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:29.312545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__marts)
[0m09:27:29.316176 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__marts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__marts"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'marts'
      

  ...
[0m09:27:29.330896 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:29.332485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__marts, now list__adw02_star)
[0m09:27:29.334879 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m09:27:29.348176 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:29.350495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b842f0940>]}
[0m09:27:29.350984 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m09:27:29.351299 [info ] [MainThread]: 
[0m09:27:29.353287 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m09:27:29.353781 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m09:27:29.354221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.dim_date)
[0m09:27:29.354635 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m09:27:29.361533 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m09:27:29.362159 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m09:27:29.418041 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m09:27:29.486713 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:27:29.522874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date__dbt_backup'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:27:29.528252 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:29.534890 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m09:27:29.535868 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date__dbt_backup`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m09:27:30.431909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.90 seconds
[0m09:27:30.436979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */
EXCHANGE TABLES `adw02_star`.`dim_date__dbt_backup` AND `adw02_star`.`dim_date` 
  
  ...
[0m09:27:30.439762 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.505988 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    drop table if exists `adw02_star`.`dim_date__dbt_backup` 
  ...
[0m09:27:30.508968 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.513050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82502f90>]}
[0m09:27:30.513819 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.16s]
[0m09:27:30.514545 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m09:27:30.514992 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m09:27:30.515567 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m09:27:30.516031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m09:27:30.516501 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m09:27:30.518902 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m09:27:30.519636 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m09:27:30.523035 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m09:27:30.540555 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.543100 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.547184 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.549302 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m09:27:30.550218 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address__dbt_backup`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m09:27:30.565941 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.567177 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */
EXCHANGE TABLES `adw02_stag`.`stg_address__dbt_backup` AND `adw02_stag`.`stg_address` 
  
  ...
[0m09:27:30.569490 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.573463 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    drop table if exists `adw02_stag`.`stg_address__dbt_backup` 
  ...
[0m09:27:30.575921 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.577578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b825835f0>]}
[0m09:27:30.578262 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.06s]
[0m09:27:30.578854 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m09:27:30.579310 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m09:27:30.579767 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m09:27:30.580238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m09:27:30.580596 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m09:27:30.582943 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m09:27:30.583632 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m09:27:30.586873 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m09:27:30.599237 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.601892 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.605903 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.608122 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m09:27:30.608767 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city__dbt_backup`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m09:27:30.624067 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.625709 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */
EXCHANGE TABLES `adw02_stag`.`stg_city__dbt_backup` AND `adw02_stag`.`stg_city` 
  
  ...
[0m09:27:30.628505 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.633020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    drop table if exists `adw02_stag`.`stg_city__dbt_backup` 
  ...
[0m09:27:30.635562 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.637293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8213edf0>]}
[0m09:27:30.637981 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.06s]
[0m09:27:30.638670 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m09:27:30.639261 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m09:27:30.640014 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m09:27:30.640613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m09:27:30.641014 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m09:27:30.643593 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m09:27:30.644150 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m09:27:30.647965 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m09:27:30.659826 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.663040 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.667703 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.669380 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m09:27:30.669996 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country__dbt_backup`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m09:27:30.684833 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.686303 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */
EXCHANGE TABLES `adw02_stag`.`stg_country__dbt_backup` AND `adw02_stag`.`stg_country` 
  
  ...
[0m09:27:30.688953 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.692506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    drop table if exists `adw02_stag`.`stg_country__dbt_backup` 
  ...
[0m09:27:30.694954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.696601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b84832950>]}
[0m09:27:30.697227 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.06s]
[0m09:27:30.697758 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m09:27:30.698185 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m09:27:30.698630 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m09:27:30.699165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m09:27:30.699564 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m09:27:30.702116 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m09:27:30.702710 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m09:27:30.705889 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m09:27:30.719681 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.722751 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.727039 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.729361 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m09:27:30.730066 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer__dbt_backup`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m09:27:30.746613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.747806 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */
EXCHANGE TABLES `adw02_stag`.`stg_customer__dbt_backup` AND `adw02_stag`.`stg_customer` 
  
  ...
[0m09:27:30.750476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.753922 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    drop table if exists `adw02_stag`.`stg_customer__dbt_backup` 
  ...
[0m09:27:30.756354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.757996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b847323c0>]}
[0m09:27:30.758671 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.06s]
[0m09:27:30.759244 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m09:27:30.759740 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m09:27:30.760227 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m09:27:30.760622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m09:27:30.760964 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m09:27:30.763262 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m09:27:30.764073 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m09:27:30.767541 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m09:27:30.781350 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.783842 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.787940 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.790399 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m09:27:30.791259 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film__dbt_backup`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m09:27:30.809472 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.810763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */
EXCHANGE TABLES `adw02_stag`.`stg_film__dbt_backup` AND `adw02_stag`.`stg_film` 
  
  ...
[0m09:27:30.813479 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.816870 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    drop table if exists `adw02_stag`.`stg_film__dbt_backup` 
  ...
[0m09:27:30.819402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.821071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82370530>]}
[0m09:27:30.821746 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.06s]
[0m09:27:30.822305 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m09:27:30.822723 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m09:27:30.823391 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m09:27:30.823805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m09:27:30.824256 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m09:27:30.827216 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m09:27:30.827799 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m09:27:30.831051 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m09:27:30.843693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.846284 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.850306 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.852047 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m09:27:30.852618 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory__dbt_backup`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m09:27:30.868440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.869587 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */
EXCHANGE TABLES `adw02_stag`.`stg_inventory__dbt_backup` AND `adw02_stag`.`stg_inventory` 
  
  ...
[0m09:27:30.871913 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.877417 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    drop table if exists `adw02_stag`.`stg_inventory__dbt_backup` 
  ...
[0m09:27:30.879397 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.880688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b84db7950>]}
[0m09:27:30.881237 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.06s]
[0m09:27:30.881738 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m09:27:30.882202 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m09:27:30.882791 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m09:27:30.883225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m09:27:30.883581 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m09:27:30.886012 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m09:27:30.886584 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m09:27:30.889890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m09:27:30.901523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.904225 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.908243 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.909959 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m09:27:30.910684 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language__dbt_backup`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m09:27:30.925253 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.926506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */
EXCHANGE TABLES `adw02_stag`.`stg_language__dbt_backup` AND `adw02_stag`.`stg_language` 
  
  ...
[0m09:27:30.928878 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.932195 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    drop table if exists `adw02_stag`.`stg_language__dbt_backup` 
  ...
[0m09:27:30.934787 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.936182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8482ff50>]}
[0m09:27:30.936751 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.05s]
[0m09:27:30.937323 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m09:27:30.937902 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m09:27:30.938628 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m09:27:30.939189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m09:27:30.939603 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m09:27:30.942418 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m09:27:30.942955 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m09:27:30.945984 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m09:27:30.957659 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:30.960511 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:30.964299 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.966455 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m09:27:30.967170 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental__dbt_backup`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m09:27:30.992093 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:30.993307 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */
EXCHANGE TABLES `adw02_stag`.`stg_rental__dbt_backup` AND `adw02_stag`.`stg_rental` 
  
  ...
[0m09:27:30.995934 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:30.999191 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    drop table if exists `adw02_stag`.`stg_rental__dbt_backup` 
  ...
[0m09:27:31.001241 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.002662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8482fcb0>]}
[0m09:27:31.003333 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.06s]
[0m09:27:31.003853 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m09:27:31.004341 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m09:27:31.004781 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m09:27:31.005276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m09:27:31.005634 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m09:27:31.008987 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m09:27:31.009827 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m09:27:31.012739 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m09:27:31.025194 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.029871 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:31.034150 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.036371 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m09:27:31.037244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff__dbt_backup`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m09:27:31.053939 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.055233 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */
EXCHANGE TABLES `adw02_stag`.`stg_staff__dbt_backup` AND `adw02_stag`.`stg_staff` 
  
  ...
[0m09:27:31.058287 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.061738 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    drop table if exists `adw02_stag`.`stg_staff__dbt_backup` 
  ...
[0m09:27:31.064519 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.066025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82181f10>]}
[0m09:27:31.066770 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.06s]
[0m09:27:31.067453 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m09:27:31.067876 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m09:27:31.068614 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m09:27:31.069067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m09:27:31.069660 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m09:27:31.073867 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m09:27:31.074580 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m09:27:31.077751 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m09:27:31.089720 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.093220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store__dbt_backup'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:27:31.097008 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.098867 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m09:27:31.099629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store__dbt_backup`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m09:27:31.115238 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.116417 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */
EXCHANGE TABLES `adw02_stag`.`stg_store__dbt_backup` AND `adw02_stag`.`stg_store` 
  
  ...
[0m09:27:31.119207 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.122492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    drop table if exists `adw02_stag`.`stg_store__dbt_backup` 
  ...
[0m09:27:31.124834 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.126732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b821823f0>]}
[0m09:27:31.127430 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.06s]
[0m09:27:31.128019 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m09:27:31.128476 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m09:27:31.128961 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m09:27:31.129408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m09:27:31.129803 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m09:27:31.144840 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m09:27:31.145570 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m09:27:31.150714 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m09:27:31.165872 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.168762 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer__dbt_backup'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:27:31.173226 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.175556 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m09:27:31.176288 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer__dbt_backup`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m09:27:31.198163 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.200677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */
EXCHANGE TABLES `adw02_star`.`dim_customer__dbt_backup` AND `adw02_star`.`dim_customer` 
  
  ...
[0m09:27:31.203889 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.211552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    drop table if exists `adw02_star`.`dim_customer__dbt_backup` 
  ...
[0m09:27:31.214370 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.217420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82183410>]}
[0m09:27:31.218717 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.09s]
[0m09:27:31.219798 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m09:27:31.220549 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m09:27:31.221248 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m09:27:31.221739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m09:27:31.222268 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m09:27:31.226631 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m09:27:31.227262 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m09:27:31.230650 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m09:27:31.249128 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.252051 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film__dbt_backup'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:27:31.256285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.258886 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m09:27:31.259592 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film__dbt_backup`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m09:27:31.278963 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.280404 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */
EXCHANGE TABLES `adw02_star`.`dim_film__dbt_backup` AND `adw02_star`.`dim_film` 
  
  ...
[0m09:27:31.282900 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.288934 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    drop table if exists `adw02_star`.`dim_film__dbt_backup` 
  ...
[0m09:27:31.317820 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:27:31.319358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b821832f0>]}
[0m09:27:31.319938 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.10s]
[0m09:27:31.320491 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m09:27:31.320924 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m09:27:31.321458 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m09:27:31.321887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m09:27:31.322329 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m09:27:31.326565 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m09:27:31.327163 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m09:27:31.330180 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m09:27:31.345721 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.348896 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff__dbt_backup'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:27:31.353161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.355770 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m09:27:31.356513 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff__dbt_backup`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m09:27:31.363918 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.365298 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */
EXCHANGE TABLES `adw02_star`.`dim_staff__dbt_backup` AND `adw02_star`.`dim_staff` 
  
  ...
[0m09:27:31.367803 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.371043 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    drop table if exists `adw02_star`.`dim_staff__dbt_backup` 
  ...
[0m09:27:31.373272 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.374743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82182990>]}
[0m09:27:31.375478 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m09:27:31.376054 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m09:27:31.376609 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m09:27:31.377064 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m09:27:31.377600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m09:27:31.378047 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m09:27:31.383125 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m09:27:31.383825 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m09:27:31.386770 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m09:27:31.400098 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.403244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store__dbt_backup'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:27:31.407390 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.409569 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m09:27:31.410207 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store__dbt_backup`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m09:27:31.430169 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:27:31.431419 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */
EXCHANGE TABLES `adw02_star`.`dim_store__dbt_backup` AND `adw02_star`.`dim_store` 
  
  ...
[0m09:27:31.434088 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.437120 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    drop table if exists `adw02_star`.`dim_store__dbt_backup` 
  ...
[0m09:27:31.439393 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.440760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82183e30>]}
[0m09:27:31.441300 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.06s]
[0m09:27:31.441801 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m09:27:31.442558 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m09:27:31.443002 [info ] [Thread-1 (]: 16 of 16 START sql table model `marts`.`fct_rentals` ........................... [RUN]
[0m09:27:31.443382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m09:27:31.443729 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m09:27:31.448521 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m09:27:31.449105 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m09:27:31.451945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `marts`.`fct_rentals__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m09:27:31.464102 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:27:31.467245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals__dbt_backup'
    
      and database = 'marts'
    
    order by position
  ...
[0m09:27:31.471245 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.473574 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m09:27:31.474507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `marts`.`fct_rentals__dbt_backup`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m09:27:31.557807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:27:31.558972 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */
EXCHANGE TABLES `marts`.`fct_rentals__dbt_backup` AND `marts`.`fct_rentals` 
  
  ...
[0m09:27:31.561551 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.564721 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    drop table if exists `marts`.`fct_rentals__dbt_backup` 
  ...
[0m09:27:31.567050 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:27:31.568475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dee3295-114b-4e09-8e12-c7ef5c6687f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b82182870>]}
[0m09:27:31.569031 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `marts`.`fct_rentals` ...................... [[32mOK[0m in 0.13s]
[0m09:27:31.569726 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m09:27:31.571061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:31.571542 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m09:27:31.571866 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m09:27:31.572566 [info ] [MainThread]: 
[0m09:27:31.573193 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m09:27:31.575767 [debug] [MainThread]: Command end result
[0m09:27:31.615445 [info ] [MainThread]: 
[0m09:27:31.615924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:31.616315 [info ] [MainThread]: 
[0m09:27:31.616782 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m09:27:31.617954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1900554, "process_in_blocks": "0", "process_kernel_time": 0.171019, "process_mem_max_rss": "140316", "process_out_blocks": "3696", "process_user_time": 2.464604}
[0m09:27:31.618682 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:31.618539 after 3.19 seconds
[0m09:27:31.619083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b859b1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8069b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b8069bd10>]}
[0m09:27:31.619479 [debug] [MainThread]: Flushing usage events
[0m09:30:31.308019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661f196120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661d0b9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661d0b9450>]}


============================== 09:30:31.310806 | 797fc68d-5be5-48d7-ba53-72cbc06812d2 ==============================
[0m09:30:31.310806 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:30:31.316462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:31.460400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661e0edcd0>]}
[0m09:30:31.511194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661cf2b790>]}
[0m09:30:31.511952 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m09:30:31.593660 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:30:31.702832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:30:31.703608 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.yml
[0m09:30:31.916192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:30:31.916627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661cb2e150>]}
[0m09:30:32.096934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661c897020>]}
[0m09:30:32.248058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661cedef90>]}
[0m09:30:32.248549 [info ] [MainThread]: Found 16 models, 29 data tests, 10 sources, 608 macros
[0m09:30:32.248852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661cb786d0>]}
[0m09:30:32.251097 [info ] [MainThread]: 
[0m09:30:32.251633 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:30:32.257930 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:30:32.267684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:32.475551 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:30:32.478291 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:32.500005 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:30:32.502697 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:32.504530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__adw02_star)
[0m09:30:32.504928 [debug] [ThreadPool]: Creating schema "schema: "adw02_star"
"
[0m09:30:32.513285 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "create__adw02_star"} */
create database if not exists `adw02_star`
        
  
        
  ...
[0m09:30:32.519035 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:32.521688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__adw02_star, now list__adw02_stag)
[0m09:30:32.526553 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m09:30:32.540116 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:32.541390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m09:30:32.542882 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m09:30:32.553797 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:32.555152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661c6e2c90>]}
[0m09:30:32.555634 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m09:30:32.555946 [info ] [MainThread]: 
[0m09:30:32.558783 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m09:30:32.559378 [info ] [Thread-1 (]: 1 of 16 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m09:30:32.559872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.dim_date)
[0m09:30:32.560411 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m09:30:32.566039 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m09:30:32.566686 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m09:30:32.584852 [debug] [Thread-1 (]: Creating new relation dim_date
[0m09:30:32.612344 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m09:30:32.656711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:30:32.696048 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:32.700226 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:32.706223 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m09:30:32.706973 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m09:30:33.573315 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.87 seconds
[0m09:30:33.591115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618d9c7e0>]}
[0m09:30:33.591683 [info ] [Thread-1 (]: 1 of 16 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 1.03s]
[0m09:30:33.592210 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m09:30:33.592586 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m09:30:33.592996 [info ] [Thread-1 (]: 2 of 16 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m09:30:33.593385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m09:30:33.593705 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m09:30:33.595974 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m09:30:33.596634 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m09:30:33.598981 [debug] [Thread-1 (]: Creating new relation stg_address
[0m09:30:33.600109 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m09:30:33.613533 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.615955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.619400 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.621611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m09:30:33.622131 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m09:30:33.637280 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.638874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618da6530>]}
[0m09:30:33.639391 [info ] [Thread-1 (]: 2 of 16 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.05s]
[0m09:30:33.639900 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m09:30:33.640348 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m09:30:33.640794 [info ] [Thread-1 (]: 3 of 16 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m09:30:33.641274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_city)
[0m09:30:33.641592 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m09:30:33.644058 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m09:30:33.644770 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m09:30:33.646659 [debug] [Thread-1 (]: Creating new relation stg_city
[0m09:30:33.647946 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m09:30:33.659291 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.661648 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.665064 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.666753 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m09:30:33.667281 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m09:30:33.680688 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.682264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a872350>]}
[0m09:30:33.682764 [info ] [Thread-1 (]: 3 of 16 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.04s]
[0m09:30:33.683261 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m09:30:33.683610 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m09:30:33.684026 [info ] [Thread-1 (]: 4 of 16 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m09:30:33.684506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m09:30:33.684839 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m09:30:33.687886 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m09:30:33.688495 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m09:30:33.690906 [debug] [Thread-1 (]: Creating new relation stg_country
[0m09:30:33.691886 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m09:30:33.704238 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.706852 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.710663 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.712592 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m09:30:33.713102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m09:30:33.726221 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.727784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661c91a350>]}
[0m09:30:33.728297 [info ] [Thread-1 (]: 4 of 16 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.04s]
[0m09:30:33.728807 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m09:30:33.729230 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m09:30:33.729868 [info ] [Thread-1 (]: 5 of 16 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m09:30:33.730414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m09:30:33.730866 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m09:30:33.733490 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m09:30:33.734136 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m09:30:33.736130 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m09:30:33.737652 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m09:30:33.768601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:30:33.778438 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.791093 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.799580 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m09:30:33.801889 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m09:30:33.856866 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:30:33.861121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e08bf0>]}
[0m09:30:33.862257 [info ] [Thread-1 (]: 5 of 16 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.13s]
[0m09:30:33.863403 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m09:30:33.864230 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m09:30:33.865129 [info ] [Thread-1 (]: 6 of 16 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m09:30:33.865885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m09:30:33.866522 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m09:30:33.870604 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m09:30:33.871680 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m09:30:33.875231 [debug] [Thread-1 (]: Creating new relation stg_film
[0m09:30:33.876489 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m09:30:33.889305 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.891926 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.895525 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.897856 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m09:30:33.898408 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m09:30:33.914610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:30:33.916192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a6bd5b0>]}
[0m09:30:33.916696 [info ] [Thread-1 (]: 6 of 16 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.05s]
[0m09:30:33.917308 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m09:30:33.917683 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m09:30:33.918084 [info ] [Thread-1 (]: 7 of 16 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m09:30:33.918510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_inventory)
[0m09:30:33.918930 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m09:30:33.921476 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m09:30:33.922044 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m09:30:33.924055 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m09:30:33.927614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m09:30:33.938698 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.941026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.944611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.946304 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m09:30:33.946846 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m09:30:33.962189 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.963886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a6bfcb0>]}
[0m09:30:33.964402 [info ] [Thread-1 (]: 7 of 16 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.05s]
[0m09:30:33.964914 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m09:30:33.965286 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m09:30:33.965695 [info ] [Thread-1 (]: 8 of 16 START sql table model `adw02_stag`.`stg_language` ...................... [RUN]
[0m09:30:33.966086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m09:30:33.966546 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m09:30:33.968980 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m09:30:33.969585 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m09:30:33.972028 [debug] [Thread-1 (]: Creating new relation stg_language
[0m09:30:33.973098 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m09:30:33.984852 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:33.987165 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:33.990343 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:33.992123 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m09:30:33.992675 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m09:30:34.006717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.008408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a6be450>]}
[0m09:30:34.008927 [info ] [Thread-1 (]: 8 of 16 OK created sql table model `adw02_stag`.`stg_language` ................. [[32mOK[0m in 0.04s]
[0m09:30:34.009560 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m09:30:34.009981 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m09:30:34.010688 [info ] [Thread-1 (]: 9 of 16 START sql table model `adw02_stag`.`stg_rental` ........................ [RUN]
[0m09:30:34.011106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m09:30:34.011933 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m09:30:34.014825 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m09:30:34.015513 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m09:30:34.017557 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m09:30:34.018964 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m09:30:34.030580 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.033253 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:34.036773 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.038554 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m09:30:34.039089 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m09:30:34.064234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:30:34.066046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a7f7dd0>]}
[0m09:30:34.066732 [info ] [Thread-1 (]: 9 of 16 OK created sql table model `adw02_stag`.`stg_rental` ................... [[32mOK[0m in 0.05s]
[0m09:30:34.067489 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m09:30:34.067887 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m09:30:34.068501 [info ] [Thread-1 (]: 10 of 16 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m09:30:34.068945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m09:30:34.069523 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m09:30:34.072523 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m09:30:34.073105 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m09:30:34.075996 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m09:30:34.077270 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m09:30:34.088776 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.091473 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:34.094975 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.097448 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m09:30:34.097989 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m09:30:34.113133 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.114752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661a6bf230>]}
[0m09:30:34.115278 [info ] [Thread-1 (]: 10 of 16 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.05s]
[0m09:30:34.115823 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m09:30:34.116205 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m09:30:34.116773 [info ] [Thread-1 (]: 11 of 16 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m09:30:34.117307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m09:30:34.117780 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m09:30:34.120615 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m09:30:34.121200 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m09:30:34.123096 [debug] [Thread-1 (]: Creating new relation stg_store
[0m09:30:34.124673 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m09:30:34.136600 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.138975 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m09:30:34.142927 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.144589 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m09:30:34.145123 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m09:30:34.159577 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.161233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e08f50>]}
[0m09:30:34.161749 [info ] [Thread-1 (]: 11 of 16 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.04s]
[0m09:30:34.162335 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m09:30:34.162705 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m09:30:34.163122 [info ] [Thread-1 (]: 12 of 16 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m09:30:34.163643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m09:30:34.163978 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m09:30:34.168938 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m09:30:34.169776 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m09:30:34.171819 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m09:30:34.172827 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m09:30:34.187391 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.190057 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:34.194182 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.196546 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m09:30:34.197158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m09:30:34.220543 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:30:34.222435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e093d0>]}
[0m09:30:34.222999 [info ] [Thread-1 (]: 12 of 16 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.06s]
[0m09:30:34.223578 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m09:30:34.224006 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m09:30:34.224672 [info ] [Thread-1 (]: 13 of 16 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m09:30:34.225231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m09:30:34.225649 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m09:30:34.230270 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m09:30:34.230848 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m09:30:34.233351 [debug] [Thread-1 (]: Creating new relation dim_film
[0m09:30:34.234369 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m09:30:34.246706 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.249232 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:34.252752 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.255133 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m09:30:34.255750 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m09:30:34.273311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:30:34.275023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e0a6f0>]}
[0m09:30:34.275613 [info ] [Thread-1 (]: 13 of 16 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.05s]
[0m09:30:34.276220 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m09:30:34.276720 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m09:30:34.277152 [info ] [Thread-1 (]: 14 of 16 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m09:30:34.277596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m09:30:34.278033 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m09:30:34.283032 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m09:30:34.283655 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m09:30:34.285718 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m09:30:34.286895 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m09:30:34.298047 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.300814 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:34.304284 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.306419 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m09:30:34.307025 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m09:30:34.314208 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.315903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e0ab70>]}
[0m09:30:34.316463 [info ] [Thread-1 (]: 14 of 16 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.04s]
[0m09:30:34.316988 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m09:30:34.317371 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m09:30:34.317828 [info ] [Thread-1 (]: 15 of 16 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m09:30:34.318282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m09:30:34.318617 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m09:30:34.326393 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m09:30:34.326942 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m09:30:34.328932 [debug] [Thread-1 (]: Creating new relation dim_store
[0m09:30:34.330047 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m09:30:34.344431 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.347244 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:34.351265 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.353547 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m09:30:34.354166 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m09:30:34.377347 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:30:34.379215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e0b410>]}
[0m09:30:34.379893 [info ] [Thread-1 (]: 15 of 16 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.06s]
[0m09:30:34.380597 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m09:30:34.381402 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m09:30:34.382156 [info ] [Thread-1 (]: 16 of 16 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m09:30:34.382583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m09:30:34.382912 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m09:30:34.387702 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m09:30:34.388271 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m09:30:34.391366 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m09:30:34.392523 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m09:30:34.404495 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:30:34.407053 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m09:30:34.411111 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:30:34.413091 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m09:30:34.413692 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `adw02_star`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m09:30:34.495760 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:30:34.497420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797fc68d-5be5-48d7-ba53-72cbc06812d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618e08d70>]}
[0m09:30:34.497955 [info ] [Thread-1 (]: 16 of 16 OK created sql table model `adw02_star`.`fct_rentals` ................. [[32mOK[0m in 0.11s]
[0m09:30:34.498507 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m09:30:34.499827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:34.500299 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m09:30:34.500664 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m09:30:34.501243 [info ] [MainThread]: 
[0m09:30:34.501937 [info ] [MainThread]: Finished running 16 table models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m09:30:34.504856 [debug] [MainThread]: Command end result
[0m09:30:34.548292 [info ] [MainThread]: 
[0m09:30:34.548705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:34.549028 [info ] [MainThread]: 
[0m09:30:34.549491 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m09:30:34.550542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2838306, "process_in_blocks": "0", "process_kernel_time": 0.176097, "process_mem_max_rss": "143708", "process_out_blocks": "5184", "process_user_time": 2.694539}
[0m09:30:34.550961 [debug] [MainThread]: Command `dbt run` succeeded at 09:30:34.550857 after 3.28 seconds
[0m09:30:34.551392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77661e109130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618cdbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776618cdbad0>]}
[0m09:30:34.551794 [debug] [MainThread]: Flushing usage events
[0m13:08:57.902589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f9a92120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f79b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f79b1450>]}


============================== 13:08:57.906657 | 951f9b0a-e1bc-467c-89f6-0fb431d5b425 ==============================
[0m13:08:57.906657 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:08:57.912007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:58.138172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '951f9b0a-e1bc-467c-89f6-0fb431d5b425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f89e5cd0>]}
[0m13:08:58.220059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '951f9b0a-e1bc-467c-89f6-0fb431d5b425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f7823790>]}
[0m13:08:58.221013 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:08:58.347501 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:08:58.512383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m13:08:58.513193 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_category.sql
[0m13:08:58.513719 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_film_category.sql
[0m13:08:58.514529 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.yml
[0m13:08:58.515161 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_staff/dim_staff.sql
[0m13:08:58.515696 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m13:08:58.866918 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:08:58.867536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '951f9b0a-e1bc-467c-89f6-0fb431d5b425', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f745e850>]}
[0m13:08:59.080197 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sakstar.stg_category' (models/staging/stg_category.sql) depends on a source named 'sakila_proxy.category' which was not found
[0m13:08:59.081299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2414323, "process_in_blocks": "256", "process_kernel_time": 0.16874, "process_mem_max_rss": "110808", "process_out_blocks": "16", "process_user_time": 2.73363}
[0m13:08:59.081913 [debug] [MainThread]: Command `dbt run` failed at 13:08:59.081767 after 1.24 seconds
[0m13:08:59.082460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f71735c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f58e8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f79f7e70>]}
[0m13:08:59.082981 [debug] [MainThread]: Flushing usage events
[0m13:11:42.842096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4e692120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4c5b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4c5b1450>]}


============================== 13:11:42.845971 | 7e276b0f-79cf-4743-8bf3-17ec83af9526 ==============================
[0m13:11:42.845971 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:11:42.846565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:11:43.091114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4d5e5cd0>]}
[0m13:11:43.187006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4c423790>]}
[0m13:11:43.187621 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:11:43.334836 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:11:43.510173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 4 files changed.
[0m13:11:43.510872 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_film_category.sql
[0m13:11:43.511263 [debug] [MainThread]: Partial parsing: added file: sakstar://models/staging/stg_category.sql
[0m13:11:43.511894 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.yml
[0m13:11:43.513278 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/staging/staging_sources.yml
[0m13:11:43.513687 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_staff/dim_staff.sql
[0m13:11:43.514098 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m13:11:43.948336 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:11:43.948992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4c05c850>]}
[0m13:11:44.551013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4bd928a0>]}
[0m13:11:44.759417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4bd757f0>]}
[0m13:11:44.760064 [info ] [MainThread]: Found 18 models, 30 data tests, 12 sources, 608 macros
[0m13:11:44.760550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4bef54a0>]}
[0m13:11:44.763801 [info ] [MainThread]: 
[0m13:11:44.764611 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:11:44.778249 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:11:44.801550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:45.157643 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:11:45.160944 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:45.203046 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:11:45.207860 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:45.212361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_star)
[0m13:11:45.219697 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m13:11:45.247721 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:45.250122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_star, now list__adw02_stag)
[0m13:11:45.252740 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m13:11:45.267576 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:45.269141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4bf9a150>]}
[0m13:11:45.269650 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m13:11:45.270014 [info ] [MainThread]: 
[0m13:11:45.272385 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m13:11:45.273329 [info ] [Thread-1 (]: 1 of 18 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m13:11:45.273985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_stag, now model.sakstar.dim_date)
[0m13:11:45.274351 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m13:11:45.297309 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m13:11:45.298384 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m13:11:45.338281 [debug] [Thread-1 (]: Creating new relation dim_date
[0m13:11:45.399857 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m13:11:46.503314 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.10 seconds
[0m13:11:46.538687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:46.543073 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:46.548797 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m13:11:46.549507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m13:11:47.925117 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 1.37 seconds
[0m13:11:47.950497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea482acb50>]}
[0m13:11:47.952785 [info ] [Thread-1 (]: 1 of 18 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 2.68s]
[0m13:11:47.956259 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m13:11:47.959399 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m13:11:47.963278 [info ] [Thread-1 (]: 2 of 18 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m13:11:47.964978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m13:11:47.966257 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m13:11:47.972199 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m13:11:47.973280 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m13:11:47.977252 [debug] [Thread-1 (]: Creating new relation stg_address
[0m13:11:47.979311 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.003340 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.010278 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.016518 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.019416 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m13:11:48.020568 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m13:11:48.052303 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.059146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea482c58b0>]}
[0m13:11:48.061188 [info ] [Thread-1 (]: 2 of 18 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.09s]
[0m13:11:48.063326 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m13:11:48.065018 [debug] [Thread-1 (]: Began running node model.sakstar.stg_category
[0m13:11:48.067033 [info ] [Thread-1 (]: 3 of 18 START sql table model `adw02_stag`.`stg_category` ...................... [RUN]
[0m13:11:48.068731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_category)
[0m13:11:48.070153 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_category
[0m13:11:48.083775 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_category"
[0m13:11:48.089994 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_category
[0m13:11:48.092678 [debug] [Thread-1 (]: Creating new relation stg_category
[0m13:11:48.094220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

            

    
        create table `adw02_stag`.`stg_category`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`category`
)
SELECT
    category_id,
    name
FROM source
          )
        
        ...
[0m13:11:48.107281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.110696 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

    select name, type from system.columns where table = 'stg_category'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.115086 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.117092 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_category"
[0m13:11:48.117828 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_category`
        ("category_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`category`
)
SELECT
    category_id,
    name
FROM source
  ...
[0m13:11:48.134879 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.136903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4838db50>]}
[0m13:11:48.137574 [info ] [Thread-1 (]: 3 of 18 OK created sql table model `adw02_stag`.`stg_category` ................. [[32mOK[0m in 0.07s]
[0m13:11:48.138256 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_category
[0m13:11:48.138744 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m13:11:48.139274 [info ] [Thread-1 (]: 4 of 18 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m13:11:48.139785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_category, now model.sakstar.stg_city)
[0m13:11:48.140207 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m13:11:48.143353 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m13:11:48.144064 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m13:11:48.146932 [debug] [Thread-1 (]: Creating new relation stg_city
[0m13:11:48.148197 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m13:11:48.165410 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.173688 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.186113 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.191488 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m13:11:48.193338 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m13:11:48.223128 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.225027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4c445b70>]}
[0m13:11:48.225633 [info ] [Thread-1 (]: 4 of 18 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.09s]
[0m13:11:48.226161 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m13:11:48.226565 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m13:11:48.227080 [info ] [Thread-1 (]: 5 of 18 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m13:11:48.227524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m13:11:48.227874 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m13:11:48.236268 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m13:11:48.238625 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m13:11:48.245888 [debug] [Thread-1 (]: Creating new relation stg_country
[0m13:11:48.248407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m13:11:48.264979 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.268269 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.272533 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.274205 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m13:11:48.274824 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m13:11:48.308193 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.310686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829e030>]}
[0m13:11:48.311390 [info ] [Thread-1 (]: 5 of 18 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.08s]
[0m13:11:48.312114 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m13:11:48.312641 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m13:11:48.313290 [info ] [Thread-1 (]: 6 of 18 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m13:11:48.313858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m13:11:48.314368 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m13:11:48.317362 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m13:11:48.318081 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m13:11:48.320285 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m13:11:48.321938 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.335300 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.338141 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.342248 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.344571 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m13:11:48.345203 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m13:11:48.363246 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.365206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829eab0>]}
[0m13:11:48.365831 [info ] [Thread-1 (]: 6 of 18 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.05s]
[0m13:11:48.366463 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m13:11:48.366919 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m13:11:48.367597 [info ] [Thread-1 (]: 7 of 18 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m13:11:48.368102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m13:11:48.368712 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m13:11:48.372183 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m13:11:48.372871 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m13:11:48.375118 [debug] [Thread-1 (]: Creating new relation stg_film
[0m13:11:48.376276 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.389771 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.392928 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.397122 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.399770 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m13:11:48.400487 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m13:11:48.421290 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.423270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829e3f0>]}
[0m13:11:48.423904 [info ] [Thread-1 (]: 7 of 18 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.06s]
[0m13:11:48.424570 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m13:11:48.425017 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film_category
[0m13:11:48.425530 [info ] [Thread-1 (]: 8 of 18 START sql table model `adw02_stag`.`stg_film_category` ................. [RUN]
[0m13:11:48.426080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_film_category)
[0m13:11:48.426546 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film_category
[0m13:11:48.429382 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film_category"
[0m13:11:48.430021 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film_category
[0m13:11:48.432567 [debug] [Thread-1 (]: Creating new relation stg_film_category
[0m13:11:48.434245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

            

    
        create table `adw02_stag`.`stg_film_category`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film_category`
)
SELECT
    film_id,
    category_id
FROM source
          )
        
        ...
[0m13:11:48.447099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.450241 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

    select name, type from system.columns where table = 'stg_film_category'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.454396 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.456180 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film_category"
[0m13:11:48.456796 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film_category`
        ("film_id", "category_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film_category`
)
SELECT
    film_id,
    category_id
FROM source
  ...
[0m13:11:48.472511 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.474429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829f950>]}
[0m13:11:48.475059 [info ] [Thread-1 (]: 8 of 18 OK created sql table model `adw02_stag`.`stg_film_category` ............ [[32mOK[0m in 0.05s]
[0m13:11:48.475776 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film_category
[0m13:11:48.476229 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m13:11:48.476746 [info ] [Thread-1 (]: 9 of 18 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m13:11:48.477296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film_category, now model.sakstar.stg_inventory)
[0m13:11:48.477976 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m13:11:48.480869 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m13:11:48.481576 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m13:11:48.484331 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m13:11:48.485544 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.498828 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.502964 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.507826 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.510052 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m13:11:48.510801 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m13:11:48.531454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.533237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829f230>]}
[0m13:11:48.533802 [info ] [Thread-1 (]: 9 of 18 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.06s]
[0m13:11:48.534485 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m13:11:48.535049 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m13:11:48.535572 [info ] [Thread-1 (]: 10 of 18 START sql table model `adw02_stag`.`stg_language` ..................... [RUN]
[0m13:11:48.536009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m13:11:48.536562 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m13:11:48.545070 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m13:11:48.547364 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m13:11:48.555516 [debug] [Thread-1 (]: Creating new relation stg_language
[0m13:11:48.559034 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m13:11:48.575622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.580657 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.587217 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.590175 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m13:11:48.591258 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m13:11:48.617354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.620480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea481ac950>]}
[0m13:11:48.621507 [info ] [Thread-1 (]: 10 of 18 OK created sql table model `adw02_stag`.`stg_language` ................ [[32mOK[0m in 0.08s]
[0m13:11:48.622689 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m13:11:48.623443 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m13:11:48.624487 [info ] [Thread-1 (]: 11 of 18 START sql table model `adw02_stag`.`stg_rental` ....................... [RUN]
[0m13:11:48.625524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m13:11:48.626577 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m13:11:48.631529 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m13:11:48.632539 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m13:11:48.641487 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m13:11:48.642871 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.654936 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.657805 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.662152 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.664370 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m13:11:48.665023 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m13:11:48.695323 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.697313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829f230>]}
[0m13:11:48.697953 [info ] [Thread-1 (]: 11 of 18 OK created sql table model `adw02_stag`.`stg_rental` .................. [[32mOK[0m in 0.07s]
[0m13:11:48.698676 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m13:11:48.699127 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m13:11:48.699754 [info ] [Thread-1 (]: 12 of 18 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m13:11:48.700278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m13:11:48.700702 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m13:11:48.703704 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m13:11:48.704353 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m13:11:48.706574 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m13:11:48.708300 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.721576 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.724512 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.729105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.733227 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m13:11:48.734014 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m13:11:48.752761 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.754847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829ee10>]}
[0m13:11:48.755506 [info ] [Thread-1 (]: 12 of 18 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.05s]
[0m13:11:48.756302 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m13:11:48.756954 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m13:11:48.757492 [info ] [Thread-1 (]: 13 of 18 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m13:11:48.758144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m13:11:48.758778 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m13:11:48.761897 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m13:11:48.762566 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m13:11:48.765724 [debug] [Thread-1 (]: Creating new relation stg_store
[0m13:11:48.767042 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m13:11:48.780242 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.783137 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:11:48.787360 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:48.789729 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m13:11:48.790381 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m13:11:48.807271 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:48.809300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829f3b0>]}
[0m13:11:48.809972 [info ] [Thread-1 (]: 13 of 18 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.05s]
[0m13:11:48.810773 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m13:11:48.811509 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m13:11:48.812240 [info ] [Thread-1 (]: 14 of 18 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m13:11:48.812829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m13:11:48.813453 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m13:11:48.818850 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m13:11:48.819579 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m13:11:48.822845 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m13:11:48.824221 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m13:11:48.851185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.859875 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:48.871705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:48.879501 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m13:11:48.881254 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m13:11:48.930436 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m13:11:48.932838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea48369370>]}
[0m13:11:48.933595 [info ] [Thread-1 (]: 14 of 18 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.12s]
[0m13:11:48.934417 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m13:11:48.935035 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m13:11:48.935634 [info ] [Thread-1 (]: 15 of 18 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m13:11:48.936112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m13:11:48.936520 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m13:11:48.941696 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m13:11:48.942386 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m13:11:48.944431 [debug] [Thread-1 (]: Creating new relation dim_film
[0m13:11:48.945600 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m13:11:48.977605 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:48.982224 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:48.990279 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:49.001587 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m13:11:49.003187 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(film_release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m13:11:49.042339 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m13:11:49.049783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4836b5f0>]}
[0m13:11:49.051558 [info ] [Thread-1 (]: 15 of 18 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.11s]
[0m13:11:49.053276 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m13:11:49.054552 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m13:11:49.056088 [info ] [Thread-1 (]: 16 of 18 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m13:11:49.057064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m13:11:49.057911 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m13:11:49.065326 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m13:11:49.066391 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m13:11:49.069730 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m13:11:49.071020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS staff_store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m13:11:49.092546 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:49.098614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:49.106105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:49.109754 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m13:11:49.110702 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS staff_store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m13:11:49.120920 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:49.123033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829e270>]}
[0m13:11:49.123662 [info ] [Thread-1 (]: 16 of 18 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.07s]
[0m13:11:49.124438 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m13:11:49.125076 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m13:11:49.125640 [info ] [Thread-1 (]: 17 of 18 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m13:11:49.126984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m13:11:49.127808 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m13:11:49.132976 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m13:11:49.133614 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m13:11:49.135721 [debug] [Thread-1 (]: Creating new relation dim_store
[0m13:11:49.137123 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m13:11:49.165729 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:11:49.169545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:49.174796 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:11:49.178561 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m13:11:49.179440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m13:11:49.224386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m13:11:49.226897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea481ad4f0>]}
[0m13:11:49.227829 [info ] [Thread-1 (]: 17 of 18 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.10s]
[0m13:11:49.228877 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m13:11:49.230149 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m13:11:49.230766 [info ] [Thread-1 (]: 18 of 18 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m13:11:49.231675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m13:11:49.232543 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m13:11:49.239774 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m13:11:49.240407 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m13:11:49.242492 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m13:11:49.243636 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
    
    
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
),

film_category_info AS (
    SELECT
        fc.film_id,
        c.category_id,
        c.name as category_name
    FROM `adw02_stag`.`stg_film_category` fc
    JOIN `adw02_stag`.`stg_category` c ON fc.category_id = c.category_id
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    r.rental_date,
    fc.category_name,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
LEFT JOIN film_category_info fc ON r.film_id = fc.film_id
          )
        
        ...
[0m13:11:49.268477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:11:49.280232 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:11:49.286646 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:11:49.291220 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m13:11:49.293069 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `adw02_star`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "rental_date", "category_name", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
    
    
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
),

film_category_info AS (
    SELECT
        fc.film_id,
        c.category_id,
        c.name as category_name
    FROM `adw02_stag`.`stg_film_category` fc
    JOIN `adw02_stag`.`stg_category` c ON fc.category_id = c.category_id
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    r.rental_date,
    fc.category_name,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
LEFT JOIN film_category_info fc ON r.film_id = fc.film_id
  ...
[0m13:11:49.475535 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.18 seconds
[0m13:11:49.477329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e276b0f-79cf-4743-8bf3-17ec83af9526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4829c470>]}
[0m13:11:49.477914 [info ] [Thread-1 (]: 18 of 18 OK created sql table model `adw02_star`.`fct_rentals` ................. [[32mOK[0m in 0.25s]
[0m13:11:49.478614 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m13:11:49.480109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:49.480561 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m13:11:49.481005 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m13:11:49.481699 [info ] [MainThread]: 
[0m13:11:49.482278 [info ] [MainThread]: Finished running 18 table models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m13:11:49.489774 [debug] [MainThread]: Command end result
[0m13:11:49.573036 [info ] [MainThread]: 
[0m13:11:49.573503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:49.573869 [info ] [MainThread]: 
[0m13:11:49.574295 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m13:11:49.575118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.802021, "process_in_blocks": "8", "process_kernel_time": 0.302618, "process_mem_max_rss": "144572", "process_out_blocks": "5280", "process_user_time": 4.929533}
[0m13:11:49.575665 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:49.575561 after 6.80 seconds
[0m13:11:49.576016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4a4a7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea4e226750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ea481afef0>]}
[0m13:11:49.576375 [debug] [MainThread]: Flushing usage events
[0m13:17:55.231513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8d0396120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8ce2b9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8ce2b9450>]}


============================== 13:17:55.235833 | 12940e71-51a8-4d6e-bb5e-cf973957836e ==============================
[0m13:17:55.235833 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:17:55.236583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar', 'log_path': '/home/sergon/Documents/semestre7/ADW/ADW-EE2/Notebook/dbtSakStar/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:17:55.464390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cf2edcd0>]}
[0m13:17:55.541368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8ce12b790>]}
[0m13:17:55.542318 [info ] [MainThread]: Registered adapter: clickhouse=1.8.9
[0m13:17:55.660957 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:17:55.824527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:17:55.825743 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.yml
[0m13:17:55.826651 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_film/dim_film.yml
[0m13:17:55.827182 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/dim/dim_film/dim_film.sql
[0m13:17:55.827718 [debug] [MainThread]: Partial parsing: updated file: sakstar://models/marts/fact/fct_rentals/fct_rentals.sql
[0m13:17:56.195048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:17:56.195796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cdd51e50>]}
[0m13:17:56.522614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cda73110>]}
[0m13:17:56.728015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cdb8b3f0>]}
[0m13:17:56.728600 [info ] [MainThread]: Found 18 models, 29 data tests, 12 sources, 608 macros
[0m13:17:56.729061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cdd81230>]}
[0m13:17:56.732681 [info ] [MainThread]: 
[0m13:17:56.733486 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:17:56.743450 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:17:56.757116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:57.057184 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:17:57.060573 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:17:57.096465 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:17:57.100578 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:17:57.104668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__adw02_stag)
[0m13:17:57.114045 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_stag: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_stag"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_stag'
      

  ...
[0m13:17:57.129262 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:17:57.131528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list__adw02_stag, now list__adw02_star)
[0m13:17:57.134153 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__adw02_star: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "connection_name": "list__adw02_star"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'adw02_star'
      

  ...
[0m13:17:57.151263 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:17:57.153270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cc25ff50>]}
[0m13:17:57.154146 [info ] [MainThread]: Concurrency: 1 threads (target='clickhouse')
[0m13:17:57.154748 [info ] [MainThread]: 
[0m13:17:57.157630 [debug] [Thread-1 (]: Began running node model.sakstar.dim_date
[0m13:17:57.158501 [info ] [Thread-1 (]: 1 of 18 START sql table model `adw02_star`.`dim_date` .......................... [RUN]
[0m13:17:57.159151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__adw02_star, now model.sakstar.dim_date)
[0m13:17:57.159746 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_date
[0m13:17:57.177517 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_date"
[0m13:17:57.178313 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_date
[0m13:17:57.207709 [debug] [Thread-1 (]: Creating new relation dim_date
[0m13:17:57.261879 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

            

    
        create table `adw02_star`.`dim_date`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
          )
        
        ...
[0m13:17:57.345979 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m13:17:57.383287 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:17:57.388229 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:17:57.396207 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_date"
[0m13:17:57.397201 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_date: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_date"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_date`
        ("date_key", "date_actual", "epoch", "day_suffix", "day_name", "day_of_week", "day_of_month", "day_of_quarter", "day_of_year", "week_of_month", "week_of_year", "week_of_year_iso", "month_actual", "month_name", "month_name_abbreviated", "quarter_actual", "quarter_name", "year_actual", "first_day_of_week", "last_day_of_week", "first_day_of_month", "last_day_of_month", "first_day_of_quarter", "last_day_of_quarter", "first_day_of_year", "last_day_of_year", "mmyyyy", "mmddyyyy", "weekend_indr")SELECT *
FROM s3(
  'https://izar.ls.fi.upm.es:30009/sakstar/dim_date.csv',
  'YA9JokyWUb2hFUbKYEEN',
  '0k2ornkQpVTqUrBbOEsEXOnBEEWgJf4AFQOU4O7Y',
  'CSVWithNames'
)
  ...
[0m13:18:00.467134 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 3.07 seconds
[0m13:18:00.495120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f08aa0>]}
[0m13:18:00.496005 [info ] [Thread-1 (]: 1 of 18 OK created sql table model `adw02_star`.`dim_date` ..................... [[32mOK[0m in 3.33s]
[0m13:18:00.496977 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_date
[0m13:18:00.497623 [debug] [Thread-1 (]: Began running node model.sakstar.stg_address
[0m13:18:00.498318 [info ] [Thread-1 (]: 2 of 18 START sql table model `adw02_stag`.`stg_address` ....................... [RUN]
[0m13:18:00.499125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_date, now model.sakstar.stg_address)
[0m13:18:00.499695 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_address
[0m13:18:00.503306 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_address"
[0m13:18:00.504343 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_address
[0m13:18:00.507785 [debug] [Thread-1 (]: Creating new relation stg_address
[0m13:18:00.509326 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

            

    
        create table `adw02_stag`.`stg_address`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
          )
        
        ...
[0m13:18:00.524098 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.527682 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

    select name, type from system.columns where table = 'stg_address'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.532611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.535367 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_address"
[0m13:18:00.536497 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_address: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_address"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_address`
        ("address_id", "address", "district", "city_id", "postal_code", "phone", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`address`
)
SELECT
    address_id,
    address,
    district,
    city_id,
    postal_code,
    phone,
    last_update
FROM source
  ...
[0m13:18:00.558192 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.560610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c78f3070>]}
[0m13:18:00.561369 [info ] [Thread-1 (]: 2 of 18 OK created sql table model `adw02_stag`.`stg_address` .................. [[32mOK[0m in 0.06s]
[0m13:18:00.562194 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_address
[0m13:18:00.562771 [debug] [Thread-1 (]: Began running node model.sakstar.stg_category
[0m13:18:00.563498 [info ] [Thread-1 (]: 3 of 18 START sql table model `adw02_stag`.`stg_category` ...................... [RUN]
[0m13:18:00.564160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_address, now model.sakstar.stg_category)
[0m13:18:00.564790 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_category
[0m13:18:00.568889 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_category"
[0m13:18:00.569761 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_category
[0m13:18:00.572574 [debug] [Thread-1 (]: Creating new relation stg_category
[0m13:18:00.574147 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

            

    
        create table `adw02_stag`.`stg_category`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`category`
)
SELECT
    category_id,
    name
FROM source
          )
        
        ...
[0m13:18:00.587824 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.591836 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

    select name, type from system.columns where table = 'stg_category'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.596628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.598898 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_category"
[0m13:18:00.599679 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_category"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_category`
        ("category_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`category`
)
SELECT
    category_id,
    name
FROM source
  ...
[0m13:18:00.618973 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.621576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c79b45d0>]}
[0m13:18:00.622387 [info ] [Thread-1 (]: 3 of 18 OK created sql table model `adw02_stag`.`stg_category` ................. [[32mOK[0m in 0.06s]
[0m13:18:00.623308 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_category
[0m13:18:00.624029 [debug] [Thread-1 (]: Began running node model.sakstar.stg_city
[0m13:18:00.624644 [info ] [Thread-1 (]: 4 of 18 START sql table model `adw02_stag`.`stg_city` .......................... [RUN]
[0m13:18:00.625210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_category, now model.sakstar.stg_city)
[0m13:18:00.625709 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_city
[0m13:18:00.629124 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_city"
[0m13:18:00.629962 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_city
[0m13:18:00.633648 [debug] [Thread-1 (]: Creating new relation stg_city
[0m13:18:00.635201 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

            

    
        create table `adw02_stag`.`stg_city`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
          )
        
        ...
[0m13:18:00.653735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.663617 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

    select name, type from system.columns where table = 'stg_city'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.676583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.683989 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_city"
[0m13:18:00.685829 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_city: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_city"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_city`
        ("city_id", "city", "country_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`city`
)
SELECT
    city_id,
    city,
    country_id
FROM source
  ...
[0m13:18:00.716785 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:18:00.720570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c78dda90>]}
[0m13:18:00.721900 [info ] [Thread-1 (]: 4 of 18 OK created sql table model `adw02_stag`.`stg_city` ..................... [[32mOK[0m in 0.10s]
[0m13:18:00.723307 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_city
[0m13:18:00.724176 [debug] [Thread-1 (]: Began running node model.sakstar.stg_country
[0m13:18:00.725138 [info ] [Thread-1 (]: 5 of 18 START sql table model `adw02_stag`.`stg_country` ....................... [RUN]
[0m13:18:00.726211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_city, now model.sakstar.stg_country)
[0m13:18:00.727333 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_country
[0m13:18:00.733993 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_country"
[0m13:18:00.734977 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_country
[0m13:18:00.738083 [debug] [Thread-1 (]: Creating new relation stg_country
[0m13:18:00.739678 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

            

    
        create table `adw02_stag`.`stg_country`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
          )
        
        ...
[0m13:18:00.753976 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.758047 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

    select name, type from system.columns where table = 'stg_country'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.763023 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.765145 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_country"
[0m13:18:00.765985 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_country: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_country"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_country`
        ("country_id", "country")WITH source AS (
    SELECT * FROM `sakila_proxy`.`country`
)
SELECT
    country_id,
    country
FROM source
  ...
[0m13:18:00.785137 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.787545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d6d0>]}
[0m13:18:00.788298 [info ] [Thread-1 (]: 5 of 18 OK created sql table model `adw02_stag`.`stg_country` .................. [[32mOK[0m in 0.06s]
[0m13:18:00.789229 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_country
[0m13:18:00.789931 [debug] [Thread-1 (]: Began running node model.sakstar.stg_customer
[0m13:18:00.790648 [info ] [Thread-1 (]: 6 of 18 START sql table model `adw02_stag`.`stg_customer` ...................... [RUN]
[0m13:18:00.791223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_country, now model.sakstar.stg_customer)
[0m13:18:00.791717 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_customer
[0m13:18:00.795125 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_customer"
[0m13:18:00.796040 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_customer
[0m13:18:00.799333 [debug] [Thread-1 (]: Creating new relation stg_customer
[0m13:18:00.800936 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

            

    
        create table `adw02_stag`.`stg_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
          )
        
        ...
[0m13:18:00.815470 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.819279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

    select name, type from system.columns where table = 'stg_customer'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.824158 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.827377 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_customer"
[0m13:18:00.828509 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_customer"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_customer`
        ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "active", "create_date", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`customer`
)
SELECT
    customer_id,
    store_id,
    first_name,
    last_name,
    email,
    address_id,
    active,
    create_date,
    last_update
FROM source
  ...
[0m13:18:00.852261 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.854948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d250>]}
[0m13:18:00.855839 [info ] [Thread-1 (]: 6 of 18 OK created sql table model `adw02_stag`.`stg_customer` ................. [[32mOK[0m in 0.06s]
[0m13:18:00.856760 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_customer
[0m13:18:00.857338 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film
[0m13:18:00.858265 [info ] [Thread-1 (]: 7 of 18 START sql table model `adw02_stag`.`stg_film` .......................... [RUN]
[0m13:18:00.859068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_customer, now model.sakstar.stg_film)
[0m13:18:00.859742 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film
[0m13:18:00.869021 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film"
[0m13:18:00.869771 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film
[0m13:18:00.872288 [debug] [Thread-1 (]: Creating new relation stg_film
[0m13:18:00.873806 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

            

    
        create table `adw02_stag`.`stg_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
          )
        
        ...
[0m13:18:00.888465 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.892251 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

    select name, type from system.columns where table = 'stg_film'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.896859 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.900545 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film"
[0m13:18:00.901339 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film`
        ("film_id", "title", "description", "release_year", "language_id", "original_language_id", "rental_duration", "rental_rate", "length", "replacement_cost", "rating", "special_features", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film`
)
SELECT
    film_id,
    title,
    description,
    release_year,
    language_id,
    original_language_id,
    rental_duration,
    rental_rate,
    length,
    replacement_cost,
    rating,
    special_features,
    last_update
FROM source
  ...
[0m13:18:00.926239 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.928883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c7856270>]}
[0m13:18:00.929647 [info ] [Thread-1 (]: 7 of 18 OK created sql table model `adw02_stag`.`stg_film` ..................... [[32mOK[0m in 0.07s]
[0m13:18:00.930433 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film
[0m13:18:00.931151 [debug] [Thread-1 (]: Began running node model.sakstar.stg_film_category
[0m13:18:00.931846 [info ] [Thread-1 (]: 8 of 18 START sql table model `adw02_stag`.`stg_film_category` ................. [RUN]
[0m13:18:00.932434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film, now model.sakstar.stg_film_category)
[0m13:18:00.932911 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_film_category
[0m13:18:00.936256 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_film_category"
[0m13:18:00.937093 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_film_category
[0m13:18:00.940382 [debug] [Thread-1 (]: Creating new relation stg_film_category
[0m13:18:00.942224 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

            

    
        create table `adw02_stag`.`stg_film_category`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`film_category`
)
SELECT
    film_id,
    category_id
FROM source
          )
        
        ...
[0m13:18:00.955614 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:00.959062 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

    select name, type from system.columns where table = 'stg_film_category'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:00.963662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:00.965909 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_film_category"
[0m13:18:00.966672 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_film_category: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_film_category"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_film_category`
        ("film_id", "category_id")WITH source AS (
    SELECT * FROM `sakila_proxy`.`film_category`
)
SELECT
    film_id,
    category_id
FROM source
  ...
[0m13:18:00.986562 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:00.988861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c7947770>]}
[0m13:18:00.989619 [info ] [Thread-1 (]: 8 of 18 OK created sql table model `adw02_stag`.`stg_film_category` ............ [[32mOK[0m in 0.06s]
[0m13:18:00.990386 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_film_category
[0m13:18:00.990940 [debug] [Thread-1 (]: Began running node model.sakstar.stg_inventory
[0m13:18:00.991559 [info ] [Thread-1 (]: 9 of 18 START sql table model `adw02_stag`.`stg_inventory` ..................... [RUN]
[0m13:18:00.992126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_film_category, now model.sakstar.stg_inventory)
[0m13:18:00.992704 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_inventory
[0m13:18:00.996728 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_inventory"
[0m13:18:00.997507 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_inventory
[0m13:18:00.999996 [debug] [Thread-1 (]: Creating new relation stg_inventory
[0m13:18:01.001375 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

            

    
        create table `adw02_stag`.`stg_inventory`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
          )
        
        ...
[0m13:18:01.017597 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.027006 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

    select name, type from system.columns where table = 'stg_inventory'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:01.036054 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.039164 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_inventory"
[0m13:18:01.040125 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_inventory: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_inventory"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_inventory`
        ("inventory_id", "film_id", "store_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`inventory`
)
SELECT
    inventory_id,
    film_id,
    store_id,
    last_update
FROM source
  ...
[0m13:18:01.064658 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.067449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d010>]}
[0m13:18:01.068218 [info ] [Thread-1 (]: 9 of 18 OK created sql table model `adw02_stag`.`stg_inventory` ................ [[32mOK[0m in 0.08s]
[0m13:18:01.069019 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_inventory
[0m13:18:01.069603 [debug] [Thread-1 (]: Began running node model.sakstar.stg_language
[0m13:18:01.070281 [info ] [Thread-1 (]: 10 of 18 START sql table model `adw02_stag`.`stg_language` ..................... [RUN]
[0m13:18:01.071045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_inventory, now model.sakstar.stg_language)
[0m13:18:01.071615 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_language
[0m13:18:01.075519 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_language"
[0m13:18:01.076333 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_language
[0m13:18:01.079807 [debug] [Thread-1 (]: Creating new relation stg_language
[0m13:18:01.081351 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

            

    
        create table `adw02_stag`.`stg_language`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
          )
        
        ...
[0m13:18:01.094842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.099298 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

    select name, type from system.columns where table = 'stg_language'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:01.104483 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.106795 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_language"
[0m13:18:01.107559 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_language: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_language"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_language`
        ("language_id", "name")WITH source AS (
    SELECT * FROM `sakila_proxy`.`language`
)
SELECT
    language_id,
    name
FROM source
  ...
[0m13:18:01.126937 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.129505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d3d0>]}
[0m13:18:01.130254 [info ] [Thread-1 (]: 10 of 18 OK created sql table model `adw02_stag`.`stg_language` ................ [[32mOK[0m in 0.06s]
[0m13:18:01.131233 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_language
[0m13:18:01.131790 [debug] [Thread-1 (]: Began running node model.sakstar.stg_rental
[0m13:18:01.132402 [info ] [Thread-1 (]: 11 of 18 START sql table model `adw02_stag`.`stg_rental` ....................... [RUN]
[0m13:18:01.133163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_language, now model.sakstar.stg_rental)
[0m13:18:01.133668 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_rental
[0m13:18:01.137696 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_rental"
[0m13:18:01.138669 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_rental
[0m13:18:01.141699 [debug] [Thread-1 (]: Creating new relation stg_rental
[0m13:18:01.143268 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

            

    
        create table `adw02_stag`.`stg_rental`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
          )
        
        ...
[0m13:18:01.157129 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.161060 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

    select name, type from system.columns where table = 'stg_rental'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:01.165910 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.168694 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_rental"
[0m13:18:01.169489 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_rental: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_rental"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_rental`
        ("rental_id", "rental_date", "inventory_id", "customer_id", "return_date", "staff_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`rental`
)
SELECT
    rental_id,
    rental_date,
    inventory_id,
    customer_id,
    return_date,
    staff_id,
    last_update
FROM source
  ...
[0m13:18:01.217899 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m13:18:01.220537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d0d0>]}
[0m13:18:01.221310 [info ] [Thread-1 (]: 11 of 18 OK created sql table model `adw02_stag`.`stg_rental` .................. [[32mOK[0m in 0.09s]
[0m13:18:01.222165 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_rental
[0m13:18:01.222805 [debug] [Thread-1 (]: Began running node model.sakstar.stg_staff
[0m13:18:01.223517 [info ] [Thread-1 (]: 12 of 18 START sql table model `adw02_stag`.`stg_staff` ........................ [RUN]
[0m13:18:01.224136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_rental, now model.sakstar.stg_staff)
[0m13:18:01.224811 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_staff
[0m13:18:01.228553 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_staff"
[0m13:18:01.229344 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_staff
[0m13:18:01.232767 [debug] [Thread-1 (]: Creating new relation stg_staff
[0m13:18:01.234470 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

            

    
        create table `adw02_stag`.`stg_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
          )
        
        ...
[0m13:18:01.253341 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.262622 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

    select name, type from system.columns where table = 'stg_staff'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:01.275042 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.283152 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_staff"
[0m13:18:01.285463 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_staff"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_staff`
        ("staff_id", "first_name", "last_name", "address_id", "email", "store_id", "active", "username", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`staff`
)
SELECT
    staff_id,
    first_name,
    last_name,
    address_id,
    email,
    store_id,
    active,
    username,
    last_update
FROM source
  ...
[0m13:18:01.343919 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m13:18:01.348457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3f230>]}
[0m13:18:01.350049 [info ] [Thread-1 (]: 12 of 18 OK created sql table model `adw02_stag`.`stg_staff` ................... [[32mOK[0m in 0.12s]
[0m13:18:01.351875 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_staff
[0m13:18:01.353320 [debug] [Thread-1 (]: Began running node model.sakstar.stg_store
[0m13:18:01.354604 [info ] [Thread-1 (]: 13 of 18 START sql table model `adw02_stag`.`stg_store` ........................ [RUN]
[0m13:18:01.356143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_staff, now model.sakstar.stg_store)
[0m13:18:01.357779 [debug] [Thread-1 (]: Began compiling node model.sakstar.stg_store
[0m13:18:01.364707 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.stg_store"
[0m13:18:01.365811 [debug] [Thread-1 (]: Began executing node model.sakstar.stg_store
[0m13:18:01.369773 [debug] [Thread-1 (]: Creating new relation stg_store
[0m13:18:01.371610 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

            

    
        create table `adw02_stag`.`stg_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
          )
        
        ...
[0m13:18:01.385984 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.390141 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

    select name, type from system.columns where table = 'stg_store'
    
      and database = 'adw02_stag'
    
    order by position
  ...
[0m13:18:01.395010 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.397319 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.stg_store"
[0m13:18:01.398212 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.stg_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.stg_store"} */

  
    
    
    
        
         


        insert into `adw02_stag`.`stg_store`
        ("store_id", "manager_staff_id", "address_id", "last_update")WITH source AS (
    SELECT * FROM `sakila_proxy`.`store`
)
SELECT
    store_id,
    manager_staff_id,
    address_id,
    last_update
FROM source
  ...
[0m13:18:01.418653 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.421012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3f9b0>]}
[0m13:18:01.421758 [info ] [Thread-1 (]: 13 of 18 OK created sql table model `adw02_stag`.`stg_store` ................... [[32mOK[0m in 0.07s]
[0m13:18:01.422714 [debug] [Thread-1 (]: Finished running node model.sakstar.stg_store
[0m13:18:01.423512 [debug] [Thread-1 (]: Began running node model.sakstar.dim_customer
[0m13:18:01.424181 [info ] [Thread-1 (]: 14 of 18 START sql table model `adw02_star`.`dim_customer` ..................... [RUN]
[0m13:18:01.424935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.stg_store, now model.sakstar.dim_customer)
[0m13:18:01.425518 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_customer
[0m13:18:01.432713 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_customer"
[0m13:18:01.433893 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_customer
[0m13:18:01.438210 [debug] [Thread-1 (]: Creating new relation dim_customer
[0m13:18:01.439782 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

            

    
        create table `adw02_star`.`dim_customer`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
          )
        
        ...
[0m13:18:01.455881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.459413 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

    select name, type from system.columns where table = 'dim_customer'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:18:01.464554 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.469954 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_customer"
[0m13:18:01.471405 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_customer"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_customer`
        ("customer_skey", "customer_id", "customer_first_name", "customer_last_name", "customer_email", "customer_active", "customer_created", "customer_address", "customer_district", "customer_postal_code", "customer_phone_number", "customer_city", "customer_country", "customer_last_update")WITH customers AS (
    SELECT * FROM `adw02_stag`.`stg_customer`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(customer_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_email as String), '_dbt_utils_surrogate_key_null_') )))) AS customer_skey,
        c.customer_id AS customer_id,
        c.first_name AS customer_first_name,
        c.last_name AS customer_last_name,
        c.email AS customer_email,
        c.active AS customer_active,
        c.create_date AS customer_created,
        a.address AS customer_address,
        a.district AS customer_district,
        a.postal_code AS customer_postal_code,
        a.phone AS customer_phone_number,
        ci.city AS customer_city,
        co.country AS customer_country,
        c.last_update AS customer_last_update
    FROM customers c
    LEFT JOIN addresses a ON c.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
)
SELECT * FROM final
ORDER BY customer_id
  ...
[0m13:18:01.505495 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:18:01.507796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3fb30>]}
[0m13:18:01.508554 [info ] [Thread-1 (]: 14 of 18 OK created sql table model `adw02_star`.`dim_customer` ................ [[32mOK[0m in 0.08s]
[0m13:18:01.509353 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_customer
[0m13:18:01.509965 [debug] [Thread-1 (]: Began running node model.sakstar.dim_film
[0m13:18:01.510752 [info ] [Thread-1 (]: 15 of 18 START sql table model `adw02_star`.`dim_film` ......................... [RUN]
[0m13:18:01.511555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_customer, now model.sakstar.dim_film)
[0m13:18:01.512157 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_film
[0m13:18:01.524463 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_film"
[0m13:18:01.525384 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_film
[0m13:18:01.528221 [debug] [Thread-1 (]: Creating new relation dim_film
[0m13:18:01.530319 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

            

    
        create table `adw02_star`.`dim_film`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),

film_categories AS (
    SELECT * FROM `adw02_stag`.`stg_film_category`
),
categories AS (
    SELECT * FROM `adw02_stag`.`stg_category`
),

films_with_categories AS (
    SELECT
        f.*,
        c.name AS category_name
    FROM films f
    LEFT JOIN film_categories fc ON f.film_id = fc.film_id
    LEFT JOIN categories c ON fc.category_id = c.category_id
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(f.film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        f.category_name AS film_category_name,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films_with_categories f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
          )
        
        ...
[0m13:18:01.548877 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.552778 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

    select name, type from system.columns where table = 'dim_film'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:18:01.557997 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.561643 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_film"
[0m13:18:01.562535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_film: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_film"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_film`
        ("film_skey", "film_id", "film_title", "film_description", "film_release_year", "film_category_name", "film_language", "film_original_language", "film_rental_duration", "film_rental_rate", "film_duration", "film_replacement_cost", "film_rating", "film_special_features", "film_last_update")WITH films AS (
    SELECT * FROM `adw02_stag`.`stg_film`
),
languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),
original_languages AS (
    SELECT * FROM `adw02_stag`.`stg_language`
),

film_categories AS (
    SELECT * FROM `adw02_stag`.`stg_film_category`
),
categories AS (
    SELECT * FROM `adw02_stag`.`stg_category`
),

films_with_categories AS (
    SELECT
        f.*,
        c.name AS category_name
    FROM films f
    LEFT JOIN film_categories fc ON f.film_id = fc.film_id
    LEFT JOIN categories c ON fc.category_id = c.category_id
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(f.film_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.title as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.description as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(f.release_year as String), '_dbt_utils_surrogate_key_null_') )))) AS film_skey,
        f.film_id AS film_id,
        f.title AS film_title,
        f.description AS film_description,
        f.release_year AS film_release_year,
        f.category_name AS film_category_name,
        l.name AS film_language,
        ol.name AS film_original_language,
        f.rental_duration AS film_rental_duration,
        f.rental_rate AS film_rental_rate,
        f.length AS film_duration,
        f.replacement_cost AS film_replacement_cost,
        f.rating AS film_rating,
        f.special_features AS film_special_features,
        f.last_update AS film_last_update
    FROM films_with_categories f
    LEFT JOIN languages l ON f.language_id = l.language_id
    LEFT JOIN original_languages ol ON f.original_language_id = ol.language_id
)
SELECT * FROM final
  ...
[0m13:18:01.608109 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m13:18:01.610649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d670>]}
[0m13:18:01.611431 [info ] [Thread-1 (]: 15 of 18 OK created sql table model `adw02_star`.`dim_film` .................... [[32mOK[0m in 0.10s]
[0m13:18:01.612364 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_film
[0m13:18:01.613101 [debug] [Thread-1 (]: Began running node model.sakstar.dim_staff
[0m13:18:01.613718 [info ] [Thread-1 (]: 16 of 18 START sql table model `adw02_star`.`dim_staff` ........................ [RUN]
[0m13:18:01.614316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_film, now model.sakstar.dim_staff)
[0m13:18:01.614810 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_staff
[0m13:18:01.621617 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_staff"
[0m13:18:01.622443 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_staff
[0m13:18:01.625291 [debug] [Thread-1 (]: Creating new relation dim_staff
[0m13:18:01.626698 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

            

    
        create table `adw02_star`.`dim_staff`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS staff_store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
          )
        
        ...
[0m13:18:01.641092 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.645052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

    select name, type from system.columns where table = 'dim_staff'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:18:01.650006 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.653025 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_staff"
[0m13:18:01.653902 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_staff: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_staff"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_staff`
        ("staff_skey", "staff_id", "staff_first_name", "staff_last_name", "staff_email", "staff_active", "staff_store_id", "staff_last_update")WITH staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(staff_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_first_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_last_name as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staff_email as String), '_dbt_utils_surrogate_key_null_') )))) AS staff_skey,
        s.staff_id AS staff_id,
        s.first_name AS staff_first_name,
        s.last_name AS staff_last_name,
        s.email AS staff_email,
        s.active AS staff_active,
        s.store_id AS staff_store_id,
        s.last_update AS staff_last_update
    FROM staff s
)
SELECT * FROM final
  ...
[0m13:18:01.665819 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.668942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3f2f0>]}
[0m13:18:01.669789 [info ] [Thread-1 (]: 16 of 18 OK created sql table model `adw02_star`.`dim_staff` ................... [[32mOK[0m in 0.05s]
[0m13:18:01.670787 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_staff
[0m13:18:01.671396 [debug] [Thread-1 (]: Began running node model.sakstar.dim_store
[0m13:18:01.672224 [info ] [Thread-1 (]: 17 of 18 START sql table model `adw02_star`.`dim_store` ........................ [RUN]
[0m13:18:01.672976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_staff, now model.sakstar.dim_store)
[0m13:18:01.673486 [debug] [Thread-1 (]: Began compiling node model.sakstar.dim_store
[0m13:18:01.679538 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.dim_store"
[0m13:18:01.680409 [debug] [Thread-1 (]: Began executing node model.sakstar.dim_store
[0m13:18:01.683773 [debug] [Thread-1 (]: Creating new relation dim_store
[0m13:18:01.685242 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

            

    
        create table `adw02_star`.`dim_store`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
          )
        
        ...
[0m13:18:01.704655 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:18:01.715554 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

    select name, type from system.columns where table = 'dim_store'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:18:01.723875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.729182 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.dim_store"
[0m13:18:01.730433 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.dim_store: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.dim_store"} */

  
    
    
    
        
         


        insert into `adw02_star`.`dim_store`
        ("store_skey", "store_id", "store_address", "store_district", "store_postal_code", "store_phone_number", "store_city", "store_country", "store_manager_staff_id", "store_manager_first_name", "store_manager_last_name", "store_last_update")WITH stores AS (
    SELECT * FROM `adw02_stag`.`stg_store`
),
addresses AS (
    SELECT * FROM `adw02_stag`.`stg_address`
),
cities AS (
    SELECT * FROM `adw02_stag`.`stg_city`
),
countries AS (
    SELECT * FROM `adw02_stag`.`stg_country`
),
staff AS (
    SELECT * FROM `adw02_stag`.`stg_staff`
),
final AS (
    SELECT
        lower(hex(MD5(toString(coalesce(cast(store_id as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_address as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_district as String), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(store_postal_code as String), '_dbt_utils_surrogate_key_null_') )))) AS store_skey,
        s.store_id AS store_id,
        a.address AS store_address,
        a.district AS store_district,
        a.postal_code AS store_postal_code,
        a.phone AS store_phone_number,
        ci.city AS store_city,
        co.country AS store_country,
        s.manager_staff_id AS store_manager_staff_id,
        stf.first_name AS store_manager_first_name,
        stf.last_name AS store_manager_last_name,
        s.last_update AS store_last_update
    FROM stores s
    LEFT JOIN addresses a ON s.address_id = a.address_id
    LEFT JOIN cities ci ON a.city_id = ci.city_id
    LEFT JOIN countries co ON ci.country_id = co.country_id
    LEFT JOIN staff stf ON s.manager_staff_id = stf.staff_id
)
SELECT * FROM final
  ...
[0m13:18:01.761320 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:18:01.763638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3d8b0>]}
[0m13:18:01.764446 [info ] [Thread-1 (]: 17 of 18 OK created sql table model `adw02_star`.`dim_store` ................... [[32mOK[0m in 0.09s]
[0m13:18:01.765387 [debug] [Thread-1 (]: Finished running node model.sakstar.dim_store
[0m13:18:01.766696 [debug] [Thread-1 (]: Began running node model.sakstar.fct_rentals
[0m13:18:01.767369 [info ] [Thread-1 (]: 18 of 18 START sql table model `adw02_star`.`fct_rentals` ...................... [RUN]
[0m13:18:01.767997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakstar.dim_store, now model.sakstar.fct_rentals)
[0m13:18:01.768505 [debug] [Thread-1 (]: Began compiling node model.sakstar.fct_rentals
[0m13:18:01.775297 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakstar.fct_rentals"
[0m13:18:01.776090 [debug] [Thread-1 (]: Began executing node model.sakstar.fct_rentals
[0m13:18:01.778813 [debug] [Thread-1 (]: Creating new relation fct_rentals
[0m13:18:01.780270 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

            

    
        create table `adw02_star`.`fct_rentals`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
          )
        
        ...
[0m13:18:01.795385 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:18:01.799199 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

    select name, type from system.columns where table = 'fct_rentals'
    
      and database = 'adw02_star'
    
    order by position
  ...
[0m13:18:01.804574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:18:01.807536 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakstar.fct_rentals"
[0m13:18:01.808451 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.sakstar.fct_rentals: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "sak_profile", "target_name": "clickhouse", "node_id": "model.sakstar.fct_rentals"} */

  
    
    
    
        
         


        insert into `adw02_star`.`fct_rentals`
        ("rental_skey", "customer_skey", "film_skey", "staff_skey", "store_skey", "date_key", "rental_id", "count_rentals", "rental_duration")WITH rental_data AS (
    SELECT
        r.rental_id,
        r.rental_date,
        r.return_date,
        r.customer_id,
        r.staff_id,
        i.film_id,
        i.store_id,
        dateDiff('day', r.rental_date, COALESCE(r.return_date, now())) AS rental_duration
    FROM `adw02_stag`.`stg_rental` r
    LEFT JOIN `adw02_stag`.`stg_inventory` i ON r.inventory_id = i.inventory_id
),

date_lookup AS (
    SELECT
        date_key,
        date_actual
    FROM `adw02_star`.`dim_date`
)

SELECT
    lower(hex(MD5(toString(coalesce(cast(r.rental_id as String), '_dbt_utils_surrogate_key_null_') )))) AS rental_skey,
    dc.customer_skey,
    df.film_skey,
    ds.staff_skey,
    dst.store_skey,
    d.date_key,
    r.rental_id,
    COUNT(*) OVER(PARTITION BY r.customer_id) AS count_rentals,
    r.rental_duration
FROM rental_data r
JOIN `adw02_star`.`dim_customer` dc ON r.customer_id = dc.customer_id
JOIN `adw02_star`.`dim_film` df ON r.film_id = df.film_id
JOIN `adw02_star`.`dim_staff` ds ON r.staff_id = ds.staff_id
JOIN `adw02_star`.`dim_store` dst ON r.store_id = dst.store_id
JOIN date_lookup d ON toDate(r.rental_date) = d.date_actual
  ...
[0m13:18:01.907600 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.10 seconds
[0m13:18:01.909866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12940e71-51a8-4d6e-bb5e-cf973957836e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5f3c410>]}
[0m13:18:01.910608 [info ] [Thread-1 (]: 18 of 18 OK created sql table model `adw02_star`.`fct_rentals` ................. [[32mOK[0m in 0.14s]
[0m13:18:01.911366 [debug] [Thread-1 (]: Finished running node model.sakstar.fct_rentals
[0m13:18:01.912993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:01.913433 [debug] [MainThread]: Connection 'model.sakstar.fct_rentals' was left open.
[0m13:18:01.913856 [debug] [MainThread]: On model.sakstar.fct_rentals: Close
[0m13:18:01.914454 [info ] [MainThread]: 
[0m13:18:01.915017 [info ] [MainThread]: Finished running 18 table models in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m13:18:01.919125 [debug] [MainThread]: Command end result
[0m13:18:01.973493 [info ] [MainThread]: 
[0m13:18:01.974136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:01.974741 [info ] [MainThread]: 
[0m13:18:01.975240 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m13:18:01.976503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8099155, "process_in_blocks": "0", "process_kernel_time": 0.286554, "process_mem_max_rss": "143944", "process_out_blocks": "5264", "process_user_time": 4.16311}
[0m13:18:01.977071 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:01.976931 after 6.81 seconds
[0m13:18:01.977590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8cff27d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5e43d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8c5e43d10>]}
[0m13:18:01.978111 [debug] [MainThread]: Flushing usage events
